<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns#"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/component---src-layouts-index-js-ff03b727f34a861dfe79.js" as="script"/><link rel="preload" href="/component---src-templates-post-template-js-bfbd078eed4e23281397.js" as="script"/><link rel="preload" href="/path---dark-net-cnn-source-code-analyse-0aa53d24096e16a20569.js" as="script"/><link rel="preload" href="/app-f46259a2b5652bc066f4.js" as="script"/><link rel="preload" href="/commons-7dadf5fa9ddaa4eb8b31.js" as="script"/><style type="text/css" id="server-side-jss">html {
  box-sizing: border-box;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
*, *::before, *::after {
  box-sizing: inherit;
}
body {
  margin: 0;
  background-color: #fafafa;
}
@media print {
  body {
    background-color: #fff;
  }
}
.jss44 {
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: block;
  z-index: 0;
  position: absolute;
  overflow: hidden;
  border-radius: inherit;
  pointer-events: none;
}
.jss45 {
  top: 0;
  left: 0;
  width: 50px;
  height: 50px;
  opacity: 0;
  position: absolute;
}
.jss46 {
  opacity: 0.3;
  transform: scale(1);
  animation: mui-ripple-enter 550ms cubic-bezier(0.4, 0, 0.2, 1);
}
.jss47 {
  animation-duration: 200ms;
}
.jss48 {
  width: 100%;
  height: 100%;
  opacity: 1;
  display: block;
  border-radius: 50%;
  background-color: currentColor;
}
.jss49 {
  opacity: 0;
  animation: mui-ripple-exit 550ms cubic-bezier(0.4, 0, 0.2, 1);
}
.jss50 {
  top: 0;
  left: 0;
  position: absolute;
  animation: mui-ripple-pulsate 2500ms cubic-bezier(0.4, 0, 0.2, 1) 200ms infinite;
}
@keyframes mui-ripple-enter {
  0% {
    opacity: 0.1;
    transform: scale(0);
  }
  100% {
    opacity: 0.3;
    transform: scale(1);
  }
}
@keyframes mui-ripple-exit {
  0% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}
@keyframes mui-ripple-pulsate {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(0.92);
  }
  100% {
    transform: scale(1);
  }
}
.jss34 {
  color: inherit;
  cursor: pointer;
  margin: 0;
  border: 0;
  display: inline-flex;
  padding: 0;
  outline: none;
  position: relative;
  user-select: none;
  align-items: center;
  border-radius: 0;
  vertical-align: middle;
  justify-content: center;
  -moz-appearance: none;
  text-decoration: none;
  background-color: transparent;
  -webkit-appearance: none;
  -webkit-tap-highlight-color: transparent;
}
.jss34::-moz-focus-inner {
  border-style: none;
}
.jss34.jss35 {
  cursor: default;
  pointer-events: none;
}
.jss28 {
  flex: 0 0 auto;
  width: 48px;
  color: rgba(0, 0, 0, 0.54);
  height: 48px;
  padding: 0;
  font-size: 1.7142857142857142rem;
  text-align: center;
  transition: background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
  border-radius: 50%;
}
.jss28:hover {
  background-color: rgba(0, 0, 0, 0.08);
}
.jss28.jss32 {
  color: rgba(0, 0, 0, 0.26);
}
@media (hover: none) {
  .jss28:hover {
    background-color: transparent;
  }
}
.jss28:hover.jss32 {
  background-color: transparent;
}
.jss29 {
  color: inherit;
}
.jss30 {
  color: #f89406;
}
.jss30:hover {
  background-color: rgba(248, 148, 6, 0.08);
}
@media (hover: none) {
  .jss30:hover {
    background-color: transparent;
  }
}
.jss31 {
  color: #f50057;
}
.jss31:hover {
  background-color: rgba(245, 0, 87, 0.08);
}
@media (hover: none) {
  .jss31:hover {
    background-color: transparent;
  }
}
.jss33 {
  width: 100%;
  display: flex;
  align-items: inherit;
  justify-content: inherit;
}
.jss37 {
  fill: currentColor;
  width: 1em;
  height: 1em;
  display: inline-block;
  font-size: 24px;
  transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
  user-select: none;
  flex-shrink: 0;
}
.jss38 {
  color: #f89406;
}
.jss39 {
  color: #f50057;
}
.jss40 {
  color: rgba(0, 0, 0, 0.54);
}
.jss41 {
  color: #f44336;
}
.jss42 {
  color: rgba(0, 0, 0, 0.26);
}
.jss43 {
  font-size: inherit;
}
.jss54 {
  background-color: #fff;
}
.jss55 {
  border-radius: 4px;
}
.jss56 {
  box-shadow: none;
}
.jss57 {
  box-shadow: 0px 1px 3px 0px rgba(0, 0, 0, 0.2),0px 1px 1px 0px rgba(0, 0, 0, 0.14),0px 2px 1px -1px rgba(0, 0, 0, 0.12);
}
.jss58 {
  box-shadow: 0px 1px 5px 0px rgba(0, 0, 0, 0.2),0px 2px 2px 0px rgba(0, 0, 0, 0.14),0px 3px 1px -2px rgba(0, 0, 0, 0.12);
}
.jss59 {
  box-shadow: 0px 1px 8px 0px rgba(0, 0, 0, 0.2),0px 3px 4px 0px rgba(0, 0, 0, 0.14),0px 3px 3px -2px rgba(0, 0, 0, 0.12);
}
.jss60 {
  box-shadow: 0px 2px 4px -1px rgba(0, 0, 0, 0.2),0px 4px 5px 0px rgba(0, 0, 0, 0.14),0px 1px 10px 0px rgba(0, 0, 0, 0.12);
}
.jss61 {
  box-shadow: 0px 3px 5px -1px rgba(0, 0, 0, 0.2),0px 5px 8px 0px rgba(0, 0, 0, 0.14),0px 1px 14px 0px rgba(0, 0, 0, 0.12);
}
.jss62 {
  box-shadow: 0px 3px 5px -1px rgba(0, 0, 0, 0.2),0px 6px 10px 0px rgba(0, 0, 0, 0.14),0px 1px 18px 0px rgba(0, 0, 0, 0.12);
}
.jss63 {
  box-shadow: 0px 4px 5px -2px rgba(0, 0, 0, 0.2),0px 7px 10px 1px rgba(0, 0, 0, 0.14),0px 2px 16px 1px rgba(0, 0, 0, 0.12);
}
.jss64 {
  box-shadow: 0px 5px 5px -3px rgba(0, 0, 0, 0.2),0px 8px 10px 1px rgba(0, 0, 0, 0.14),0px 3px 14px 2px rgba(0, 0, 0, 0.12);
}
.jss65 {
  box-shadow: 0px 5px 6px -3px rgba(0, 0, 0, 0.2),0px 9px 12px 1px rgba(0, 0, 0, 0.14),0px 3px 16px 2px rgba(0, 0, 0, 0.12);
}
.jss66 {
  box-shadow: 0px 6px 6px -3px rgba(0, 0, 0, 0.2),0px 10px 14px 1px rgba(0, 0, 0, 0.14),0px 4px 18px 3px rgba(0, 0, 0, 0.12);
}
.jss67 {
  box-shadow: 0px 6px 7px -4px rgba(0, 0, 0, 0.2),0px 11px 15px 1px rgba(0, 0, 0, 0.14),0px 4px 20px 3px rgba(0, 0, 0, 0.12);
}
.jss68 {
  box-shadow: 0px 7px 8px -4px rgba(0, 0, 0, 0.2),0px 12px 17px 2px rgba(0, 0, 0, 0.14),0px 5px 22px 4px rgba(0, 0, 0, 0.12);
}
.jss69 {
  box-shadow: 0px 7px 8px -4px rgba(0, 0, 0, 0.2),0px 13px 19px 2px rgba(0, 0, 0, 0.14),0px 5px 24px 4px rgba(0, 0, 0, 0.12);
}
.jss70 {
  box-shadow: 0px 7px 9px -4px rgba(0, 0, 0, 0.2),0px 14px 21px 2px rgba(0, 0, 0, 0.14),0px 5px 26px 4px rgba(0, 0, 0, 0.12);
}
.jss71 {
  box-shadow: 0px 8px 9px -5px rgba(0, 0, 0, 0.2),0px 15px 22px 2px rgba(0, 0, 0, 0.14),0px 6px 28px 5px rgba(0, 0, 0, 0.12);
}
.jss72 {
  box-shadow: 0px 8px 10px -5px rgba(0, 0, 0, 0.2),0px 16px 24px 2px rgba(0, 0, 0, 0.14),0px 6px 30px 5px rgba(0, 0, 0, 0.12);
}
.jss73 {
  box-shadow: 0px 8px 11px -5px rgba(0, 0, 0, 0.2),0px 17px 26px 2px rgba(0, 0, 0, 0.14),0px 6px 32px 5px rgba(0, 0, 0, 0.12);
}
.jss74 {
  box-shadow: 0px 9px 11px -5px rgba(0, 0, 0, 0.2),0px 18px 28px 2px rgba(0, 0, 0, 0.14),0px 7px 34px 6px rgba(0, 0, 0, 0.12);
}
.jss75 {
  box-shadow: 0px 9px 12px -6px rgba(0, 0, 0, 0.2),0px 19px 29px 2px rgba(0, 0, 0, 0.14),0px 7px 36px 6px rgba(0, 0, 0, 0.12);
}
.jss76 {
  box-shadow: 0px 10px 13px -6px rgba(0, 0, 0, 0.2),0px 20px 31px 3px rgba(0, 0, 0, 0.14),0px 8px 38px 7px rgba(0, 0, 0, 0.12);
}
.jss77 {
  box-shadow: 0px 10px 13px -6px rgba(0, 0, 0, 0.2),0px 21px 33px 3px rgba(0, 0, 0, 0.14),0px 8px 40px 7px rgba(0, 0, 0, 0.12);
}
.jss78 {
  box-shadow: 0px 10px 14px -6px rgba(0, 0, 0, 0.2),0px 22px 35px 3px rgba(0, 0, 0, 0.14),0px 8px 42px 7px rgba(0, 0, 0, 0.12);
}
.jss79 {
  box-shadow: 0px 11px 14px -7px rgba(0, 0, 0, 0.2),0px 23px 36px 3px rgba(0, 0, 0, 0.14),0px 9px 44px 8px rgba(0, 0, 0, 0.12);
}
.jss80 {
  box-shadow: 0px 11px 15px -7px rgba(0, 0, 0, 0.2),0px 24px 38px 3px rgba(0, 0, 0, 0.14),0px 9px 46px 8px rgba(0, 0, 0, 0.12);
}
.jss87 {
  width: 100%;
  display: flex;
  position: relative;
  box-sizing: border-box;
  text-align: left;
  align-items: center;
  padding-top: 12px;
  padding-bottom: 12px;
  justify-content: flex-start;
  text-decoration: none;
}
.jss88 {
  position: relative;
}
.jss89 {
  background-color: rgba(0, 0, 0, 0.01);
}
.jss91 {
  padding-top: 8px;
  padding-bottom: 8px;
}
.jss92 {
  opacity: 0.5;
}
.jss93 {
  border-bottom: 1px solid rgba(0, 0, 0, 0.12);
  background-clip: padding-box;
}
.jss94 {
  padding-left: 16px;
  padding-right: 16px;
}
@media (min-width:600px) {
  .jss94 {
    padding-left: 24px;
    padding-right: 24px;
  }
}
.jss95 {
  transition: background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
}
.jss95:hover {
  text-decoration: none;
  background-color: rgba(0, 0, 0, 0.01);
}
@media (hover: none) {
  .jss95:hover {
    background-color: transparent;
  }
}
.jss96 {
  padding-right: 32px;
}
.jss85 {
  width: auto;
  color: rgba(0, 0, 0, 0.87);
  height: 24px;
  overflow: hidden;
  font-size: 1.1428571428571428rem;
  box-sizing: content-box;
  font-weight: 400;
  line-height: 1.5em;
  font-family: Arial, sans-serif;
  white-space: nowrap;
  padding-left: 16px;
  text-overflow: ellipsis;
  padding-right: 16px;
}
.jss85.jss86 {
  background-color: rgba(0, 0, 0, 0.14);
}
.jss81 {
  margin: 0;
  padding: 0;
  position: relative;
  list-style: none;
}
.jss82 {
  padding-top: 8px;
  padding-bottom: 8px;
}
.jss83 {
  padding-top: 4px;
  padding-bottom: 4px;
}
.jss84 {
  padding-top: 0;
}
.jss101 {
  width: 40px;
  height: 40px;
  display: flex;
  position: relative;
  overflow: hidden;
  font-size: 1.4285714285714284rem;
  flex-shrink: 0;
  font-family: Arial, sans-serif;
  align-items: center;
  user-select: none;
  border-radius: 50%;
  justify-content: center;
}
.jss102 {
  color: #fafafa;
  background-color: #bdbdbd;
}
.jss103 {
  width: 100%;
  height: 100%;
  text-align: center;
  object-fit: cover;
}
.jss17 {
  display: none;
}
.is-aside.closed .jss17, .moving-featured.closed .jss17 {
  top: 0;
  left: 0;
  width: 100%;
  height: 80px;
  margin: 0;
  display: flex;
  padding: 0 30px 0 40px;
  position: absolute;
  align-items: center;
  flex-direction: row;
  justify-content: space-between;
}
.jss17 h3 {
  color: #555555;
  margin: -.2em 0 0 0;
  font-size: 1.1em;
  font-weight: 600;
  text-transform: uppercase;
}
.jss17 h3 small {
  margin: 0 0 .1em;
  display: block;
  font-size: .6em;
  font-weight: 300;
  letter-spacing: .2em;
}
.jss18 {
  color: #555555;
}
.jss19 {
  color: #f89406;
  margin: 0 calc(-.5rem + 20px) 1em calc(-.5rem + 20px);
  padding: 0 1em 1em;
  position: relative;
  font-size: 1.2em;
  line-height: 1;
  font-weight: 300;
  border-bottom: 1px solid #dedede;
}
.jss19 strong {
  display: block;
  font-weight: 600;
}
.jss19 small {
  margin: 0 0 .3em 0;
  display: block;
}
@media (min-width: 1024px) {
  .jss19 {
    margin: 0 0 1em 0;
    padding: 0 1em 1.5em;
  }
  .is-aside .jss19 {
    margin: 0 calc(-.5rem + 20px) 1em calc(-.5rem + 20px);
    padding: 0 0 1em .5em;
  }
}
.jss20 {
  top: 0;
  right: 0;
  position: absolute;
}
.jss21 {
  margin: 0 0 .7em 0;
  transition: height 1s;
}
@media (min-width: 600px) {
  .jss21 {
    margin: 0 0 1.5rem 0;
  }
}
@media (min-width: 1024px) {
  .moving-featured .jss21, .is-aside .jss21 {
    margin: 0 0 0 0;
  }
}
.jss22 {
  color: #555555;
  display: flex;
  padding: .7em 1em .7em 1em;
  align-items: center;
  align-content: center;
  flex-direction: row;
  justify-content: flex-start;
}
@media (hover: hover) {
  .jss22:hover {
    color: #f89406;
  }
  .jss22:hover .pointer {
    border-radius: 65% 75%;
  }
}
.jss23 {
  width: 60px;
  height: 60px;
  margin: 0;
  position: relative;
  overflow: hidden;
  transition: all .5s;
  flex-shrink: 0;
  border-radius: 75% 65%;
}
.jss23 img {
  width: 100%;
  height: 100%;
}
@media (min-width: 600px) {
  .jss23 {
    width: 80px;
    height: 80px;
    margin-right: .5em;
  }
}
@media (min-width: 1024px) {
  .jss23 {
    width: 90px;
    height: 90px;
    transition: all .3s;
    margin-right: .8em;
    transition-timing-function: ease;
  }
  .moving-featured .jss23, .is-aside .jss23 {
    width: 30px;
    height: 30px;
  }
}
.jss24 {
  width: 100%;
  margin: 0 0 0 1.5em;
  display: flex;
  flex-grow: 1;
  flex-direction: column;
}
.jss24 h1 {
  margin: 0;
  font-size: 1.3em;
  line-height: 1.15;
  font-weight: 600;
  letter-spacing: -0.03em;
}
.jss24 h2 {
  margin: .3em 0 0 0;
  display: block;
  font-size: 1.1em;
  line-height: 1.2;
}
@media (min-width: 1024px) {
  .moving-featured .jss24, .is-aside .jss24 {
    margin: 0 0 0 .5em;
  }
}
@media (min-width: 600px) {
  .jss24 h2 {
    font-size: 1.265em;
  }
}
@media (min-width: 1024px) {
  .jss24 h2 {
    font-size: 1.4300000000000002em;
  }
  .moving-featured .jss24 h2, .is-aside .jss24 h2 {
    display: none;
  }
}
@media (min-width: 600px) {
  .jss24 h1 {
    font-size: 1.4949999999999999em;
  }
}
@media (min-width: 1024px) {
  .jss24 h1 {
    font-size: 1.6900000000000002em;
  }
  .moving-featured .jss24 h1, .is-aside .jss24 h1 {
    font-size: 1em;
    font-weight: 400;
  }
}
.jss14 {
  top: 0;
  left: 0;
  width: 100%;
  bottom: 0;
  position: absolute;
}
.jss15 {
  padding: calc(60px + 1.3rem) 1.3rem calc(60px + 1.3rem) 1.3rem;
}
@media (min-width: 600px) {
  .jss15 {
    padding: calc(60px + 2rem) 2rem calc(60px + 2rem) 2rem;
  }
}
@media (min-width: 1024px) {
  .jss15 {
    left: 320px;
    padding: 2rem  calc(1rem + 17px) calc(2rem + 17px) 2rem;
  }
  .moving-featured .jss15, .is-aside .jss15 {
    padding: 1rem .5rem 1rem .5rem;
  }
}
.jss16 {
  margin: 0;
  padding: 0;
  list-style: none;
}
.is-aside.closed .jss16, .moving-featured.closed .jss16 {
  display: none;
}
.jss13 {
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;
  position: absolute;
  transform: translate3d(0, 0, 0);
  background: #ffffff;
  transition: left .9s;
  will-change: left, top, bottom, width;
  transition-timing-function: ease;
}
@media (max-width: 1023px) {
  .jss13.is-aside {
    left: -100%;
  }
  .jss13.is-featured {
    left: 0;
  }
}
@media (min-width: 1024px) {
  .jss13.is-featured {
    top: 0;
    left: 320px;
    width: calc(100vw - 320px - 60px);
    transition: left .9s;
  }
  .jss13.is-aside {
    top: auto;
    left: 0;
    width: 319px;
    z-index: 1;
    transition: none, bottom 0.5s;
  }
  .jss13.moving-aside {
    top: 0;
    left: calc(-100vw + 700px);
    width: calc(100vw - 320px - 60px);
    transition: left 0.9s;
  }
  .jss13.resizing-aside {
    top: auto;
    left: 0;
    width: 319px;
    transition: none;
  }
  .jss13.moving-featured {
    top: auto;
    left: 0;
    width: 319px;
    bottom: -100%;
    z-index: 1;
    transition: bottom .3s;
  }
  .jss13.resizing-featured {
    top: 0;
    left: calc(-100vw + 700px);
    width: calc(100vw - 320px - 60px);
    bottom: auto;
    transition: none;
  }
  .jss13.resizing-aside.closed {
    bottom: calc(-100% + 100px);
    height: calc(100% - 100px);
  }
  .jss13.resizing-aside.open {
    bottom: calc(-100% + 100px);
    height: calc(100% - 100px);
  }
  .jss13.is-aside.closed {
    bottom: calc(-100% + 100px + 80px);
    height: calc(100% - 100px);
  }
  .jss13.is-aside.open {
    bottom: 0;
    height: calc(100% - 100px);
  }
  .jss13.is-aside::after {
    top: 0;
    left: 20px;
    right: 20px;
    height: 0;
    content: "";
    position: absolute;
    border-top: 1px solid #dedede;
  }
}
.jss52 {
  color: #555555;
}
.jss53 {
  pointer-events: none;
}
.jss25 {
  left: 0;
  width: 100%;
  bottom: 0;
  height: 60px;
  display: flex;
  padding: 0 20px;
  position: absolute;
  background: #ffffff;
  flex-direction: row;
  justify-content: space-between;
}
.jss25::before {
  top: 0;
  left: 20px;
  right: 20px;
  height: 0;
  content: "";
  position: absolute;
  border-top: 1px solid #dedede;
}
@media (min-width: 600px) {
  .jss25 {
    padding: 0 calc(20px * 1.5);
  }
}
@media (min-width: 1024px) {
  .jss25 {
    top: 0;
    left: auto;
    right: 0;
    width: 60px;
    height: 100%;
    padding: 20px 0;
    flex-direction: column;
  }
  .jss25::before {
    top: 20px;
    left: 0;
    right: auto;
    width: 0;
    bottom: 20px;
    height: auto;
    border-left: 1px solid #dedede;
  }
}
.jss26 {
  display: flex;
  align-items: center;
  flex-direction: row;
}
@media (min-width: 1024px) {
  .jss26 {
    flex-direction: column;
  }
}
.jss27 {
  color: #555555;
}
.jss104 {
  float: right;
  margin: 5px 10px 0 0;
}
.jss105 {
  color: #555555;
}
.jss106 {
  pointer-events: none;
}
.jss97 {
  top: 0;
  left: 0;
  width: 100%;
  height: 60px;
  position: absolute;
  background: #ffffff;
}
.jss97::before {
  left: 20px;
  right: 20px;
  height: 0;
  bottom: 0;
  content: "";
  position: absolute;
  border-top: 1px solid #dedede;
}
@media (min-width: 1024px) {
  .jss97 {
    display: none;
  }
}
.jss98 {
  float: left;
  color: #555555;
  margin: 10px 0 0 15px;
}
.jss98 small {
  margin: 2px 0 0 0;
  display: block;
  font-size: .65em;
}
.jss99 {
  float: left;
  margin: 13px 0 0 30px;
  display: block;
}
.jss100 {
  width: 36px;
  border: 1px solid #ddd;
  height: 36px;
  border-radius: 65% 75%;
}
.jss1 {
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 1px;
  position: absolute;
  overflow: hidden;
}
@media print {
  .jss1 {
    position: relative;
    overflow: visible;
  }
}
article, aside, footer, header, nav, section, figcaption, figure, main {
  display: block;
}
h1 {
  margin: 0.67em 0;
  font-size: 2em;
}
hr {
  height: 0;
  overflow: visible;
  box-sizing: content-box;
}
pre {
  font-size: 1em;
  font-family: monospace, monospace;
}
a:active, a:hover {
  outline-width: 0;
}
abbr[title] {
  border-bottom: none;
  text-decoration: underline;
}
b, strong {
  font-weight: bolder;
}
code, kbp, samp {
  font-size: 1em;
  font-family: monospace, monospace;
}
dfn {
  font-style: italic;
}
mark {
  color: #000;
  background-color: #ff0;
}
small {
  font-size: 80%;
}
sub, sup {
  position: relative;
  font-size: 75%;
  line-height: 0;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
audio, video {
  display: inline-block;
}
audio:not([controls]) {
  height: 0;
  display: none;
}
img {
  border-style: none;
  vertical-align: middle;
}
svg:not(:root) {
  overflow: hidden;
}
button, input, optgroup, select, textarea {
  margin: 0;
  font-size: 100%;
  font-family: sans-serif;
  line-height: 1.15;
}
button, input {
  overflow: visible;
}
button, select {
  text-transform: none;
}
button, [type=reset], [type=submit] {
  -webkit-appearance: button;
}
button::-moz-focus-inner, [type=button]::-moz-focus-inner, [type=reset]::-moz-focus-inner, [type=submit]::-moz-focus-inner {
  padding: 0;
  border-style: none;
}
button:-moz-focusring, [type=button]:-moz-focusring, [type=reset]:-moz-focusring, [type=submit]:-moz-focusring {
  outline: 1px dotted ButtonText;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  color: inherit;
  display: table;
  padding: 0;
  max-width: 100%;
  box-sizing: border-box;
  white-space: normal;
}
progress {
  display: inline-block;
  vertical-align: baseline;
}
textarea {
  overflow: auto;
}
[type=checkbox], [type=radio] {
  padding: 0;
  box-sizing: border-box;
}
[type=number]::-webkit-inner-spin-button, [type=number]::-webkit-outer-spin-button {
  height: auto;
}
[type=search] {
  appearance: textfield;
  outline-offset: -2px;
}
[type=search]::-webkit-search-cancel-button, [type=search]::-webkit-search-decoration {
  appearance: none;
}
::-webkit-file-upload-button {
  font: inherit;
  appearance: button;
}
details, menu {
  display: block;
}
summary {
  display: list-item;
}
canvas {
  display: inline-block;
}
template {
  display: none;
}
[hidden] {
  display: none;
}
html {
  box-sizing: border-box;
  font-family: Arial;
  line-height: 1.15;
  text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  -moz-text-size-adjust: none;
  -webkit-text-size-adjust: 100%;
}
html.wf-active {
  font-family: Open Sans;
}
*, *:before, *:after {
  box-sizing: inherit;
}
noscript {
  top: 50%;
  left: 50%;
  color: #fff;
  z-index: 1000;
  padding: 1.5rem 2.5rem;
  position: absolute;
  transform: translate(-50%, -50%);
  background: #d00;
  box-shadow: 0 0 10px 52px rgba(255,255,255,.8);
  font-weight: 400;
  border-radius: 2px;
}
body {
  margin: 0;
  background: #ffffff;
  -webkit-tap-highlight-color: rgba(0,0,0,.05);
}
main {
  position: relative;
}
h1, h2, h3 {
  font-weight: 300;
}
a {
  background: transparent;
  transition: 0.3s;
  font-weight: bold;
  text-decoration: none;
  text-decoration-skip: objects;
}
input:-webkit-autofill {
  -webkit-box-shadow: 0 0 0 50px white inset;
}
:not(pre) > code[class*='language-'] {
  color: #666;
  padding: 1px 5px;
  background: #eee;
  text-shadow: none;
  border-radius: 2px;
}
.jss2 {
  top: 0;
  left: 0;
  width: 100%;
  bottom: 0;
  position: absolute;
  animation-name: main-entry;
  animation-duration: .5s;
}
@media (min-width: 1024px) {
  .jss2 {
    left: 320px;
    width: calc(100vw - 320px - 60px);
  }
}
@media print {
  .jss2 {
    position: relative;
  }
  .jss2 > div {
    overflow: visible!important;
  }
  .jss2 > div > div {
    position: relative!important;
  }
}
.jss3 {
  margin: 0 auto;
  padding: calc(1.5rem + undefinedpx) 1.8rem 1.5rem 1.5rem;
}
.jss3 strong, .jss3 b {
  font-weight: 600;
  letter-spacing: -.02em;
}
.jss3 a {
  display: inline-block;
  transition: 0.3s;
  font-weight: 600;
  text-shadow: 
         2px  2px #ffffff,
        -2px  2px #ffffff,
        -2px -2px #ffffff,
        -2px  2px #ffffff,
        -2px  0   #ffffff,
         2px  0   #ffffff
      ;
  letter-spacing: -.02em;
  text-decoration: none;
}
@media (min-width: 600px) {
  .jss3 {
    padding: calc(2.5rem + undefinedpx) 3.5rem 2.5rem;
  }
}
@media (min-width: 1024px) {
  .jss3 {
    padding: 3.5rem;
  }
}
.jss3 a:hover {
  color: hsl(35.19999999999999, 95.3%, 54.8%);
}
@keyframes main-entry {
  0% {
    opacity: 0;
    transform: translateY(20px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}
.jss4 {
  margin: 0 auto;
  padding: calc(60px + 1.5rem) 1.5rem  1.5rem 1.5rem;
  max-width: 50em;
  background: #ffffff;
}
.jss4 strong, .jss4 b {
  letter-spacing: -.02em;
}
.jss4 a {
  transition: 0.3s;
  font-weight: bold;
  letter-spacing: -.02em;
  text-decoration: underline;
}
@media (min-width: 600px) {
  .jss4 {
    padding: calc(2.5rem + 60px) 3.5rem 2.5rem;
  }
}
@media (min-width: 1024px) {
  .jss4 {
    padding: 3.5rem;
  }
}
.jss4 a:hover {
  color: hsl(35.19999999999999, 95.3%, 54.8%);
}
.jss5 {
  margin: 0 0 3em;
}
.jss6 {
  color: #555555;
  margin: 0 0 0.4em;
  font-size: 1.9em;
  font-weight: 600;
  line-height: 1.1;
  letter-spacing: -0.04em;
}
@media (min-width: 600px) {
  .jss6 {
    font-size: 2.5em;
  }
}
@media (min-width: 1024px) {
  .jss6 {
    font-size: 2.7em;
    letter-spacing: -0.05em;
  }
}
.jss7 {
  color: #555555;
  font-size: 1.5em;
  line-height: 1.1;
  font-weight: 300;
}
@media (min-width: 600px) {
  .jss7 {
    font-size: 1.8em;
  }
}
@media (min-width: 1024px) {
  .jss7 {
    font-size: 1.95em;
  }
}
.jss8 {
  color: #555555;
  font-size: 0.9em;
  font-weight: 600;
}
.jss9 {
  color: #333333;
  line-height: 1.6;
}
.jss9 a {
  color: #f89406;
}
.jss9 .gatsby-highlight {
  margin: 2em 0;
}
.jss9 .gatsby-resp-iframe-wrapper {
  margin: 2em 0;
}
.jss9 .gatsby-resp-image-link {
  margin: 2em -1.5rem;
  border: none;
}
.jss9 h2, .jss9 h3 {
  color: #555555;
  margin: 2em 0 1em;
  font-size: 1.5em;
  font-weight: 600;
  line-height: 1.3;
  letter-spacing: -0.02em;
}
.jss9 h3 {
  font-size: 1.3em;
}
.jss9 p {
  margin: 0 0 1.5em 0;
  font-weight: 400;
}
.jss9 ul {
  padding: 0 0 0 1.3em;
  list-style: circle;
}
.jss9 li {
  margin: 0 0 .5em 0;
}
.jss9 blockquote {
  border: 5px solid #bbbbbb;
  margin: 2.5em 0;
  padding: 1em 1.1em 1em 1.3em;
  position: relative;
  font-style: italic;
}
@media (min-width: 600px) {
  .jss9 {
    font-size: 1.15em;
  }
}
@media (min-width: 1024px) {
  .jss9 {
    font-size: 1.1em;
  }
}
.jss9 blockquote p {
  margin: 0;
}
.jss9 blockquote::before, .jss9 blockquote::after {
  top: -5px;
  left: 50%;
  width: 94%;
  height: 5px;
  content: "";
  position: absolute;
  background: #ffffff;
  margin-left: -47%;
}
.jss9 blockquote::after {
  top: auto;
  bottom: -5px;
}
@media (min-width: 600px) {
  .jss9 ul {
    padding: 0 0 0 2em;
  }
}
@media (min-width: 600px) {
  .jss9 .gatsby-resp-image-link {
    margin: 2.5em -3.5rem;
  }
}
.jss10 {
  font-size: calc(1em * 1);
}
.jss12 {
  color: hsl(0, 0%, 50%);
  font-size: 0.8em;
  line-height: 1.4;
}
.jss12 a {
  color: #f89406;
  font-weight: normal;
  text-shadow: none;
}
.jss12 a:hover {
  color: hsl(35.19999999999999, 95.3%, 59.8%);
}
.jss12 ul {
  margin: 0;
  padding: 0;
  list-style: none;
  text-align: center;
}
.jss12 li {
  margin: 0 .3em;
  display: inline-block;
}
.jss11 {
  color: #555555;
  padding: 1.5rem 1.5rem  calc(60px + 1.5rem) 1.5rem;
}
.jss11 p {
  margin: 0;
}
@media (min-width: 600px) {
  .jss11 {
    padding: 2rem 2.5rem  calc(60px + 2rem) 2.5rem;
  }
}
@media (min-width: 1024px) {
  .jss11 {
    padding: 2rem 3rem 2rem 3rem;
  }
}</style><title data-react-helmet="true">DarkNet CNN Source Code Analyse - PersonalBlog GatsbyJS Starter</title><meta data-react-helmet="true" name="description" content="PersonalBlog is a GatsbyJS starter."/><meta data-react-helmet="true" property="og:url" content="https://gatsby-starter-personal-blog.greglobinski.com/DarkNet-CNN-Source-Code-Analyse/"/><meta data-react-helmet="true" property="og:title" content="DarkNet CNN Source Code Analyse - PersonalBlog GatsbyJS Starter"/><meta data-react-helmet="true" property="og:description" content="PersonalBlog is a GatsbyJS starter."/><meta data-react-helmet="true" property="og:image" content="/static/darknet-a128141842710e6137de63943fa20758-160fa.png"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="fb:app_id" content=""/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content=""/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#ffffff"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><style id="gatsby-inlined-css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#f8f8f2}.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#D0E0D8"/><meta name="apple-mobile-web-app-title" content="Lazywill"/><link rel="apple-touch-icon" href="/icons/apple-icon-57x57.png" sizes="57x57"/><link rel="apple-touch-icon" href="/icons/apple-icon-60x60.png" sizes="60x60"/><link rel="apple-touch-icon" href="/icons/apple-icon-72x72.png" sizes="72x72"/><link rel="apple-touch-icon" href="/icons/apple-icon-76x76.png" sizes="76x76"/><link rel="apple-touch-icon" href="/icons/apple-icon-114x114.png" sizes="114x114"/><link rel="apple-touch-icon" href="/icons/apple-icon-120x120.png" sizes="120x120"/><link rel="apple-touch-icon" href="/icons/apple-icon-144x144.png" sizes="144x144"/><link rel="apple-touch-icon" href="/icons/apple-icon-152x152.png" sizes="152x152"/><link rel="apple-touch-icon" href="/icons/apple-icon-180x180.png" sizes="180x180"/><link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png"/></head><body><noscript>You need to enable JavaScript to run this app!</noscript><div id="___gatsby"><div class="jss1"><main class="jss2"><div style="position:relative;overflow:hidden;width:100%;height:100%"><div style="position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;-webkit-overflow-scrolling:touch;margin-right:0;margin-bottom:0"><article class="jss4"><header class="jss5"><h1 class="jss6">DarkNet CNN Source Code Analyse</h1><h2 class="jss7">介绍 DarkNet CNN 实现流程</h2><div class="jss8">Tue, 04 Dec 2018</div></header><div class="jss9 jss10"><p>在了解 全连接层反向传播的机理后，我在 Google 上找了一圈，都没有找到讲得很好的 CNN 反向传播的计算，本想通过研究 Pytorch 源码分析算法原理，发现 Pytorch 底层是调用 C 代码的，也就不了了之了。最近在学习 Darknet 源码时，终于搞懂了这部分的原理。</p>
<!--more-->
<h2>1. 前向传播</h2>
<p>这里要先说明一点，这个地方对应学过数字信号处理的同学来说，还是非常坑的。</p>
<p>数字信号处理中，实际的卷积操作如下: </p>
$$
(f*h)[m,n]=\sum_{i=-\infty}^\infty\sum_{j=-\infty}^\infty f[i,j]\cdot h[m-i,n-j]
$$
<p>而深度学习的卷积操作如下: </p>
$$
(f*h)[m,n]=\sum_{i=-\infty}^\infty\sum_{j=-\infty}^\infty f[i,j]\cdot h[i-m,j-n]
$$
<p>也就是说，深度学习中的卷积操作实际上是<strong>相关操作</strong> (correlation)</p>
<p>在数字信号处理中，一维卷积需要把信号序列 (一般是时间序列) 绕原点翻转，二维卷积则需要把信号序列 (一般是图像序列) 绕中心点旋转 $180^{\circ}$ </p>
<blockquote>
<p>convolution is a filtering operation. correlation compared the similarity of two sets of data. Correlation is a measure of relatedness of two signals.</p>
</blockquote>
<p>但其实，在深度学习中，卷积和相关可以理解为是相同的。</p>
<p>因为我们学习的就是卷积核权重，即卷积核未知，每次反向传播都会自动更新使得误差最小。而传统的图像处理采用已知的卷积核，如果不做翻转处理，结果完全不一样。当然，卷积核绕中心 $180^{\circ}$ 对称的话，两种处理结果也是相同的。</p>
<p>感兴趣的还可以看下 我的这篇博客 <a href="http://brunoliu.com/2018/06/14/thinking-of-2d-convolution/">Thinking of 2D convolution</a></p>
<h3>1.1 输出尺寸</h3>
<p>大多数博客只提到 CNN 算法的前向传播原理。其实如果搞过传统图像处理的，应该都知道，卷积层的本质就是滤波，包括高通滤波用于边缘检测，低通滤波 (如高斯滤波器) 用于图片平滑。感兴趣的可以去找相关书籍看看。</p>
<p>前向传播一个稍微麻烦的地方是 如果根据 input height, input width, kernel size, padding, stride 计算输出 output height , output width </p>
<p>公式如下: </p>
$$
\text {output height} = \Big \lfloor \cfrac {\text {input height} + 2 \times \text {padding} - \text {kernel size}} {\text {stride}} \Big \rfloor + 1 
$$
<p><code class="language-text">output width</code> 计算是类似的。</p>
<p>参考论文: <a href="https://arxiv.org/abs/1603.07285">A guide to convolution arithmetic for deep learning</a></p>
<p>对应的 GitHub repo: <a href="https://github.com/vdumoulin/conv_arithmetic">conv_arithmetic</a></p>
<h3>1.2 卷积实现</h3>
<p>这一小节参考的博客: <a href="https://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/">Why GEMM is at the heart of deep learning</a> </p>
<p>本博客着重讲的是第二点，如果实现二维卷积计算 ? </p>
<p>传统的数字信号处理中，对于两个长度相当的数据，我们通常用傅里叶变换间接求两个信号的卷积。</p>
<p>但由于深度学习中，常见的卷积核大小为 $3 \times 3$, $5 \times 5$ 等，采用傅里叶变换得不偿失，我们通常利用卷积定义直接计算。</p>
<p>由此引入本文的核心: <strong>GEMM</strong> — GEneral Matrix to Matrix Multiplication</p>
<p>它是 BLAS (Basic Linear Algebra Subprograms) library 的一部分。</p>
<p>GELL 听上去很高大上，是不是 ?</p>
<p>其实说白了就是 <strong>矩阵乘法</strong> 的计算实现。</p>
<p>矩阵乘法在深度学习中最直观的使用莫过于全连接层了，输入神经元和权重矩阵进行矩阵乘法，再和偏置矩阵相加，得到输出神经元的值。</p>
<p>言归正传，回到 CNN 实现</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 50.390625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAABYlAAAWJQFJUiTwAAABe0lEQVQoz22RTU/CQBBA+6P9C3pCo4mIATSBaKIhHjDh7MVgYvAgggItpYVd2tLS0g8srd0dh6KVRCYvk91m3u5sR+CcA4C7cEbykJLJUBKnhMBvxHEchuGm5n8IbUJl3ZwY1mhqqLopUx0hpo1rcSj3ez1RFPGI3fKVOj5WJle2V527lblbtT3MFWuB21N53DNmWPSVJCuMMFyzWkVRhO0wxoSapufsxQVAkfMi5l9KAPk4FoMlyp7vjwmdGuZIUVRVwSRJUhAEwi3VcpZ9yaAUs9IXzygnkF+uRD/YdGiOB7NBa/DR6XTfdU37aftH5rB2EsgoM8h/RpmsPl7LN3tK4/DlualOCKU0lafakeWgXE5vy7hgcLYlO2qbNva9h9zbS7Pd6TqOs5ZrhB6Yc3xkIeEFBhnnHE7CqJ/KLB3VSOq/tp4MQ8f1ZniCtQzqml53/frC2+be9e8smwRrGQs5Y93ue68/wJ/9NypIzwHGdrMVYfiJE9r+8g0dCCBSGZDZNwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"
        alt="kernelview"
        title=""
        src="/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png"
        srcset="/static/kernelview-bd0283cc68eb34bae246e8d28931361b-d8578.png 200w,
/static/kernelview-bd0283cc68eb34bae246e8d28931361b-a4478.png 400w,
/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png 768w"
        sizes="(max-width: 768px) 100vw, 768px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>CNN 层输入数据尺寸为 batch_size $\times$ depth (channel) $\times$ input height $\times$ input width，这是一个4维张量，在 Pytorch 中输入张量的顺序也是 batch $\times$ depth $\times$ height $\times$ width </p>
<p>如果考虑对 batch 循环处理，那么每次的输入数据尺寸为 depth(channel) $\times$ input height $\times$ input width </p>
<p>卷积核的大小则为  output depth $\times$ depth $\times$ kernel size $\times$ kernel size </p>
<p>注: 这里和别的博客说法不同，一般都将单个卷积核视为二维的，但其实想一下，考虑沿着深度方向 (每个输入通道) 都存在相应的不同卷积核，最后叠加。那么我们直接将沿着深度方向的所有卷积核视为一个卷积核，进行 3 维的相乘累加操作，不是更方便吗 ? </p>
<p>下图展示了输入数据尺寸为 $1 \times 2 \times 5 \times 5$ (batch:1, depth:2, height: 5, width: 5)，卷积核尺寸为 $3 \times 2 \times 3 \times 3$ (output depth: 3, input depth: 2, kernel size: 3 )，输出数据尺寸为 $1 \times 3 \times 3 \times 3$ </p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 468px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsSAAALEgHS3X78AAAC/ElEQVQ4y41UyWsTURzOQaSCC3gRERRBkHrViyf/AM+epAcpokIREbFbWu0iQkUsaEvrXiJq06Y1LdbUtKmmi91NKralS+qSNrFJJpNZ38ybN/HNvGQyTYL1HYaZ3/y+3/p9z5LMd1RVxU+K5Z6Pf3k44g0nEobRfCx5wUj3szrf7au17qmzjq4F8KeC0PZgjEPaI1lkayuoKj1x7+5yOGxE3D4z8erz+251OT76/Xlrzgar+sEvsizH43FFkvhEQhIEOpFQFOVfYAJDCDEMQ9M08aZoGlcLIcSxOI4jPkYVFnOdvCBgJwCAETGOwek5Caa/6pbMqsonGI5ls3rjGMZswQNnGUZg2EzmTYa96Gi/4mgP0zSpigx25vfP829ttW6XAqEx7flQqOiNrfxDrwCABl6NRApqKvbfqV7c2CBOZKWOOZ+l4vqppgcykPAn1I3uhQVL1c3jjQ00x2lgRhSbR7wtI16aF8wzD0Qj9z0D9q+zpG2SORinGj95Xk1PSRCmepYlCQhC7jLE9ITNB/C8qodLgYEsi5KUSxXcmLx1wykjVDJgzAoAxNzMAk6SkxnvDBmZcTPhaDwUodBW6ssQBv9EqPRiyIFIWd+MRmlthRp4YGKlsNp1usETCMdJLKQna+r1HbX2n2sdhbKkL1mz2tzfjlldZx8Ns7yggR93TO4o7jxS1rcSonSGplh4tXHQUtx9psEDZWCAbz/1Wi50nawfZAjYNx+sezbU5vKRTaY3lXSPLdW/+Px+fDmlU906PB2oeeLpGVtSk2qa27qCVFPPBM8yWBhINRl5jlEgyNATpWUYi8WgzkRjwjyb4TZ+wcIQBDHVWpaesQwpihJF7TcrAOfsj86J1Y6pNf+vqCZPipJ0LmRL0qzqWAyPDbrHlndfth8oc+0s6bn2ehKJrAikrCslzzWkaPIH3e65wzechXWeg+X9lV2zmv1/7jAiKefA972X7IdK+3eV9JTaZ4xVbQNGupN/PljZ4ql9OVzROjSxuJ739vwLqYZktpd71IcAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"
        alt="conv sum"
        title=""
        src="/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png"
        srcset="/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-96318.png 200w,
/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-dc6d3.png 400w,
/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png 468w"
        sizes="(max-width: 468px) 100vw, 468px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>每次卷积核的运算： 相乘并累加</p>
<p>矩阵乘法 $C = AB$ 的单次运算: $A$ 的行向量与 $B$ 的列向量相乘并累加</p>
<p>不知道你有没有看出来两者的联系 ？</p>
<p>是的，基本操作都是相乘并累加。</p>
<p>所有，有的人就想到了，将卷积层的计算也用矩阵乘法实现: </p>
<p>$A$ 的每一行大小为 depth $\times$ kernel size $\times$ kernel size ，$B$ 的每一列也是相同大小，矩阵相乘的基本运算对应的就是单次卷积核相乘累加操作。</p>
<p>也就是说，我们需要将 CNN 层的输入数据重新排列，根据它可以组成矩阵 $A$ 的每一行 — 矩阵 $A$ 每一行的数据就是按步长移动卷积核后，其对应位置上的原始输入数据。</p>
<p>如下图所示，将 4维的输入张量数据转为 2维矩阵 $A$ ，通常称为 im2col, 表示 image-to-column</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 45.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAABYlAAAWJQFJUiTwAAABw0lEQVQoz32R7W+aUBSH+f//g2ZxWdXWIo3V+lIVRAQBqYJcBygvwzl1vgJeFY2J6K5tto+7eT7cnOQ55/xysOv1Gl1uTKa/LduZTGf9gQm3O1S/XC7X/z7M0tpzSxmaPRc07e+SKTf6Cq+rrYUlb5bTfzpqdD5HiOiD2ye6YIpYFIp3ndKdyqY65RigYsNu3uSSuoA779kdDD7loW82Vi/N5WveSNKTDO+/tscMJrWqGnMP2AeFS+uNuEIn3E5G5fC+iP/oFjZ/5cFafYNfqV0yP/9S9r+RYZwZ57CuVNZFYii/ACk7Anmt+Wj3ygMxrbdzTq+yWMzCQ3g+RZbfI7cJZo8zIV7fP9FhipsWMaFV6XMJU3qWm8SoTaiNpCtnAJ82ePwnKNmOafSNbbBzAo3cJW5m+ITk+uFDVoUCmuNKhCYQv5SczsRdtTRopkwp44CKH3iH4wGtbXm9SnBPw1QNPiKo7QM7zmN1XeakrDGgKY21jSoLSN2gJJ0WtZpjkHDjf2Y2PfAGYygzmo/2r+5R5iwGT6fabE56PhlAarkmfVhbrigvIL2gPp/vj0d0JiSPfJtb5MRVSVgVEfy60JmwfwBsmcWHVL5fVAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"
        alt="im2col corrected"
        title=""
        src="/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png"
        srcset="/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-d8578.png 200w,
/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-a4478.png 400w,
/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png 768w"
        sizes="(max-width: 768px) 100vw, 768px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>有的人可能会说，在步长 stride 比较小，kernel 比较大的情况下，上图中不同 patch 之间必然会相互覆盖 (overlap)，也就是说生成的 2 维矩阵 $A$ 会有大量的重复数据，生成这样的矩阵既浪费内存，又浪费时间，效率会高吗 ? </p>
<p>但是，请相信，和后面的矩阵乘法的高效比起来，这一步浪费的时间是有价值的。</p>
<blockquote>
<p>The benefits from the very regular patterns of memory access outweigh the wasteful storage costs. The paper from Nvidia <a href="https://arxiv.org/pdf/1410.0759.pdf">cuDNN: efficient primitives for Deep Learning</a> describe why they ended up with a modified version of GEMM. There are a lot of advantages to being able to batch up a lot of input images against the same kernels at once.</p>
</blockquote>
<p>根据前面的分析：</p>
<ol>
<li>$A$ 的行数为 patch 的数目，即  <code class="language-text">batch size * output height * output width</code> </li>
<li>$B$ 的列数为卷积核的数目，即 <code class="language-text">output depth</code> </li>
</ol>
<p>于是输出的 2 维矩阵大小为:  <code class="language-text">batch size * output height * output width</code>  $\times$ <code class="language-text">output depth</code> ，在下一层看来，它又是一个新的 4 维矩阵。</p>
<p>如下图所示: </p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 60.15625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABYlAAAWJQFJUiTwAAACCUlEQVQoz22S22+aYBjG/W93vUO6NLV4tWQX7Xax6yVdFXWXS5atii5OBZzNUgWiKKVomBxETh/HgsI+dHTLtjdPngsefnl4yVtI0xQAwLKsIAgURdE0bVsWfJgkSbofx3FEUZQkCfpyuZAlOY7jQ1TILEld4AZeaOqW5/rbeJv+MUEQKIqiqqqmaaL4A3qcv1BwXDBdMKImzMXpaPZ9ueYFhWO4ked5MI6iCPYkv2aXfdBuF0X3223GFxR99Xl9gVnlCv26zr7BzDIGyh+Et6qqwFiYDOTeS5U43wxeqfiZRp4r/TOt/0LjuhmsmjJmoG2nillo0yy3QbXtoE2lyvO38S5dzYiIPArI43hY9AnoJz5xEhFP9dlVcoC/2LWOX+94ufxaa11nGNpxw8UElxqPPRK5H5Zc4nTvpZB4rs+bGbw25aZeaQG0ZedyKldShePmsPkG/0i/f+TixT0GHXEJJCSO9HljD1vK380BbK7NZizcajnpq9gTL+tE/gNrloLpaLaqnQugmFyjqDGEZe5bSB775Gl0jfhkMRoi2QpkDsOdG9Y7zLvE3Fz+5Sf54u6OPzRbX48cAvEHJdAvBtBxxOk+09hG9reBZ9+o/ZHWe9B407sWO4ZpwHglLngGn4+7PEPcMjhH9XiGXE4Ha2mRX9juHyW/Lwzew8awDBM4XqgbtmmBh/AnHxBnXDuuy+IAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"
        alt="im2colmult corrected1"
        title=""
        src="/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png"
        srcset="/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-d8578.png 200w,
/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-a4478.png 400w,
/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png 768w"
        sizes="(max-width: 768px) 100vw, 768px"
      />
    </span>
  </span>
  
  </a>
    </p>
<h3>1.3 利用 numpy 验证</h3>
<p>我们通过 numpy 验证两种方式计算卷积，哪一种更高效。</p>
<p>背景: </p>
<ul>
<li>
<p>一张灰度图片，大小为 $332 \times 300$, batch_size = 1， input depth = 1，因此输入数据是二维矩阵； </p>
<p>通过 python skimage 库读取图片</p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">from</span> skimage <span class="token keyword">import</span> io 
io<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'dog.jpg'</span><span class="token punctuation">)</span></code></pre>
      </div>
</li>
</ul>
<p>  
  <a
    class="gatsby-resp-image-link"
    href="/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 332px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 90.36144578313254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAASABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAME/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABtZExLDTnCIP/xAAaEAACAwEBAAAAAAAAAAAAAAABAwACERIx/9oACAEBAAEFAlrrhCDGL5vgCqW6tux0X7P/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAcEAACAgIDAAAAAAAAAAAAAAABEQAQAhIhMZH/2gAIAQEABj8CeXkShHcZmqGgHFC//8QAGhABAAMBAQEAAAAAAAAAAAAAAQARMSGxQf/aAAgBAQABPyFxXWqQzC8RlAND7GqOrdR3Q8mujEJWeRPFhk//2gAMAwEAAgADAAAAEMPHAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB4QAQACAgEFAAAAAAAAAAAAAAEAESExUYGR0eHw/9oACAEBAAE/EECoAWne1hcW8ha3V7gE7MAr5gDUxcHmXmbiQRnvGqbW40ALRUdI0dL6GKxP/9k='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"
        alt="dog"
        title=""
        src="/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg"
        srcset="/static/dog-085939e2d2f627a80f7608283c0b7574-fbbac.jpg 200w,
/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg 332w"
        sizes="(max-width: 332px) 100vw, 332px"
      />
    </span>
  </span>
  
  </a>
    </p>
<ul>
<li>
<p>卷积核大小为 $3 \times 3$ ，ouput depth = 1，padding = 1，stride = 1</p>
<p>note: 其实这个卷积核是边缘检测算子</p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
kernel <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>
      </div>
</li>
<li>
<p>输出为二维矩阵，不考虑 depth 和 batch size，大小和输入数据相同</p>
</li>
</ul>
<p>首先我们实现 <code class="language-text">zero_pad</code> 函数实现 边缘补 0</p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">zero_pad</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> pad_height<span class="token punctuation">,</span> pad_width<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" Zero-pad an image.
    Args:
        image: numpy array of shape (H, W)
        pad_width: width of the zero padding (left and right padding)
        pad_height: height of the zero padding (bottom and top padding)
    Returns:
        out: numpy array of shape (H+2*pad_height, W+2*pad_width)
    """</span>
    H<span class="token punctuation">,</span> W <span class="token operator">=</span> image<span class="token punctuation">.</span>shape
    out <span class="token operator">=</span> <span class="token boolean">None</span>

    out <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>pad_height<span class="token punctuation">,</span> W<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>pad_width<span class="token punctuation">]</span><span class="token punctuation">)</span>
    out<span class="token punctuation">[</span>pad_height<span class="token punctuation">:</span>pad_height<span class="token operator">+</span>H<span class="token punctuation">,</span> pad_width<span class="token punctuation">:</span>pad_width<span class="token operator">+</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> image<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> out</code></pre>
      </div>
<p><strong>方法一:</strong> 通过 卷积定义计算，我们需要使用两个 for 循环</p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">conv_fast</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> kernel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" An efficient implementation of convolution filter.
    Args:
        image: numpy array of shape (Hi, Wi)
        kernel: numpy array of shape (Hk, Wk)

    Returns:
        out: numpy array of shape (Hi, Wi)
    """</span>
    Hi<span class="token punctuation">,</span> Wi <span class="token operator">=</span> image<span class="token punctuation">.</span>shape
    Hk<span class="token punctuation">,</span> Wk <span class="token operator">=</span> kernel<span class="token punctuation">.</span>shape
    out <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>Hi<span class="token punctuation">,</span> Wi<span class="token punctuation">)</span><span class="token punctuation">)</span>

    pad_height <span class="token operator">=</span> <span class="token punctuation">(</span>Hk<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>
    pad_width <span class="token operator">=</span> <span class="token punctuation">(</span>Wk<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>
    
    image_padding <span class="token operator">=</span> zero_pad<span class="token punctuation">(</span>image<span class="token punctuation">,</span> pad_height<span class="token punctuation">,</span> pad_width<span class="token punctuation">)</span>
    <span class="token comment"># 两个 for 循环，按 步长为 1 逐点计算</span>
    <span class="token keyword">for</span> hi <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>Hi<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> wi <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>Wi<span class="token punctuation">)</span><span class="token punctuation">:</span>
            out<span class="token punctuation">[</span>hi<span class="token punctuation">,</span> wi<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>image_padding<span class="token punctuation">[</span>hi<span class="token punctuation">:</span>hi<span class="token operator">+</span>Hk<span class="token punctuation">,</span> wi<span class="token punctuation">:</span>wi<span class="token operator">+</span>Wk<span class="token punctuation">]</span> <span class="token operator">*</span> kernel<span class="token punctuation">)</span>

    <span class="token keyword">return</span> out</code></pre>
      </div>
<p><strong>方法二:</strong> GEMM，矩阵相乘计算</p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">conv_faster</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> kernel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Args:
        image: numpy array of shape (Hi, Wi)
        kernel: numpy array of shape (Hk, Wk)

    Returns:
        out: numpy array of shape (Hi, Wi)
    """</span>
    Hi<span class="token punctuation">,</span> Wi <span class="token operator">=</span> image<span class="token punctuation">.</span>shape
    Hk<span class="token punctuation">,</span> Wk <span class="token operator">=</span> kernel<span class="token punctuation">.</span>shape
    out <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>Hi<span class="token punctuation">,</span> Wi<span class="token punctuation">)</span><span class="token punctuation">)</span>

    pad_height <span class="token operator">=</span> <span class="token punctuation">(</span>Hk<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>
    pad_width <span class="token operator">=</span> <span class="token punctuation">(</span>Wk<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>
    
    image_padding <span class="token operator">=</span> zero_pad<span class="token punctuation">(</span>image<span class="token punctuation">,</span> pad_height<span class="token punctuation">,</span> pad_width<span class="token punctuation">)</span>
    
    gemm_input <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>Hi<span class="token operator">*</span>Wi<span class="token punctuation">,</span> Hk<span class="token operator">*</span>Wk<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 输入数据重排，得到我们需要的矩阵</span>
    <span class="token keyword">for</span> hi <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>Hi<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> wi <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>Wi<span class="token punctuation">)</span><span class="token punctuation">:</span>
            gemm_input<span class="token punctuation">[</span>hi<span class="token operator">*</span>Wi<span class="token operator">+</span>wi<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> image_padding<span class="token punctuation">[</span>hi<span class="token punctuation">:</span>hi<span class="token operator">+</span>Hk<span class="token punctuation">,</span> wi<span class="token punctuation">:</span>wi<span class="token operator">+</span>Wk<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
            
    <span class="token comment"># 一次矩阵乘法计算，直接得到结果</span>
    <span class="token comment"># out shape: (Hi*Wi, 1)</span>
    out <span class="token operator">=</span> np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>gemm_input<span class="token punctuation">,</span> kernel<span class="token punctuation">)</span>
    <span class="token comment"># 整理矩阵形状, out shape: (Hi, Wi)</span>
    out <span class="token operator">=</span> out<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>Hi<span class="token punctuation">,</span> Wi<span class="token punctuation">)</span>

    <span class="token keyword">return</span> out</code></pre>
      </div>
<p>最终结果: </p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

t0 <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>
out_fast <span class="token operator">=</span> conv_fast<span class="token punctuation">(</span>img<span class="token punctuation">,</span> kernel<span class="token punctuation">)</span>
t1 <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>
out_faster <span class="token operator">=</span> conv_faster<span class="token punctuation">(</span>img<span class="token punctuation">,</span> kernel<span class="token punctuation">)</span>
t2 <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Compare the running time of the two implementations</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"conv_fast: took %f seconds."</span> <span class="token operator">%</span> <span class="token punctuation">(</span>t1 <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"conv_faster: took %f seconds."</span> <span class="token operator">%</span> <span class="token punctuation">(</span>t2 <span class="token operator">-</span> t1<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Plot conv_nested output</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>out_fast<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'conv_fast'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>

<span class="token comment"># Plot conv_fast output</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>out_faster<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'conv_faster'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>

<span class="token comment"># Make sure that the two outputs are the same</span>
<span class="token keyword">if</span> <span class="token operator">not</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>out_fast <span class="token operator">-</span> out_faster<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Different outputs! Check your implementation."</span><span class="token punctuation">)</span></code></pre>
      </div>
<p>结果如下: </p>
<div class="gatsby-highlight" data-language="text">
      <pre class="language-text"><code class="language-text">conv_fast: took 0.563950 seconds.
conv_faster: took 0.221714 seconds.</code></pre>
      </div>
<p>使用 GEMM 算法快了 50%，是不是很有效 !</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 601px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 45.92346089850249%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABo0lEQVQoz2WRy0pCURiFTw3sRZpHo2iWECJC0ShEhx0RIUG83+8gZYg48Al8hJAigiY9gYNAGvcK4fFc+tZBS0jY7L3X/s761/9rTCaTvXq9floul88rlUowmUxexOPxaDqdjqCfoYfz+fyhwY/7MUwILZhIJC5jsVjUNM2rDRcqFApHxnQ6DSB8NhoNr1qtepz9HcArFotOt9v1AB82hq+tVkvvbq1W2+XcZrOp/ckgYQCz5QZ0SOAC+atUKlkqlMvlhjLk/KICcDaGvxzLljnc3BiNRgHMlqqgB0zcrSmJLBXKZDL3MoTxDWHWO2bi1uoMbm7MZjM/oZIAOmpBZ+bmkcLqdDpeNpsdbg1VgIIq7CkE4xBny9BPKEMelpsZOJoPDy4futz/GeqOvlbL4tDU0Z/heDwOtNvtDwlUs9Q2H9hoSvGtRIB3MsTsGV3pV1uOd5vzSn8S+qMSHjCXL4EyVVKde72eWvEGg4HAiQzR3vv9vq/vchqRdrg3Y7FY7PNwTboklUzim9oxN0l4w7oFPJEhhSOkSkkXpyUOXlwKj/APlHJ3/u12OaIAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"
        alt="conv output"
        title=""
        src="/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png"
        srcset="/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-ae8c5.png 200w,
/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-d70b4.png 400w,
/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png 601w"
        sizes="(max-width: 601px) 100vw, 601px"
      />
    </span>
  </span>
  
  </a>
    </p>
<h3>1.4 Darknet 实现</h3>
<p>在 <code class="language-text">convolutional_layer.c</code> 中，实现了 <code class="language-text">forward_convolutional_layer</code> 函数，里面主要使用了两个函数: </p>
<ol>
<li><code class="language-text">im2col_cpu</code> : 实现重排，考虑 padding, stride, kernel size 等参数</li>
<li><code class="language-text">gemm</code> : 实现矩阵乘法 $C = \alpha * AB + \beta * C$</li>
</ol>
<p>注意: <code class="language-text">gemm</code> 支持 A, B 转置，因此具体实现有 4 个对应的函数</p>
<p>这两个函数分别在 <code class="language-text">im2col.c</code> 和 <code class="language-text">gemm.c</code> 实现</p>
<h2>2. 反向传播</h2>
<p>说白了，我们要获得 3 个值，该层的 <code class="language-text">weight_updates</code>  和 <code class="language-text">bias_updates</code> ，以及更新前一层的 <code class="language-text">delta</code> </p>
<p>如果从 GEMM 的角度考虑，得到 <code class="language-text">weight_updates</code> 和 <code class="language-text">bias_updates</code> 就很容易，因为它就是矩阵相乘的偏导，我们只要把前一层的 <code class="language-text">ouput</code> 重排一下重新得到上面的矩阵 $A$ ，然后和全连接层类似。</p>
<p>至于 前一层的 <code class="language-text">delta</code> ，我们在计算矩阵偏导后，还需要多一步，逆重排，在 Darknet 中通过 <code class="language-text">col2im_cpu</code> 实现，注意这一步基本是叠加元素叠加实现的。感觉具体细节比较麻烦，主要是如何寻找索引，详细请看 <code class="language-text">col2im_cpu.c</code> 文件</p></div></article><footer class="jss11"><div class="jss12"><ul>
<li>this is a site built by <a href="https://www.gatsbyjs.org/">GatsbyJS</a>, ReactJs, CSS in JS</li>
<li>delivered by <a href="https://pages.github.com/">Github Page</a></li>
</ul></div></footer></div><div style="position:absolute;height:6px;transition:opacity 200ms;opacity:0;display:none;right:2px;bottom:2px;left:2px;border-radius:3px"><div style="position:relative;display:block;height:100%;cursor:pointer;border-radius:inherit;background-color:rgba(0,0,0,.2)"></div></div><div style="position:absolute;width:6px;transition:opacity 200ms;opacity:0;display:none;right:2px;bottom:2px;top:2px;border-radius:3px"><div style="position:relative;display:block;width:100%;cursor:pointer;border-radius:inherit;background-color:rgba(0,0,0,.2)"></div></div></div></main><nav class="jss13 is-aside open "><div class="jss14"><div style="position:relative;overflow:hidden;width:100%;height:100%"><div style="position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;-webkit-overflow-scrolling:touch;margin-right:0;margin-bottom:0"><div class="jss15"><header></header><ul class="jss16"><li class="jss21 python" style="display:block"><a class="jss22" href="/python-scope/"><div class="jss23 pointer"><div style="height:60px" class="lazyload-placeholder"></div></div><div class="jss24"><h1>Python scope</h1><h2>Python 作用域 (变量使用范围)</h2></div></a></li><li class="jss21 ai" style="display:block"><a class="jss22" href="/AI-ML-Learning-Path/"><div class="jss23 pointer"><div style="height:60px" class="lazyload-placeholder"></div></div><div class="jss24"><h1>AI ML Learning Path</h1><h2>机器学习新手学习路线</h2></div></a></li><li class="jss21 cnn" style="display:block"><a class="jss22 active" aria-current="page" href="/DarkNet-CNN-Source-Code-Analyse/"><div class="jss23 pointer"><div style="height:60px" class="lazyload-placeholder"></div></div><div class="jss24"><h1>DarkNet CNN Source Code Analyse</h1><h2>介绍 DarkNet CNN 实现流程</h2></div></a></li></ul></div></div><div style="position:absolute;height:6px;transition:opacity 200ms;opacity:0;display:none;right:2px;bottom:2px;left:2px;border-radius:3px"><div style="position:relative;display:block;height:100%;cursor:pointer;border-radius:inherit;background-color:rgba(0,0,0,.2)"></div></div><div style="position:absolute;width:6px;transition:opacity 200ms;opacity:0;display:none;right:2px;bottom:2px;top:2px;border-radius:3px"><div style="position:relative;display:block;width:100%;cursor:pointer;border-radius:inherit;background-color:rgba(0,0,0,.2)"></div></div></div></div></nav><div class="jss25"><div class="jss26"><button tabindex="0" class="jss34 jss28 jss27" type="button" aria-label="Back to list" title="Back to the list"><span class="jss33"><svg class="jss37" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></g></svg></span><span class="jss44"></span></button><a tabindex="0" class="jss34 jss28 jss27" role="button" aria-label="Search" data-shape="closed" title="Search" href="/search/"><span class="jss33"><svg class="jss37 jss27" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></g></svg></span><span class="jss44"></span></a></div><div class="jss26"><nav class="jss51"><div><div><button tabindex="0" class="jss34 jss28 jss52" type="button" aria-label="Increase font size" aria-haspopup="true" title="Change font size"><span class="jss33"><svg class="jss37" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M9 4v3h5v12h3V7h5V4H9zm-6 8h3v7h3v-7h3V9H3v3z"></path></g></svg></span><span class="jss44"></span></button></div><div class="jss53" style="position:absolute;pointer-events:none;opacity:0"><div class="jss54 jss58 jss55" style="opacity:0;transform:scale(0.75, 0.5625);transform-origin:0 0 0" id="font-menu-list"><ul class="jss81 jss82" role="menu"><li tabindex="-1" class="jss34 jss87 jss90 jss94 jss95 jss85" role="menuitem">150%<span class="jss44"></span></li><li tabindex="-1" class="jss34 jss87 jss90 jss94 jss95 jss85" role="menuitem">125%<span class="jss44"></span></li><li tabindex="-1" class="jss34 jss87 jss90 jss94 jss95 jss85" role="menuitem">100%<span class="jss44"></span></li></ul></div></div></div></nav><button tabindex="0" class="jss34 jss28" type="button" aria-label="Back to top" title="Scroll to top"><span class="jss33"><svg class="jss37 jss27" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"></path></g></svg></span><span class="jss44"></span></button></div></div><aside class="jss97"><a class="jss99" href="/"><div class="jss101 jss100"><img alt="Bruno LIU" src="data:image/jpeg;base64,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" class="jss103"/></div></a><h3 class="jss98">Bruno LIU<small>Personal blog</small></h3><nav class="jss104"><div><div><button tabindex="0" class="jss34 jss28 jss105" type="button" aria-label="More" aria-haspopup="true"><span class="jss33"><svg class="jss37" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></g></svg></span><span class="jss44"></span></button></div><div class="jss106" style="position:absolute;pointer-events:none;opacity:0"><div class="jss54 jss58 jss55" style="opacity:0;transform:scale(0.75, 0.5625);transform-origin:0 0 0" id="menu-list"><ul class="jss81 jss82" role="menu"><li tabindex="-1" class="jss34 jss87 jss90 jss94 jss95 jss85" role="menuitem">Home<span class="jss44"></span></li><a style="display:block" tabindex="-1" href="/about/"><li tabindex="-1" class="jss34 jss87 jss90 jss94 jss95 jss85" role="menuitem">About<span class="jss44"></span></li></a><a style="display:block" tabindex="-1" href="/cheatsheets/"><li tabindex="-1" class="jss34 jss87 jss90 jss94 jss95 jss85" role="menuitem">Cheatsheet<span class="jss44"></span></li></a><a style="display:block" tabindex="-1" href="/contact/"><li tabindex="-1" class="jss34 jss87 jss90 jss94 jss95 jss85" role="menuitem">Contact<span class="jss44"></span></li></a></ul></div></div></div></nav></aside></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"0":"0-eda92161a74bd28aad5d.js","1":"1-605ef3eaf6f41a331833.js","231608221292675":"app-f46259a2b5652bc066f4.js","99219681209289":"component---node-modules-gatsby-plugin-offline-app-shell-js-5c4c5a0f7af9dc69d6d7.js","198517197184460":"component---src-templates-post-template-js-bfbd078eed4e23281397.js","235131596041995":"component---src-templates-page-template-js-e0434750f574a9276ef2.js","70144966829960":"component---src-pages-contact-js-f48643e2bf24381f2f16.js","35783957827783":"component---src-pages-index-js-aa9570313651ef926b5a.js","142807904292071":"component---src-pages-search-js-0b92e4d7c3a5736ae151.js","60335399758886":"path----8e691cc3d45ccc7942ee.js","210333531512890":"path---offline-plugin-app-shell-fallback-a0e39f21c11f6a62c5ab.js","66015642191118":"path---python-scope-33d56b83f932eba98dc0.js","111750429165526":"path---cheatsheets-2a0da7f023f7c6357e2c.js","273950069227526":"path---about-e615814945a5d53f62fa.js","170786371021445":"path---success-c8abbbacde2cbbb5fb66.js","67972624922266":"path---ai-ml-learning-path-c476fd9d1d22cd8da813.js","21380530516426":"path---dark-net-cnn-source-code-analyse-0aa53d24096e16a20569.js","184662623972074":"path---contact-a0e39f21c11f6a62c5ab.js","142629428675168":"path---index-206ac74de0d3aab26f03.js","254572558124955":"path---search-976222e0528a751b1f5c.js","114276838955818":"component---src-layouts-index-js-ff03b727f34a861dfe79.js"}/*]]>*/</script><script>
            
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'undefined', 'auto');
      }
      </script><script>
        WebFontConfig = {
          google: {
            families: ["Open Sans:300,400,600"]
          }
        };

        (function(d) {
            var wf = d.createElement('script'), s = d.scripts[0];
            wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js';
            wf.async = true;
            s.parentNode.insertBefore(wf, s);
        })(document);</script><script>/*<![CDATA[*/["/commons-7dadf5fa9ddaa4eb8b31.js","/app-f46259a2b5652bc066f4.js","/path---dark-net-cnn-source-code-analyse-0aa53d24096e16a20569.js","/component---src-templates-post-template-js-bfbd078eed4e23281397.js","/component---src-layouts-index-js-ff03b727f34a861dfe79.js"].forEach(function(s){document.write('<script src="'+s+'" defer></'+'script>')})/*]]>*/</script></body></html>