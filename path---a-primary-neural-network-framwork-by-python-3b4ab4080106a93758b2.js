webpackJsonp([0x68fde3d73066],{811:function(e,t){e.exports={data:{post:{id:"F:/program/BlogSite/content/posts/2018-12-04--a-primary-neural-network-framwork-by-python/index.md absPath of file >>> MarkdownRemark",html:'<p>之前的一篇博客 <a href="https://bonblog.xyz/Back-propagation-based-on-matrix-derivative/">利用 matrix derivative 思考 back propagation</a> 介绍了反向传播的公式推导。</p>\n<p>主要公式如下: </p>\n<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="bold">W</mi></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo fence="false">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msup><mi mathvariant="bold">A</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup></mrow></mfrac><mo>∗</mo><msup><mi>g</mi><mo mathvariant="normal">′</mo></msup><mo>(</mo><msup><mi mathvariant="bold">Z</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup><mo>)</mo><mo fence="false">)</mo><msup><msup><mi mathvariant="bold">A</mi><mrow><mo>[</mo><mi>l</mi><mo>−</mo><mn>1</mn><mo>]</mo></mrow></msup><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="bold">b</mi></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo fence="false">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msup><mi mathvariant="bold">A</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup></mrow></mfrac><mo>∗</mo><msup><mi>g</mi><mo mathvariant="normal">′</mo></msup><mo>(</mo><msup><mi mathvariant="bold">Z</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup><mo>)</mo><mo fence="false">)</mo><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msup><mi mathvariant="bold">A</mi><mrow><mo>[</mo><mi>l</mi><mo>−</mo><mn>1</mn><mo>]</mo></mrow></msup></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi mathvariant="bold">W</mi><mi>T</mi></msup><mo fence="false">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msup><mi mathvariant="bold">A</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup></mrow></mfrac><mo>∗</mo><msup><mi>g</mi><mo mathvariant="normal">′</mo></msup><mo>(</mo><msup><mi mathvariant="bold">Z</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup><mo>)</mo><mo fence="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\\begin {aligned}\n\\cfrac {\\partial J} {\\partial \\mathbf {W}}  &amp;= \\Big (\\cfrac {\\partial J} {\\partial \\mathbf {A}^{[l]}}  \\ast g&#x27;(\\mathbf {Z}^{[l]}) \\Big)  {\\mathbf {A}^{[l-1]}}^T \\\\\n\\cfrac {\\partial J} {\\partial \\mathbf {b}} &amp;= \\Big (\\cfrac {\\partial J} {\\partial \\mathbf {A}^{[l]}}  \\ast g&#x27;(\\mathbf {Z}^{[l]}) \\Big) \\mathbf {K}^T \\\\\n\\cfrac {\\partial J} {\\partial \\mathbf {A}^{[l-1]}}  &amp;= \\mathbf {W}^T  \\Big (\\cfrac {\\partial J} {\\partial \\mathbf {A}^{[l]}}  \\ast g&#x27;(\\mathbf {Z}^{[l]}) \\Big)\n\\end {aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.781999999999998em;vertical-align:-3.6409999999999987em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.140999999999999em;"><span style="top:-6.140999999999998em;"><span class="pstrut" style="height:3.59em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5899999999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span></span></span></span></span><span style="top:-3.547em;"><span class="pstrut" style="height:3.59em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5899999999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathbf">b</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span></span></span></span></span><span style="top:-0.9530000000000012em;"><span class="pstrut" style="height:3.59em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5899999999999999em;"><span style="top:-2.2960000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6409999999999987em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.140999999999999em;"><span style="top:-6.140999999999998em;"><span class="pstrut" style="height:3.59em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5899999999999999em;"><span style="top:-2.2960000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="delimsizing size2">)</span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.169231em;"><span style="top:-3.3909000000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span><span style="top:-3.547em;"><span class="pstrut" style="height:3.59em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5899999999999999em;"><span style="top:-2.2960000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="delimsizing size2">)</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span><span style="top:-0.9530000000000012em;"><span class="pstrut" style="height:3.59em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5899999999999999em;"><span style="top:-2.2960000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="delimsizing size2">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6409999999999987em;"><span></span></span></span></span></span></span></span></span></span></span></span>\n<p>看完公式，你应该知道，根据梯度下降，如果我们想更新第 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span> 层的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">W</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\\mathbf {W}^{[l]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span> (weight) 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">b</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\\mathbf {b}^{[l]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">b</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span> (bias)，就必须得到上面的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msup><mi mathvariant="bold">W</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\\cfrac {\\partial J} {\\partial \\mathbf {W}^{[l]}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2939999999999996em;vertical-align:-0.704em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5899999999999999em;"><span style="top:-2.2960000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msup><mi mathvariant="bold">b</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\\cfrac {\\partial J} {\\partial \\mathbf {b}^{[l]}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2939999999999996em;vertical-align:-0.704em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5899999999999999em;"><span style="top:-2.2960000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord"><span class="mord mathbf">b</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span></span></span></span></span></span> 。</p>\n<p>而它们和 下一隐层 (准确地说，是前向传播的下一层，反向传播其实可以理解为上一层) 的梯度传递 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msup><mi mathvariant="bold">A</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\\cfrac {\\partial J} {\\partial \\mathbf {A}^{[l]}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2939999999999996em;vertical-align:-0.704em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5899999999999999em;"><span style="top:-2.2960000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span></span></span></span></span></span> 相关，同时还和这一层的输入，上一层的输出 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><msup><mi mathvariant="bold">A</mi><mrow><mo>[</mo><mi>l</mi><mo>−</mo><mn>1</mn><mo>]</mo></mrow></msup><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">{\\mathbf {A}^{[l-1]}}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1192309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1192309999999999em;"><span style="top:-3.3409em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span> 有关，此外，我们还需要这一层的输出用于计算激活函数的梯度 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>g</mi><mo mathvariant="normal">′</mo></msup><mo>(</mo><msup><mi mathvariant="bold">Z</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">g&#x27;(\\mathbf {Z}^{[l]})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 。</p>\n<p>有了这些基础知识，我们就知道怎么构建神经网络系统了</p>\n<!--more-->\n<h2>1. 基本原理</h2>\n<p>下图展示了前向传播和反向传播的流程。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-98a73.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 74.07407407407408%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAADQ0lEQVQ4y42T+0+TZxTH+6/sh23ZYrYFRDLvWMoAUTOTzW0/zGwjhIKg7mKGOiiaSluXbTp+WY2UW6HcZZsaBdsJMmoBuQtLM5tgSefQDBV6fdvPnvd5ZSFmWXaSb855z/Ocb77vOefRFdr7KLzQT4nDw3vnLtPtnUc1JZkklUqx3tTvtdxavB6q6TZWdfHyF07SKjt5UfjaK6PyIJ5Q/rVoffHzpuZ1+ZYuskytFAi/s8pJQ//YPwr/y+LxONFolFgsRjgcll4qXH7ylEd/LQs85vHTFSLikqIkSCQSQmVcXoyJYpVAjdWcklRYWvqThfsLhP4IEQgECIVCmsJnWolGIqRQuNoyiKWkju8+b8Zu6qTe0ku9tZc6c4+MaytcfHO0idqTTs6W13Nn4K6kSIgWJcVf6WTzNU5pF89083GmiTKDlfIcG+W5Vg4ZVFg4kv+1yFs4pLdizK2maPsp+jp+lXXRaOw5haIPKZLUWTsp1lfz2ds2ju61UiIKy94SJLlmjuwRpHtq+HSvjbJ91Rw/cA5P722tp7GEpjAaV1h+ssJKOCoPHLYeCredokhfRWnOGYzZpzHqzTIuzTFTmFXJ4byzGPNNfLLVhLvbJ6qSrK6GNYUH7R72f9/H/vPXWRXkgfkAA1eHGL7hw+sexesZY+TmpPTD7hGRH8Hb7+P2L6P43OM8CC5xrP80rolL2pTbhn/DfmOKpsE5EiIx7ajl8rt6+orewXP4Q259WcxQRbH0typKcJd+wPWDBfxsfJ8fDxi4d+0nLt1z4w2MaIRaDxXRhIgMB8wnaE5/gQ59Gh1Zb9C64zVcW16hddsG2sW3is6dr3PRkEmzyE23NWrTTKTk7mpTTmmLKmhx11TSKC625G/GJdCYvVESt+jTceW9SVNOJm3C/7B7O+27tzLT1fpsyhGth4qi7U9SUeSBx1aNY8ur2Hel05CdQZ0gastOx2nIkGQXdqXRnrcJx74dODe/hL+nRdYl41FtyuqLWIOq9uFikIWZKYLzdwnOzUosCvw+Oc792WnmxicZHBxjaHiCMd8ks/5F/A/CBB+uyPXT8T9t7WVfmXlERs0E+m9n+KjBT8H5KTZ85eVYu1+e/w1qMstiCjwj4AAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"\n        alt="neural network"\n        title=""\n        src="/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-48538.png"\n        srcset="/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-bed0f.png 200w,\n/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-5fd34.png 400w,\n/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-48538.png 800w,\n/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-b70ec.png 1200w,\n/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-98a73.png 1296w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>所有权重和偏置参数都存放在 <code class="language-text">parameters</code> 中，<code class="language-text">parameters[&quot;W1&quot;]</code>， <code class="language-text">parameters[&quot;b1&quot;]</code> 表示 第 1 层 权重和偏置参数</p>\n<p>基本流程如下: </p>\n<ol>\n<li>\n<p>初始化所有 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span> 层的参数</p>\n</li>\n<li>\n<p>前向传播，每一层包括 全连接 + 激活函数，每一层我们存储缓存变量 <code class="language-text">cache = (A, W, b)</code> ，(cache 包含输入矩阵 A，权重矩阵 W 以及偏置矩阵 b)，循环 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span> 层得到所有缓存变量 <code class="language-text">caches.append(cache)</code> ，最终输出结果为 <code class="language-text">AL</code> ，表示第 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span> 层输出 (一般为 sigmoid 激活函数)</p>\n<p>注意: 这里小心，第 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> 层对应的缓存变量为 <code class="language-text">cache[i-1]</code> </p>\n</li>\n<li>\n<p>计算损失函数 <code class="language-text">cost</code> , 对于交叉熵损失函数: </p>\n<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo>(</mo><msup><mi>y</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msup><mi>a</mi><mrow><mo>[</mo><mi>L</mi><mo>]</mo><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo fence="true">)</mo></mrow><mo>+</mo><mo>(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo>)</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><msup><mi>a</mi><mrow><mo>[</mo><mi>L</mi><mo>]</mo><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo fence="true">)</mo></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">-\\frac{1}{m} \\sum\\limits_{i = 1}^{m} (y^{(i)}\\log\\left(a^{[L] (i)}\\right) + (1-y^{(i)})\\log\\left(1- a^{[L](i)}\\right) )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight">L</span><span class="mclose mtight">]</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight">L</span><span class="mclose mtight">]</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mclose">)</span></span></span></span></span>\n<p>numpy 计算如下: </p>\n<div class="gatsby-highlight" data-language="python">\n      <pre class="language-python"><code class="language-python">cost <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span> Y<span class="token operator">*</span>np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>AL<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>Y<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>AL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>\n      </div>\n</li>\n<li>\n<p>后向传播：</p>\n<p>损失函数梯度</p>\n<div class="gatsby-highlight" data-language="python">\n      <pre class="language-python"><code class="language-python">dAL <span class="token operator">=</span> <span class="token operator">-</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>divide<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> AL<span class="token punctuation">)</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>divide<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> Y<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-</span> AL<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># derivative of cost with respect to AL</span></code></pre>\n      </div>\n<p>逐层向前计算梯度，公式在前面已经给出</p>\n<p>参数存放在 <code class="language-text">grads</code> 中，<code class="language-text">grads[&quot;dWi&quot;]</code> , <code class="language-text">grads[&quot;dbi&quot;]</code>, <code class="language-text">dWi</code> 和 <code class="language-text">dbi</code> 表示第 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> 层的参数梯度 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>L</mi></mrow><annotation encoding="application/x-tex">i=1,2,\\ldots, L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">L</span></span></span></span> )</p>\n<p>注意: <code class="language-text">grads[&quot;dAL&quot;]</code> 表示第 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span> 层，即输出层往前一层传播的梯度，或者说第 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">L-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 层的误差输入梯度，因此 <code class="language-text">grads[&quot;dAL&quot;]</code> 不等于上面的 <code class="language-text">dAL</code> </p>\n<div class="gatsby-highlight" data-language="python">\n      <pre class="language-python"><code class="language-python"><span class="token comment"># 第 L 层为 sigmoid 层</span>\ncurrent_cache <span class="token operator">=</span> caches<span class="token punctuation">[</span>L<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>\ngrads<span class="token punctuation">[</span><span class="token string">"dA"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> grads<span class="token punctuation">[</span><span class="token string">"dW"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> grads<span class="token punctuation">[</span><span class="token string">"db"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> linear_activation_backward<span class="token punctuation">(</span>dAL<span class="token punctuation">,</span> current_cache<span class="token punctuation">,</span> <span class="token string">\'sigmoid\'</span><span class="token punctuation">)</span>\n\n<span class="token comment"># L-1 到 1 层，但对应的 cache 索引为 L-2 到 0</span>\n<span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>L<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>       \n       current_cache <span class="token operator">=</span> caches<span class="token punctuation">[</span>l<span class="token punctuation">]</span>\n       <span class="token comment"># "dA" + (l+2) 表示 l+1 层传递给 l 层的输入梯度</span>\n       dA_prev_temp<span class="token punctuation">,</span> dW_temp<span class="token punctuation">,</span> db_temp <span class="token operator">=</span> linear_activation_backward<span class="token punctuation">(</span>grads<span class="token punctuation">[</span><span class="token string">"dA"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> current_cache<span class="token punctuation">,</span> <span class="token string">\'relu\'</span><span class="token punctuation">)</span>\n       grads<span class="token punctuation">[</span><span class="token string">"dA"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> dA_prev_temp\n       grads<span class="token punctuation">[</span><span class="token string">"dW"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> dW_temp\n       grads<span class="token punctuation">[</span><span class="token string">"db"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> db_temp</code></pre>\n      </div>\n</li>\n<li>\n<p>梯度下降法，逐层更新参数，比如更新第一层参数： </p>\n<div class="gatsby-highlight" data-language="python">\n      <pre class="language-python"><code class="language-python">parameters<span class="token punctuation">[</span><span class="token string">"W1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> parameters<span class="token punctuation">[</span><span class="token string">"W1"</span><span class="token punctuation">]</span> <span class="token operator">-</span> learning_rate <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token string">"dW1"</span><span class="token punctuation">]</span>\nparameters<span class="token punctuation">[</span><span class="token string">"b1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> parameters<span class="token punctuation">[</span><span class="token string">"b1"</span><span class="token punctuation">]</span> <span class="token operator">-</span> learning_rate <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token string">"db1"</span><span class="token punctuation">]</span></code></pre>\n      </div>\n</li>\n</ol>\n<h2>2. 前向传播</h2>\n<p>每层神经网络，前向传播，实现两个函数: </p>\n<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi mathvariant="bold">Z</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold">W</mi><msup><mi mathvariant="bold">A</mi><mrow><mo>[</mo><mi>l</mi><mo>−</mo><mn>1</mn><mo>]</mo></mrow></msup><mo>+</mo><mi mathvariant="bold">b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi mathvariant="bold">A</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>g</mi><mo>(</mo><msup><mi mathvariant="bold">Z</mi><mrow><mo>[</mo><mi>l</mi><mo>]</mo></mrow></msup><mo>)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\\begin {aligned}\n\\mathbf {Z}^{[l]} &amp;= \\mathbf {W} \\mathbf {A}^{[l-1]} + \\mathbf {b}  \\\\\n\\mathbf {A}^{[l]} &amp;= g(\\mathbf {Z}^{[l]})\n\\end {aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.196em;vertical-align:-1.348em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.848em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.3120000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.348em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.848em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathbf">b</span></span></span></span><span style="top:-2.3120000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.348em;"><span></span></span></span></span></span></span></span></span></span></span></span>\n<p>因此我们应该实现两个函数: </p>\n<div class="gatsby-highlight" data-language="python">\n      <pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">linear_forward</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> W<span class="token punctuation">,</span> b<span class="token punctuation">)</span>\n<span class="token triple-quoted-string string">"""\n输入值:\nA: 该层输入，上一层的输出，大小为 n_(l-1) x n_l\nW: 权重矩阵，大小 n_l x n_(l-1)\nb: 偏置矩阵，大小 n_l x 1 \n\n返回值: \nZ: 该层输出，\ncache: tuple (A, W, b) 保存输入的3个变量\n"""</span></code></pre>\n      </div>\n<p>该函数实现 全连接相乘，同时我们必须保存中间变量 和 权重、偏置矩阵变量</p>\n<div class="gatsby-highlight" data-language="python">\n      <pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">activation_function</span><span class="token punctuation">(</span>Z<span class="token punctuation">,</span> activation_type<span class="token punctuation">)</span>\n<span class="token triple-quoted-string string">"""\n根据激活函数类型 计算 激活函数\n\n返回值: \nA: 该层的输出，也是下一隐层的输入\ncache: 该层的输入，也就是 Z \n"""</span></code></pre>\n      </div>\n<p>该函数实现 激活函数计算 </p>\n<p>两者组合实现 <code class="language-text">linear_activation_forward(A_prev, W, b, activation)</code> 函数</p>\n<p>因此 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span> 层网络前向传播如下: </p>\n<div class="gatsby-highlight" data-language="python">\n      <pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">L_model_forward</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> parameters<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token triple-quoted-string string">"""\n    Implement forward propagation for the [LINEAR->RELU]*(L-1)->LINEAR->SIGMOID computation\n    \n    Arguments:\n    X -- data, numpy array of shape (input size, number of examples)\n    parameters -- output of initialize_parameters_deep()\n    \n    Returns:\n    AL -- last post-activation value\n    caches -- list of caches containing:\n                every cache of linear_relu_forward() (there are L-1 of them, indexed from 0 to L-2)\n                the cache of linear_sigmoid_forward() (there is one, indexed L-1)\n    """</span>\n\n    caches <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n    A <span class="token operator">=</span> X\n    L <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>                  \n    \n    <span class="token comment"># 循环计算前 L-1 层前向传播，用 "relu" activation</span>\n    <span class="token comment"># 中间结果存储在 caches</span>\n    <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        A_prev <span class="token operator">=</span> A \n        A<span class="token punctuation">,</span> cache <span class="token operator">=</span> linear_activation_forward<span class="token punctuation">(</span>A_prev<span class="token punctuation">,</span> parameters<span class="token punctuation">[</span><span class="token string">\'W\'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> parameters<span class="token punctuation">[</span><span class="token string">\'b\'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"relu"</span><span class="token punctuation">)</span>\n        caches<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cache<span class="token punctuation">)</span>\n\n    <span class="token comment"># 最后输出层，用 "sigmoid" activation</span>\n    AL<span class="token punctuation">,</span> cache <span class="token operator">=</span> linear_activation_forward<span class="token punctuation">(</span>A<span class="token punctuation">,</span> parameters<span class="token punctuation">[</span><span class="token string">\'W\'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> parameters<span class="token punctuation">[</span><span class="token string">\'b\'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"sigmoid"</span><span class="token punctuation">)</span>\n    caches<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cache<span class="token punctuation">)</span>\n\n    <span class="token keyword">assert</span><span class="token punctuation">(</span>AL<span class="token punctuation">.</span>shape <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> \n    <span class="token keyword">return</span> AL<span class="token punctuation">,</span> caches</code></pre>\n      </div>\n<h2>3. 反向传播</h2>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/backprop_kiank-fbd66aebb71987a1cd48418947df764a-9ca05.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 36.410256410256416%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABqUlEQVQoz5WQu2sUQRyA9y9QrGwNqazEv0BFhFSxUpGQxleRIo2FINgGG0lQTHxDsNEQyIlJ8BGIgRAUz3uy5vAucJzJvbJ3t7ePuZ3d2/2cXbAV/KaZj2E+Zn6a7/vEHGQciktdSutdZSHNvKD4NvYewzDArEmKywZ6qoPbkfgiRF/pUFgyMCqCiCHSk2jC8ZLg9sN9Hp9NsziRVYEhXxcazJ/5weuJHK4jKG+YPBvL8vJilrrex276vBrPM38+TX6lkQRdW6CpXUJr1+bnxyZ724dEUcjhLwf9Q+wGQRBgNTxKG23KmwaiLwkGYbIvfW7Trbn8ReM/iP55GBEvLRiqpwqBVatSz37H3Kskbh/s0yhk6CkfSB+31aKeS2Ps6gxcF9c0MfSCmnUGq93GD0PVVEHpOFi9Ll9u32J25Ahrk+PY/T6bd6aYGznK6qULeFKSezLLg9FjvDl3CqNc4vfOFs9Pn2Dh5HHK75cRnoej7mmockz+xSPe3bhCem4m8cLiU1LXL/Pt/r3Eq59WSd28ytbdaaTZw6pWWJ++xtrUJIb6SUyoZv0Ht8HrJMh0xycAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"\n        alt="backprop kiank"\n        title=""\n        src="/static/backprop_kiank-fbd66aebb71987a1cd48418947df764a-48538.png"\n        srcset="/static/backprop_kiank-fbd66aebb71987a1cd48418947df764a-bed0f.png 200w,\n/static/backprop_kiank-fbd66aebb71987a1cd48418947df764a-5fd34.png 400w,\n/static/backprop_kiank-fbd66aebb71987a1cd48418947df764a-48538.png 800w,\n/static/backprop_kiank-fbd66aebb71987a1cd48418947df764a-9ca05.png 1170w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>由于我们前面存储了 中间变量，现在可以利用公式计算反向传播了，</p>\n<p>计算过程如上图所示，利用损失函数对每个权重、偏置变量求偏导。从输出层开始逐层往前计算。 </p>\n<p>下面是 relu 梯度传播</p>\n<div class="gatsby-highlight" data-language="python">\n      <pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">relu_backward</span><span class="token punctuation">(</span>dA<span class="token punctuation">,</span> cache<span class="token punctuation">)</span>\n<span class="token triple-quoted-string string">"""\n    Arguments:\n    dA -- post-activation gradient, of any shape\n    cache -- \'Z\' where we store for computing backward propagation efficiently\n"""</span>\n\tZ <span class="token operator">=</span> cache\n    dZ <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>dA<span class="token punctuation">,</span> copy<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># just converting dz to a correct object.</span>\n    \n    <span class="token comment"># When z &lt;= 0, you should set dz to 0 as well. </span>\n    dZ<span class="token punctuation">[</span>Z <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>\n    \n    <span class="token keyword">return</span> dZ </code></pre>\n      </div>\n<p>全连接层的反向传播: </p>\n<div class="gatsby-highlight" data-language="python">\n      <pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">linear_backward</span><span class="token punctuation">(</span>dZ<span class="token punctuation">,</span> cache<span class="token punctuation">)</span>\n<span class="token triple-quoted-string string">"""\n   dZ: 后一层的梯度 dJ/dZ\n   cache: cache = (A_prev, W, b) 当前层的前向传播\n"""</span>\n    A_prev<span class="token punctuation">,</span> W<span class="token punctuation">,</span> b <span class="token operator">=</span> cache\n    m <span class="token operator">=</span> A_prev<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>\n\n    dW <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>dZ<span class="token punctuation">,</span> A_prev<span class="token punctuation">.</span>T<span class="token punctuation">)</span>\n    db <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>dZ<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n    dA_prev <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>W<span class="token punctuation">.</span>T<span class="token punctuation">,</span> dZ<span class="token punctuation">)</span>\n    \n    <span class="token keyword">return</span> dA_prev<span class="token punctuation">,</span> dW<span class="token punctuation">,</span> db</code></pre>\n      </div>\n<p>注: 这里为什么出现 <code class="language-text">1/m</code> 的原因在前篇博客中提到了。 </p>\n<p>将上面两个函数结合，可以得到如下的函数:</p>\n<div class="gatsby-highlight" data-language="python">\n      <pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">L_model_backward</span><span class="token punctuation">(</span>AL<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> caches<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token triple-quoted-string string">"""\n    Implement the backward propagation for the [LINEAR->RELU] * (L-1) -> LINEAR -> SIGMOID group\n    \n    Arguments:\n    AL -- probability vector, output of the forward propagation (L_model_forward())\n    Y -- true "label" vector (containing 0 if non-cat, 1 if cat)\n    caches -- list of caches containing:\n                every cache of linear_activation_forward() with "relu" (it\'s caches[l], for l in range(L-1) i.e l = 0...L-2)\n                the cache of linear_activation_forward() with "sigmoid" (it\'s caches[L-1])\n    \n    Returns:\n    grads -- A dictionary with the gradients\n             grads["dA" + str(l)] = ... \n             grads["dW" + str(l)] = ...\n             grads["db" + str(l)] = ... \n    """</span>\n    grads <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n    L <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>caches<span class="token punctuation">)</span> <span class="token comment"># the number of layers</span>\n    m <span class="token operator">=</span> AL<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>\n    Y <span class="token operator">=</span> Y<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>AL<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token comment"># after this line, Y is the same shape as AL</span>\n    \n    <span class="token comment"># 计算误差</span>\n    dAL <span class="token operator">=</span> <span class="token operator">-</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>divide<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> AL<span class="token punctuation">)</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>divide<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> Y<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-</span> AL<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    \n    <span class="token comment"># Lth layer (SIGMOID -> LINEAR) gradients. Inputs: "AL, Y, caches". Outputs: "grads["dAL"], grads["dWL"], grads["dbL"]</span>\n    current_cache <span class="token operator">=</span> caches<span class="token punctuation">[</span>L<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>\n    grads<span class="token punctuation">[</span><span class="token string">"dA"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> grads<span class="token punctuation">[</span><span class="token string">"dW"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> grads<span class="token punctuation">[</span><span class="token string">"db"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> linear_activation_backward<span class="token punctuation">(</span>dAL<span class="token punctuation">,</span> current_cache<span class="token punctuation">,</span> <span class="token string">\'sigmoid\'</span><span class="token punctuation">)</span>\n\n    \n    <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>L<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token comment"># lth layer: (RELU -> LINEAR) gradients.</span>\n        current_cache <span class="token operator">=</span> caches<span class="token punctuation">[</span>l<span class="token punctuation">]</span>\n        <span class="token comment"># l 是 cache 的索引，当前是第 (l+1) 层</span>\n        <span class="token comment"># 这里的下标有点容易弄错，注意传入的第一个参数是下一层的dA(按照前向传播的方向看)</span>\n        dA_prev_temp<span class="token punctuation">,</span> dW_temp<span class="token punctuation">,</span> db_temp <span class="token operator">=</span> linear_activation_backward<span class="token punctuation">(</span>grads<span class="token punctuation">[</span><span class="token string">"dA"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> current_cache<span class="token punctuation">,</span> <span class="token string">\'relu\'</span><span class="token punctuation">)</span>\n        grads<span class="token punctuation">[</span><span class="token string">"dA"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> dA_prev_temp\n        grads<span class="token punctuation">[</span><span class="token string">"dW"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> dW_temp\n        grads<span class="token punctuation">[</span><span class="token string">"db"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> db_temp\n\n    <span class="token keyword">return</span> grads</code></pre>\n      </div>\n<p>返回的 grads 就是每一层的参数梯度</p>\n<h2>4. update parameter</h2>\n<div class="gatsby-highlight" data-language="python">\n      <pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">update_parameters</span><span class="token punctuation">(</span>parameters<span class="token punctuation">,</span> grads<span class="token punctuation">,</span> learning_rate<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token triple-quoted-string string">"""\n    Update parameters using gradient descent\n    \n    Arguments:\n    parameters -- python dictionary containing your parameters \n    grads -- python dictionary containing your gradients, output of L_model_backward\n    \n    Returns:\n    parameters -- python dictionary containing your updated parameters \n                  parameters["W" + str(l)] = ... \n                  parameters["b" + str(l)] = ...\n    """</span>\n    \n    L <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span> <span class="token comment"># number of layers in the neural network</span>\n\n    <span class="token comment"># Update rule for each parameter</span>\n    <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        parameters<span class="token punctuation">[</span><span class="token string">"W"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> parameters<span class="token punctuation">[</span><span class="token string">"W"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> learning_rate <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token string">"dW"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n        parameters<span class="token punctuation">[</span><span class="token string">"b"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> parameters<span class="token punctuation">[</span><span class="token string">"b"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> learning_rate <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token string">"db"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n        \n    <span class="token keyword">return</span> parameters</code></pre>\n      </div>',
htmlAst:{type:"root",children:[{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"之前的一篇博客 "},{type:"element",tagName:"a",properties:{href:"https://bonblog.xyz/Back-propagation-based-on-matrix-derivative/"},children:[{type:"text",value:"利用 matrix derivative 思考 back propagation"}]},{type:"text",value:" 介绍了反向传播的公式推导。"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"主要公式如下: "}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["katex-display"]},children:[{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mtable",properties:{},children:[{type:"element",tagName:"mtr",properties:{},children:[{type:"element",tagName:"mtd",properties:{},children:[{type:"element",tagName:"mstyle",properties:{scriptlevel:"0",displaystyle:"true"},children:[{type:"element",tagName:"mfrac",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"J"}]}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"W"}]}]}]}]}]},{type:"element",tagName:"mtd",properties:{},children:[{type:"element",tagName:"mstyle",properties:{scriptlevel:"0",displaystyle:"true"},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"="}]},{type:"element",tagName:"mo",properties:{fence:"false"},children:[{type:"text",value:"("}]},{type:"element",tagName:"mfrac",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"J"}]}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"A"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"∗"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"g"}]},{type:"element",tagName:"mo",properties:{mathvariant:"normal"},children:[{type:"text",value:"′"}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"("}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"Z"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:")"}]},{type:"element",tagName:"mo",properties:{fence:"false"},children:[{type:"text",value:")"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"A"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"−"}]},{type:"element",tagName:"mn",properties:{},children:[{type:"text",value:"1"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"T"}]}]}]}]}]}]},{type:"element",tagName:"mtr",properties:{},children:[{type:"element",tagName:"mtd",properties:{},children:[{type:"element",tagName:"mstyle",properties:{scriptlevel:"0",displaystyle:"true"},children:[{type:"element",tagName:"mfrac",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"J"}]}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"b"}]}]}]}]}]},{type:"element",tagName:"mtd",properties:{},children:[{type:"element",tagName:"mstyle",properties:{scriptlevel:"0",displaystyle:"true"},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"="}]},{type:"element",tagName:"mo",properties:{fence:"false"},children:[{type:"text",value:"("}]},{type:"element",tagName:"mfrac",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"J"}]}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"A"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"∗"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"g"}]},{type:"element",tagName:"mo",properties:{mathvariant:"normal"},children:[{type:"text",value:"′"}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"("}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"Z"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:")"}]},{type:"element",tagName:"mo",properties:{fence:"false"},children:[{type:"text",value:")"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"K"}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"T"}]}]}]}]}]}]},{type:"element",tagName:"mtr",properties:{},children:[{type:"element",tagName:"mtd",properties:{},children:[{type:"element",tagName:"mstyle",properties:{scriptlevel:"0",displaystyle:"true"},children:[{type:"element",tagName:"mfrac",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"J"}]}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"A"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"−"}]},{type:"element",tagName:"mn",properties:{},children:[{type:"text",value:"1"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]}]}]}]}]},{type:"element",tagName:"mtd",properties:{},children:[{type:"element",tagName:"mstyle",properties:{scriptlevel:"0",displaystyle:"true"},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"="}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"W"}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"T"}]}]},{type:"element",tagName:"mo",properties:{fence:"false"},children:[{type:"text",value:"("}]},{type:"element",tagName:"mfrac",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"J"}]}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"A"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"∗"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"g"}]},{type:"element",tagName:"mo",properties:{mathvariant:"normal"},children:[{type:"text",value:"′"}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"("}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"Z"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:")"}]},{type:"element",tagName:"mo",properties:{fence:"false"},children:[{type:"text",value:")"}]}]}]}]}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"\\begin {aligned}\n\\cfrac {\\partial J} {\\partial \\mathbf {W}}  &= \\Big (\\cfrac {\\partial J} {\\partial \\mathbf {A}^{[l]}}  \\ast g'(\\mathbf {Z}^{[l]}) \\Big)  {\\mathbf {A}^{[l-1]}}^T \\\\\n\\cfrac {\\partial J} {\\partial \\mathbf {b}} &= \\Big (\\cfrac {\\partial J} {\\partial \\mathbf {A}^{[l]}}  \\ast g'(\\mathbf {Z}^{[l]}) \\Big) \\mathbf {K}^T \\\\\n\\cfrac {\\partial J} {\\partial \\mathbf {A}^{[l-1]}}  &= \\mathbf {W}^T  \\Big (\\cfrac {\\partial J} {\\partial \\mathbf {A}^{[l]}}  \\ast g'(\\mathbf {Z}^{[l]}) \\Big)\n\\end {aligned}"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:7.781999999999998em;vertical-align:-3.6409999999999987em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mtable"]},children:[{type:"element",tagName:"span",properties:{className:["col-align-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:4.140999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-6.140999999999998em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3.59em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","nulldelimiter"]},children:[]},{type:"element",tagName:"span",properties:{className:["mfrac"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.5899999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.314em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"],style:"margin-right:0.01597em;"},children:[{type:"text",value:"W"}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-3.23em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["frac-line"],style:"border-bottom-width:0.04em;"},children:[]}]},{type:"element",tagName:"span",properties:{style:"top:-3.74em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.09618em;"},children:[{type:"text",value:"J"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.686em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{},children:[]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-3.547em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3.59em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","nulldelimiter"]},children:[]},{type:"element",tagName:"span",properties:{className:["mfrac"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.5899999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.314em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"b"}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-3.23em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["frac-line"],style:"border-bottom-width:0.04em;"},children:[]}]},{type:"element",tagName:"span",properties:{style:"top:-3.74em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.09618em;"},children:[{type:"text",value:"J"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.686em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{},children:[]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-0.9530000000000012em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3.59em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","nulldelimiter"]},children:[]},{type:"element",tagName:"span",properties:{className:["mfrac"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.5899999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.2960000000000003em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"A"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.814em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.989em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mbin","mtight"]},children:[{type:"text",value:"−"}]},{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-3.23em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["frac-line"],style:"border-bottom-width:0.04em;"},children:[]}]},{type:"element",tagName:"span",properties:{style:"top:-3.74em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.09618em;"},children:[{type:"text",value:"J"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.704em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:3.6409999999999987em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["col-align-l"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:4.140999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-6.140999999999998em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3.59em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2777777777777778em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mrel"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2777777777777778em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["delimsizing","size2"]},children:[{type:"text",value:"("}]}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","nulldelimiter"]},children:[]},{type:"element",tagName:"span",properties:{className:["mfrac"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.5899999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.2960000000000003em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"A"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.814em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.989em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-3.23em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["frac-line"],style:"border-bottom-width:0.04em;"},children:[]}]},{type:"element",tagName:"span",properties:{style:"top:-3.74em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.09618em;"},children:[{type:"text",value:"J"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.704em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{},children:[]}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mbin"]},children:[{type:"text",value:"∗"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.03588em;"},children:[{type:"text",value:"g"}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.801892em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"text",value:"′"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mopen"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"Z"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.938em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mclose"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["delimsizing","size2"]},children:[{type:"text",value:")"}]}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"A"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.938em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],
style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mbin","mtight"]},children:[{type:"text",value:"−"}]},{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.169231em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.3909000000000002em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.13889em;"},children:[{type:"text",value:"T"}]}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-3.547em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3.59em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2777777777777778em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mrel"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2777777777777778em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["delimsizing","size2"]},children:[{type:"text",value:"("}]}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","nulldelimiter"]},children:[]},{type:"element",tagName:"span",properties:{className:["mfrac"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.5899999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.2960000000000003em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"A"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.814em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.989em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-3.23em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["frac-line"],style:"border-bottom-width:0.04em;"},children:[]}]},{type:"element",tagName:"span",properties:{style:"top:-3.74em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.09618em;"},children:[{type:"text",value:"J"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.704em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{},children:[]}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mbin"]},children:[{type:"text",value:"∗"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.03588em;"},children:[{type:"text",value:"g"}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.801892em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"text",value:"′"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mopen"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"Z"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.938em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mclose"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["delimsizing","size2"]},children:[{type:"text",value:")"}]}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"K"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.8913309999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.13889em;"},children:[{type:"text",value:"T"}]}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-0.9530000000000012em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3.59em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2777777777777778em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mrel"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2777777777777778em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"],style:"margin-right:0.01597em;"},children:[{type:"text",value:"W"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.8913309999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.13889em;"},children:[{type:"text",value:"T"}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["delimsizing","size2"]},children:[{type:"text",value:"("}]}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","nulldelimiter"]},children:[]},{type:"element",tagName:"span",properties:{className:["mfrac"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.5899999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.2960000000000003em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"A"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.814em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.989em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-3.23em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["frac-line"],style:"border-bottom-width:0.04em;"},children:[]}]},{type:"element",tagName:"span",properties:{style:"top:-3.74em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.09618em;"},children:[{type:"text",value:"J"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.704em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{},children:[]}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mbin"]},children:[{type:"text",value:"∗"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.03588em;"},children:[{type:"text",value:"g"}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.801892em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"text",value:"′"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mopen"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"Z"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.938em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mclose"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["delimsizing","size2"]},children:[{type:"text",value:")"}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:3.6409999999999987em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]}]}]}]}]}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"看完公式，你应该知道，根据梯度下降，如果我们想更新第 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"l"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.69444em;vertical-align:0em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]}]}]}]},{type:"text",value:" 层的 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"W"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"\\mathbf {W}^{[l]}"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.8879999999999999em;vertical-align:0em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"],style:"margin-right:0.01597em;"},children:[{type:"text",value:"W"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.8879999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.063em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]}]}]}]},{type:"text",value:" (weight) 和 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"b"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"\\mathbf {b}^{[l]}"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.8879999999999999em;vertical-align:0em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"b"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.8879999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.063em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]}]}]}]},{type:"text",value:" (bias)，就必须得到上面的 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mfrac",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"J"}]}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"W"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]}]}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"\\cfrac {\\partial J} {\\partial \\mathbf {W}^{[l]}}"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:2.2939999999999996em;vertical-align:-0.704em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","nulldelimiter"]},children:[]},{type:"element",tagName:"span",properties:{className:["mfrac"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.5899999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.2960000000000003em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"],style:"margin-right:0.01597em;"},children:[{type:"text",value:"W"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.814em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.989em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-3.23em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["frac-line"],style:"border-bottom-width:0.04em;"},children:[]}]},{type:"element",tagName:"span",properties:{style:"top:-3.74em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.09618em;"},children:[{type:"text",value:"J"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.704em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"text",value:" 和 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mfrac",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"J"}]}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"b"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]}]}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"\\cfrac {\\partial J} {\\partial \\mathbf {b}^{[l]}}"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",
tagName:"span",properties:{className:["strut"],style:"height:2.2939999999999996em;vertical-align:-0.704em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","nulldelimiter"]},children:[]},{type:"element",tagName:"span",properties:{className:["mfrac"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.5899999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.2960000000000003em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"b"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.814em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.989em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-3.23em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["frac-line"],style:"border-bottom-width:0.04em;"},children:[]}]},{type:"element",tagName:"span",properties:{style:"top:-3.74em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.09618em;"},children:[{type:"text",value:"J"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.704em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"text",value:" 。"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"而它们和 下一隐层 (准确地说，是前向传播的下一层，反向传播其实可以理解为上一层) 的梯度传递 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mfrac",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"J"}]}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"normal"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"A"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]}]}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"\\cfrac {\\partial J} {\\partial \\mathbf {A}^{[l]}}"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:2.2939999999999996em;vertical-align:-0.704em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","nulldelimiter"]},children:[]},{type:"element",tagName:"span",properties:{className:["mfrac"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.5899999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.2960000000000003em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"A"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.814em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.989em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-3.23em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["frac-line"],style:"border-bottom-width:0.04em;"},children:[]}]},{type:"element",tagName:"span",properties:{style:"top:-3.74em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"],style:"margin-right:0.05556em;"},children:[{type:"text",value:"∂"}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.09618em;"},children:[{type:"text",value:"J"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.704em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"text",value:" 相关，同时还和这一层的输入，上一层的输出 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"A"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"−"}]},{type:"element",tagName:"mn",properties:{},children:[{type:"text",value:"1"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"T"}]}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"{\\mathbf {A}^{[l-1]}}^T"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:1.1192309999999999em;vertical-align:0em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"A"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.8879999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.063em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mbin","mtight"]},children:[{type:"text",value:"−"}]},{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.1192309999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.3409em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.13889em;"},children:[{type:"text",value:"T"}]}]}]}]}]}]}]}]}]}]}]},{type:"text",value:" 有关，此外，我们还需要这一层的输出用于计算激活函数的梯度 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"g"}]},{type:"element",tagName:"mo",properties:{mathvariant:"normal"},children:[{type:"text",value:"′"}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"("}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"Z"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:")"}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"g'(\\mathbf {Z}^{[l]})"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:1.138em;vertical-align:-0.25em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.03588em;"},children:[{type:"text",value:"g"}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.751892em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.063em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"text",value:"′"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mopen"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"Z"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.8879999999999999em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.063em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mclose"]},children:[{type:"text",value:")"}]}]}]}]},{type:"text",value:" 。"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"有了这些基础知识，我们就知道怎么构建神经网络系统了"}]},{type:"text",value:"\n"},{type:"comment",value:"more"},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{},children:[{type:"text",value:"1. 基本原理"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"下图展示了前向传播和反向传播的流程。"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"\n  "},{type:"element",tagName:"a",properties:{className:["gatsby-resp-image-link"],href:"/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-98a73.png",style:"display: block",target:"_blank",rel:["noopener"]},children:[{type:"text",value:"\n  \n  "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-wrapper"],style:"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"},children:[{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-background-image"],style:"padding-bottom: 74.07407407407408%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAADQ0lEQVQ4y42T+0+TZxTH+6/sh23ZYrYFRDLvWMoAUTOTzW0/zGwjhIKg7mKGOiiaSluXbTp+WY2UW6HcZZsaBdsJMmoBuQtLM5tgSefQDBV6fdvPnvd5ZSFmWXaSb855z/Ocb77vOefRFdr7KLzQT4nDw3vnLtPtnUc1JZkklUqx3tTvtdxavB6q6TZWdfHyF07SKjt5UfjaK6PyIJ5Q/rVoffHzpuZ1+ZYuskytFAi/s8pJQ//YPwr/y+LxONFolFgsRjgcll4qXH7ylEd/LQs85vHTFSLikqIkSCQSQmVcXoyJYpVAjdWcklRYWvqThfsLhP4IEQgECIVCmsJnWolGIqRQuNoyiKWkju8+b8Zu6qTe0ku9tZc6c4+MaytcfHO0idqTTs6W13Nn4K6kSIgWJcVf6WTzNU5pF89083GmiTKDlfIcG+W5Vg4ZVFg4kv+1yFs4pLdizK2maPsp+jp+lXXRaOw5haIPKZLUWTsp1lfz2ds2ju61UiIKy94SJLlmjuwRpHtq+HSvjbJ91Rw/cA5P722tp7GEpjAaV1h+ssJKOCoPHLYeCredokhfRWnOGYzZpzHqzTIuzTFTmFXJ4byzGPNNfLLVhLvbJ6qSrK6GNYUH7R72f9/H/vPXWRXkgfkAA1eHGL7hw+sexesZY+TmpPTD7hGRH8Hb7+P2L6P43OM8CC5xrP80rolL2pTbhn/DfmOKpsE5EiIx7ajl8rt6+orewXP4Q259WcxQRbH0typKcJd+wPWDBfxsfJ8fDxi4d+0nLt1z4w2MaIRaDxXRhIgMB8wnaE5/gQ59Gh1Zb9C64zVcW16hddsG2sW3is6dr3PRkEmzyE23NWrTTKTk7mpTTmmLKmhx11TSKC625G/GJdCYvVESt+jTceW9SVNOJm3C/7B7O+27tzLT1fpsyhGth4qi7U9SUeSBx1aNY8ur2Hel05CdQZ0gastOx2nIkGQXdqXRnrcJx74dODe/hL+nRdYl41FtyuqLWIOq9uFikIWZKYLzdwnOzUosCvw+Oc792WnmxicZHBxjaHiCMd8ks/5F/A/CBB+uyPXT8T9t7WVfmXlERs0E+m9n+KjBT8H5KTZ85eVYu1+e/w1qMstiCjwj4AAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"img",properties:{className:["gatsby-resp-image-image"],style:"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;",alt:"neural network",title:"",src:"/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-48538.png",srcSet:["/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-bed0f.png 200w","/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-5fd34.png 400w","/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-48538.png 800w","/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-b70ec.png 1200w","/static/neural-network-4c267f329c42fac366ccbc5b7881bce0-98a73.png 1296w"],sizes:["(max-width:","800px)","100vw,","800px"]},children:[]},{type:"text",value:"\n    "}]},{type:"text",value:"\n  "}]},{type:"text",value:"\n  \n  "}]},{type:"text",value:"\n    "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"所有权重和偏置参数都存放在 "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"parameters"}]},{type:"text",value:" 中，"},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'parameters["W1"]'}]},{type:"text",value:"， "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'parameters["b1"]'}]},{type:"text",value:" 表示 第 1 层 权重和偏置参数"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"基本流程如下: "}]},{type:"text",value:"\n"},{type:"element",tagName:"ol",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"初始化所有 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"L"}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"L"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.68333em;vertical-align:0em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"]},children:[{type:"text",value:"L"}]}]}]}]},{type:"text",value:" 层的参数"}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"前向传播，每一层包括 全连接 + 激活函数，每一层我们存储缓存变量 "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"cache = (A, W, b)"}]},{type:"text",value:" ，(cache 包含输入矩阵 A，权重矩阵 W 以及偏置矩阵 b)，循环 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"L"}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"L"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.68333em;vertical-align:0em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"]},children:[{type:"text",value:"L"}]}]}]}]},{type:"text",value:" 层得到所有缓存变量 "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"caches.append(cache)"}]},{type:"text",value:" ，最终输出结果为 "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"AL"}]},{type:"text",value:" ，表示第 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"L"}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"L"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.68333em;vertical-align:0em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"]},children:[{type:"text",value:"L"}]}]}]}]},{type:"text",value:" 层输出 (一般为 sigmoid 激活函数)"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"注意: 这里小心，第 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"i"}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"i"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.65952em;vertical-align:0em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"]},children:[{type:"text",value:"i"}]}]}]}]},{type:"text",value:" 层对应的缓存变量为 "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"cache[i-1]"}]},{type:"text",value:" "}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"计算损失函数 "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"cost"}]},{type:"text",value:" , 对于交叉熵损失函数: "}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["katex-display"]},children:[{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"−"}]},{type:"element",tagName:"mfrac",properties:{},children:[{type:"element",tagName:"mn",properties:{},children:[{type:"text",value:"1"}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"m"}]}]},{type:"element",tagName:"munderover",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"∑"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"i"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"="}]},{type:"element",tagName:"mn",properties:{},children:[{type:"text",value:"1"}]}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"m"}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"("}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"y"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"("}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"i"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:")"}]}]}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"log"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"⁡"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{fence:"true"},children:[{type:"text",value:"("}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"a"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"L"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"("}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"i"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:")"}]}]}]},{type:"element",tagName:"mo",properties:{fence:"true"},children:[{type:"text",value:")"}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"+"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"("}]},{type:"element",tagName:"mn",properties:{},children:[{type:"text",value:"1"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"−"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"y"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"("}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"i"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:")"}]}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:")"}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"log"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"⁡"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{fence:"true"},children:[{type:"text",value:"("}]},{type:"element",tagName:"mn",properties:{},children:[{type:"text",value:"1"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"−"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"a"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"L"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"("}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"i"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:")"}]}]}]},{type:"element",tagName:"mo",properties:{fence:"true"},children:[{type:"text",value:")"}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:")"}]}]},{type:"element",tagName:"annotation",properties:{
encoding:"application/x-tex"},children:[{type:"text",value:"-\\frac{1}{m} \\sum\\limits_{i = 1}^{m} (y^{(i)}\\log\\left(a^{[L] (i)}\\right) + (1-y^{(i)})\\log\\left(1- a^{[L](i)}\\right) )"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:2.929066em;vertical-align:-1.277669em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"text",value:"−"}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","nulldelimiter"]},children:[]},{type:"element",tagName:"span",properties:{className:["mfrac"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.32144em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-2.314em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault"]},children:[{type:"text",value:"m"}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-3.23em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["frac-line"],style:"border-bottom-width:0.04em;"},children:[]}]},{type:"element",tagName:"span",properties:{style:"top:-3.677em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"text",value:"1"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.686em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mclose","nulldelimiter"]},children:[]}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.16666666666666666em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mop","op-limits"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.6513970000000002em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-1.872331em;margin-left:0em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3.05em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"]},children:[{type:"text",value:"i"}]},{type:"element",tagName:"span",properties:{className:["mrel","mtight"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"text",value:"1"}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-3.050005em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3.05em;"},children:[]},{type:"element",tagName:"span",properties:{},children:[{type:"element",tagName:"span",properties:{className:["mop","op-symbol","large-op"]},children:[{type:"text",value:"∑"}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-4.3000050000000005em;margin-left:0em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3.05em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"]},children:[{type:"text",value:"m"}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.277669em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mopen"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.03588em;"},children:[{type:"text",value:"y"}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.938em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"]},children:[{type:"text",value:"i"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:")"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.16666666666666666em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mop"]},children:[{type:"text",value:"lo"},{type:"element",tagName:"span",properties:{style:"margin-right:0.01389em;"},children:[{type:"text",value:"g"}]}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.16666666666666666em;"},children:[]},{type:"element",tagName:"span",properties:{className:["minner"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","delimcenter"],style:"top:0em;"},children:[{type:"element",tagName:"span",properties:{className:["delimsizing","size2"]},children:[{type:"text",value:"("}]}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault"]},children:[{type:"text",value:"a"}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.938em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"]},children:[{type:"text",value:"L"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"]},children:[{type:"text",value:"i"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:")"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mclose","delimcenter"],style:"top:0em;"},children:[{type:"element",tagName:"span",properties:{className:["delimsizing","size2"]},children:[{type:"text",value:")"}]}]}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mbin"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]}]},{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:1em;vertical-align:-0.25em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mopen"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mbin"]},children:[{type:"text",value:"−"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]}]},{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:1.80002em;vertical-align:-0.65002em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.03588em;"},children:[{type:"text",value:"y"}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.938em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"]},children:[{type:"text",value:"i"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:")"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mclose"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.16666666666666666em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mop"]},children:[{type:"text",value:"lo"},{type:"element",tagName:"span",properties:{style:"margin-right:0.01389em;"},children:[{type:"text",value:"g"}]}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.16666666666666666em;"},children:[]},{type:"element",tagName:"span",properties:{className:["minner"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","delimcenter"],style:"top:0em;"},children:[{type:"element",tagName:"span",properties:{className:["delimsizing","size2"]},children:[{type:"text",value:"("}]}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mbin"]},children:[{type:"text",value:"−"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathdefault"]},children:[{type:"text",value:"a"}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.938em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"]},children:[{type:"text",value:"L"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"]},children:[{type:"text",value:"i"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:")"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mclose","delimcenter"],style:"top:0em;"},children:[{type:"element",tagName:"span",properties:{className:["delimsizing","size2"]},children:[{type:"text",value:")"}]}]}]},{type:"element",tagName:"span",properties:{className:["mclose"]},children:[{type:"text",value:")"}]}]}]}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"numpy 计算如下: "}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"python"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-python"]},children:[{type:"element",tagName:"code",properties:{className:["language-python"]},children:[{type:"text",value:"cost "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"/"}]},{type:"text",value:"m "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"*"}]},{type:"text",value:" np"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"sum"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:" Y"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"*"}]},{type:"text",value:"np"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"log"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"AL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:"Y"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"*"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"np"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"log"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:"AL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"后向传播："}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"损失函数梯度"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"python"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-python"]},children:[{type:"element",tagName:"code",properties:{className:["language-python"]},children:[{type:"text",value:"dAL "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"np"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"divide"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"Y"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" AL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" np"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"divide"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" Y"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" AL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# derivative of cost with respect to AL"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"逐层向前计算梯度，公式在前面已经给出"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"参数存放在 "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"grads"}]},{type:"text",value:" 中，"},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'grads["dWi"]'}]},{type:"text",value:" , "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'grads["dbi"]'}]},{type:"text",value:", "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"dWi"}]},{type:"text",value:" 和 "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"dbi"}]},{type:"text",value:" 表示第 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"i"}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"i"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.65952em;vertical-align:0em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"]},children:[{type:"text",value:"i"}]}]}]}]},{type:"text",value:" 层的参数梯度 ("},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"i"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"="}]},{type:"element",tagName:"mn",properties:{},children:[{type:"text",value:"1"}]},{type:"element",tagName:"mo",properties:{separator:"true"},children:[{type:"text",value:","}]},{type:"element",tagName:"mn",properties:{},children:[{type:"text",value:"2"}]},{type:"element",tagName:"mo",properties:{separator:"true"},children:[{type:"text",value:","}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"…"}]},{type:"element",tagName:"mo",properties:{separator:"true"},children:[{type:"text",value:","}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"L"}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"i=1,2,\\ldots, L"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.65952em;vertical-align:0em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"]},children:[{type:"text",value:"i"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2777777777777778em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mrel"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2777777777777778em;"},children:[]}]},{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.8777699999999999em;vertical-align:-0.19444em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["mpunct"]},children:[{type:"text",value:","}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.16666666666666666em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"text",value:"2"}]},{type:"element",tagName:"span",properties:{className:["mpunct"]},children:[{type:"text",value:","}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.16666666666666666em;"},children:[]},{type:"element",tagName:"span",properties:{className:["minner"]},children:[{type:"text",value:"…"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.16666666666666666em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mpunct"]},children:[{type:"text",value:","}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.16666666666666666em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"]},children:[{type:"text",value:"L"}]}]}]}]},{type:"text",value:" )"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"注意: "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'grads["dAL"]'}]},{type:"text",value:" 表示第 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"L"}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"L"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.68333em;vertical-align:0em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"]},children:[{type:"text",value:"L"}]}]}]}]},{type:"text",value:" 层，即输出层往前一层传播的梯度，或者说第 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"L"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"−"}]},{type:"element",tagName:"mn",properties:{},children:[{type:"text",value:"1"}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"L-1"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.76666em;vertical-align:-0.08333em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"]},children:[{type:"text",value:"L"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mbin"]},children:[{type:"text",value:"−"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]}]},{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.64444em;vertical-align:0em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"text",value:"1"}]}]}]}]},{type:"text",value:" 层的误差输入梯度，因此 "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'grads["dAL"]'}]},{type:"text",value:" 不等于上面的 "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"dAL"}]},{type:"text",value:" "}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"python"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-python"]},children:[{type:"element",tagName:"code",properties:{className:["language-python"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# 第 L 层为 sigmoid 层"}]},{type:"text",value:"\ncurrent_cache "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" caches"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"text",value:"L"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\ngrads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"dA"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"L"},{type:"element",tagName:"span",
properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"dW"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"L"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"db"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"L"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" linear_activation_backward"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"dAL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" current_cache"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'sigmoid'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# L-1 到 1 层，但对应的 cache 索引为 L-2 到 0"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"for"}]},{type:"text",value:" l "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"in"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"reversed"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"range"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"L"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:"       \n       current_cache "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" caches"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"text",value:"l"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\n       "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:'# "dA" + (l+2) 表示 l+1 层传递给 l 层的输入梯度'}]},{type:"text",value:"\n       dA_prev_temp"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" dW_temp"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" db_temp "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" linear_activation_backward"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"dA"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"2"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" current_cache"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'relu'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n       grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"dA"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" dA_prev_temp\n       grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"dW"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" dW_temp\n       grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"db"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" db_temp"}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"梯度下降法，逐层更新参数，比如更新第一层参数： "}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"python"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-python"]},children:[{type:"element",tagName:"code",properties:{className:["language-python"]},children:[{type:"text",value:"parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"W1"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"W1"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" learning_rate "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"*"}]},{type:"text",value:" grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"dW1"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\nparameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"b1"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"b1"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" learning_rate "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"*"}]},{type:"text",value:" grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"db1"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{},children:[{type:"text",value:"2. 前向传播"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"每层神经网络，前向传播，实现两个函数: "}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["katex-display"]},children:[{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mtable",properties:{},children:[{type:"element",tagName:"mtr",properties:{},children:[{type:"element",tagName:"mtd",properties:{},children:[{type:"element",tagName:"mstyle",properties:{scriptlevel:"0",displaystyle:"true"},children:[{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"Z"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]}]}]},{type:"element",tagName:"mtd",properties:{},children:[{type:"element",tagName:"mstyle",properties:{scriptlevel:"0",displaystyle:"true"},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"="}]},{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"W"}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"A"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"−"}]},{type:"element",tagName:"mn",properties:{},children:[{type:"text",value:"1"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"+"}]},{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"b"}]}]}]}]}]},{type:"element",tagName:"mtr",properties:{},children:[{type:"element",tagName:"mtd",properties:{},children:[{type:"element",tagName:"mstyle",properties:{scriptlevel:"0",displaystyle:"true"},children:[{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"A"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]}]}]},{type:"element",tagName:"mtd",properties:{},children:[{type:"element",tagName:"mstyle",properties:{scriptlevel:"0",displaystyle:"true"},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"="}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"g"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"("}]},{type:"element",tagName:"msup",properties:{},children:[{type:"element",tagName:"mi",properties:{mathvariant:"bold"},children:[{type:"text",value:"Z"}]},{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"["}]},{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"l"}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:"]"}]}]}]},{type:"element",tagName:"mo",properties:{},children:[{type:"text",value:")"}]}]}]}]}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"\\begin {aligned}\n\\mathbf {Z}^{[l]} &= \\mathbf {W} \\mathbf {A}^{[l-1]} + \\mathbf {b}  \\\\\n\\mathbf {A}^{[l]} &= g(\\mathbf {Z}^{[l]})\n\\end {aligned}"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:3.196em;vertical-align:-1.348em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mtable"]},children:[{type:"element",tagName:"span",properties:{className:["col-align-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.848em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.91em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"Z"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.938em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-2.3120000000000003em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"A"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.938em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.348em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["col-align-l"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t","vlist-t2"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.848em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.91em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2777777777777778em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mrel"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2777777777777778em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"],style:"margin-right:0.01597em;"},children:[{type:"text",value:"W"}]}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"A"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.938em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mbin","mtight"]},children:[{type:"text",value:"−"}]},{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mbin"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2222222222222222em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"b"}]}]}]}]},{type:"element",tagName:"span",properties:{style:"top:-2.3120000000000003em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:3em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2777777777777778em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mrel"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["mspace"],style:"margin-right:0.2777777777777778em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"],style:"margin-right:0.03588em;"},children:[{type:"text",value:"g"}]},{type:"element",tagName:"span",properties:{className:["mopen"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mathbf"]},children:[{type:"text",value:"Z"}]}]},{type:"element",tagName:"span",properties:{className:["msupsub"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-t"]},children:[{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:0.938em;"},children:[{type:"element",tagName:"span",properties:{style:"top:-3.113em;margin-right:0.05em;"},children:[{type:"element",tagName:"span",properties:{className:["pstrut"],style:"height:2.7em;"},children:[]},{type:"element",tagName:"span",properties:{className:["sizing","reset-size6","size3","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mord","mtight"]},children:[{type:"element",tagName:"span",properties:{className:["mopen","mtight"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault","mtight"],style:"margin-right:0.01968em;"},children:[{type:"text",value:"l"}]},{type:"element",tagName:"span",properties:{className:["mclose","mtight"]},children:[{type:"text",value:"]"}]}]}]}]}]}]}]}]}]},{type:"element",tagName:"span",properties:{className:["mclose"]},children:[{type:"text",value:")"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["vlist-s"]},children:[{type:"text",value:"​"}]}]},{type:"element",tagName:"span",properties:{className:["vlist-r"]},children:[{type:"element",tagName:"span",properties:{className:["vlist"],style:"height:1.348em;"},children:[{type:"element",tagName:"span",properties:{},children:[]}]}]}]}]}]}]}]}]}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"因此我们应该实现两个函数: "}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"python"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-python"]},children:[{type:"element",tagName:"code",properties:{className:["language-python"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"def"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"linear_forward"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"A"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" W"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" b"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","triple-quoted-string","string"]},children:[{type:"text",value:'"""\n输入值:\nA: 该层输入，上一层的输出，大小为 n_(l-1) x n_l\nW: 权重矩阵，大小 n_l x n_(l-1)\nb: 偏置矩阵，大小 n_l x 1 \n\n返回值: \nZ: 该层输出，\ncache: tuple (A, W, b) 保存输入的3个变量\n"""'}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"该函数实现 全连接相乘，同时我们必须保存中间变量 和 权重、偏置矩阵变量"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"python"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-python"]},children:[{type:"element",tagName:"code",properties:{className:["language-python"]
},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"def"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"activation_function"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"Z"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" activation_type"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","triple-quoted-string","string"]},children:[{type:"text",value:'"""\n根据激活函数类型 计算 激活函数\n\n返回值: \nA: 该层的输出，也是下一隐层的输入\ncache: 该层的输入，也就是 Z \n"""'}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"该函数实现 激活函数计算 "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"两者组合实现 "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"linear_activation_forward(A_prev, W, b, activation)"}]},{type:"text",value:" 函数"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"因此 "},{type:"element",tagName:"span",properties:{className:["katex"]},children:[{type:"element",tagName:"span",properties:{className:["katex-mathml"]},children:[{type:"element",tagName:"math",properties:{},children:[{type:"element",tagName:"semantics",properties:{},children:[{type:"element",tagName:"mrow",properties:{},children:[{type:"element",tagName:"mi",properties:{},children:[{type:"text",value:"L"}]}]},{type:"element",tagName:"annotation",properties:{encoding:"application/x-tex"},children:[{type:"text",value:"L"}]}]}]}]},{type:"element",tagName:"span",properties:{className:["katex-html"],ariaHidden:"true"},children:[{type:"element",tagName:"span",properties:{className:["base"]},children:[{type:"element",tagName:"span",properties:{className:["strut"],style:"height:0.68333em;vertical-align:0em;"},children:[]},{type:"element",tagName:"span",properties:{className:["mord","mathdefault"]},children:[{type:"text",value:"L"}]}]}]}]},{type:"text",value:" 层网络前向传播如下: "}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"python"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-python"]},children:[{type:"element",tagName:"code",properties:{className:["language-python"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"def"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"L_model_forward"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"X"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","triple-quoted-string","string"]},children:[{type:"text",value:'"""\n    Implement forward propagation for the [LINEAR->RELU]*(L-1)->LINEAR->SIGMOID computation\n    \n    Arguments:\n    X -- data, numpy array of shape (input size, number of examples)\n    parameters -- output of initialize_parameters_deep()\n    \n    Returns:\n    AL -- last post-activation value\n    caches -- list of caches containing:\n                every cache of linear_relu_forward() (there are L-1 of them, indexed from 0 to L-2)\n                the cache of linear_sigmoid_forward() (there is one, indexed L-1)\n    """'}]},{type:"text",value:"\n\n    caches "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\n    A "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" X\n    L "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"len"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"//"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"2"}]},{type:"text",value:"                  \n    \n    "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:'# 循环计算前 L-1 层前向传播，用 "relu" activation'}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# 中间结果存储在 caches"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"for"}]},{type:"text",value:" l "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"in"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"range"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" L"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:"\n        A_prev "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" A \n        A"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" cache "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" linear_activation_forward"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"A_prev"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'W'"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'b'"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" activation "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"relu"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n        caches"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"append"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"cache"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n\n    "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:'# 最后输出层，用 "sigmoid" activation'}]},{type:"text",value:"\n    AL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" cache "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" linear_activation_forward"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"A"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'W'"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"L"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'b'"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"L"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" activation "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"sigmoid"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n    caches"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"append"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"cache"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n\n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"assert"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"AL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"shape "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"=="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"X"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"shape"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" \n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" AL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" caches"}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{},children:[{type:"text",value:"3. 反向传播"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"\n  "},{type:"element",tagName:"a",properties:{className:["gatsby-resp-image-link"],href:"/static/backprop_kiank-fbd66aebb71987a1cd48418947df764a-9ca05.png",style:"display: block",target:"_blank",rel:["noopener"]},children:[{type:"text",value:"\n  \n  "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-wrapper"],style:"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"},children:[{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-background-image"],style:"padding-bottom: 36.410256410256416%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABqUlEQVQoz5WQu2sUQRyA9y9QrGwNqazEv0BFhFSxUpGQxleRIo2FINgGG0lQTHxDsNEQyIlJ8BGIgRAUz3uy5vAucJzJvbJ3t7ePuZ3d2/2cXbAV/KaZj2E+Zn6a7/vEHGQciktdSutdZSHNvKD4NvYewzDArEmKywZ6qoPbkfgiRF/pUFgyMCqCiCHSk2jC8ZLg9sN9Hp9NsziRVYEhXxcazJ/5weuJHK4jKG+YPBvL8vJilrrex276vBrPM38+TX6lkQRdW6CpXUJr1+bnxyZ724dEUcjhLwf9Q+wGQRBgNTxKG23KmwaiLwkGYbIvfW7Trbn8ReM/iP55GBEvLRiqpwqBVatSz37H3Kskbh/s0yhk6CkfSB+31aKeS2Ps6gxcF9c0MfSCmnUGq93GD0PVVEHpOFi9Ll9u32J25Ahrk+PY/T6bd6aYGznK6qULeFKSezLLg9FjvDl3CqNc4vfOFs9Pn2Dh5HHK75cRnoej7mmockz+xSPe3bhCem4m8cLiU1LXL/Pt/r3Eq59WSd28ytbdaaTZw6pWWJ++xtrUJIb6SUyoZv0Ht8HrJMh0xycAAAAASUVORK5CYII='); background-size: cover; display: block;"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"img",properties:{className:["gatsby-resp-image-image"],style:"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;",alt:"backprop kiank",title:"",src:"/static/backprop_kiank-fbd66aebb71987a1cd48418947df764a-48538.png",srcSet:["/static/backprop_kiank-fbd66aebb71987a1cd48418947df764a-bed0f.png 200w","/static/backprop_kiank-fbd66aebb71987a1cd48418947df764a-5fd34.png 400w","/static/backprop_kiank-fbd66aebb71987a1cd48418947df764a-48538.png 800w","/static/backprop_kiank-fbd66aebb71987a1cd48418947df764a-9ca05.png 1170w"],sizes:["(max-width:","800px)","100vw,","800px"]},children:[]},{type:"text",value:"\n    "}]},{type:"text",value:"\n  "}]},{type:"text",value:"\n  \n  "}]},{type:"text",value:"\n    "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"由于我们前面存储了 中间变量，现在可以利用公式计算反向传播了，"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"计算过程如上图所示，利用损失函数对每个权重、偏置变量求偏导。从输出层开始逐层往前计算。 "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"下面是 relu 梯度传播"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"python"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-python"]},children:[{type:"element",tagName:"code",properties:{className:["language-python"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"def"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"relu_backward"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"dA"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" cache"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","triple-quoted-string","string"]},children:[{type:"text",value:'"""\n    Arguments:\n    dA -- post-activation gradient, of any shape\n    cache -- \'Z\' where we store for computing backward propagation efficiently\n"""'}]},{type:"text",value:"\n\tZ "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" cache\n    dZ "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" np"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"array"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"dA"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" copy"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","boolean"]},children:[{type:"text",value:"True"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# just converting dz to a correct object."}]},{type:"text",value:"\n    \n    "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# When z <= 0, you should set dz to 0 as well. "}]},{type:"text",value:"\n    dZ"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"text",value:"Z "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"<="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"0"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"0"}]},{type:"text",value:"\n    \n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" dZ "}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"全连接层的反向传播: "}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"python"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-python"]},children:[{type:"element",tagName:"code",properties:{className:["language-python"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"def"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"linear_backward"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"dZ"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" cache"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","triple-quoted-string","string"]},children:[{type:"text",value:'"""\n   dZ: 后一层的梯度 dJ/dZ\n   cache: cache = (A_prev, W, b) 当前层的前向传播\n"""'}]},{type:"text",value:"\n    A_prev"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" W"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" b "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" cache\n    m "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" A_prev"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"shape"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\n\n    dW "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"/"}]},{type:"text",value:"m "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"*"}]},{type:"text",value:" np"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"dot"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"dZ"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" A_prev"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"T"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n    db "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"/"}]},{type:"text",value:"m "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"*"}]},{type:"text",value:" np"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"sum"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"dZ"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" axis"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" keepdims"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","boolean"]},children:[{type:"text",value:"True"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n    dA_prev "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" np"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"dot"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"W"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"T"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" dZ"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n    \n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" dA_prev"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" dW"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" db"}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"注: 这里为什么出现 "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"1/m"}]},{type:"text",value:" 的原因在前篇博客中提到了。 "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"将上面两个函数结合，可以得到如下的函数:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"python"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-python"]},children:[{type:"element",tagName:"code",properties:{className:["language-python"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"def"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"L_model_backward"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"AL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" Y"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" caches"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","triple-quoted-string","string"]},children:[{type:"text",value:'"""\n    Implement the backward propagation for the [LINEAR->RELU] * (L-1) -> LINEAR -> SIGMOID group\n    \n    Arguments:\n    AL -- probability vector, output of the forward propagation (L_model_forward())\n    Y -- true "label" vector (containing 0 if non-cat, 1 if cat)\n    caches -- list of caches containing:\n                every cache of linear_activation_forward() with "relu" (it\'s caches[l], for l in range(L-1) i.e l = 0...L-2)\n                the cache of linear_activation_forward() with "sigmoid" (it\'s caches[L-1])\n    \n    Returns:\n    grads -- A dictionary with the gradients\n             grads["dA" + str(l)] = ... \n             grads["dW" + str(l)] = ...\n             grads["db" + str(l)] = ... \n    """'}]},{type:"text",value:"\n    grads "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{
type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n    L "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"len"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"caches"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# the number of layers"}]},{type:"text",value:"\n    m "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" AL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"shape"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\n    Y "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" Y"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"reshape"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"AL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"shape"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# after this line, Y is the same shape as AL"}]},{type:"text",value:"\n    \n    "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# 计算误差"}]},{type:"text",value:"\n    dAL "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"np"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"divide"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"Y"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" AL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" np"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"divide"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" Y"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" AL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n    \n    "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:'# Lth layer (SIGMOID -> LINEAR) gradients. Inputs: "AL, Y, caches". Outputs: "grads["dAL"], grads["dWL"], grads["dbL"]'}]},{type:"text",value:"\n    current_cache "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" caches"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"text",value:"L"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\n    grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"dA"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"L"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"dW"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"L"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"db"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"L"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" linear_activation_backward"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"dAL"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" current_cache"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'sigmoid'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n\n    \n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"for"}]},{type:"text",value:" l "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"in"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"reversed"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"range"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"L"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# lth layer: (RELU -> LINEAR) gradients."}]},{type:"text",value:"\n        current_cache "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" caches"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"text",value:"l"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# l 是 cache 的索引，当前是第 (l+1) 层"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# 这里的下标有点容易弄错，注意传入的第一个参数是下一层的dA(按照前向传播的方向看)"}]},{type:"text",value:"\n        dA_prev_temp"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" dW_temp"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" db_temp "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" linear_activation_backward"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"dA"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"2"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" current_cache"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'relu'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n        grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"dA"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" dA_prev_temp\n        grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"dW"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" dW_temp\n        grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"db"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" db_temp\n\n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" grads"}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"返回的 grads 就是每一层的参数梯度"}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{},children:[{type:"text",value:"4. update parameter"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"python"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-python"]},children:[{type:"element",tagName:"code",properties:{className:["language-python"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"def"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"update_parameters"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" learning_rate"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","triple-quoted-string","string"]},children:[{type:"text",value:'"""\n    Update parameters using gradient descent\n    \n    Arguments:\n    parameters -- python dictionary containing your parameters \n    grads -- python dictionary containing your gradients, output of L_model_backward\n    \n    Returns:\n    parameters -- python dictionary containing your updated parameters \n                  parameters["W" + str(l)] = ... \n                  parameters["b" + str(l)] = ...\n    """'}]},{type:"text",value:"\n    \n    L "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"len"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"//"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"2"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# number of layers in the neural network"}]},{type:"text",value:"\n\n    "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# Update rule for each parameter"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"for"}]},{type:"text",value:" l "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"in"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"range"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"L"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:"\n        parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"W"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"W"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" learning_rate "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"*"}]},{type:"text",value:" grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"dW"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\n        parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"b"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" parameters"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"b"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" learning_rate "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"*"}]},{type:"text",value:" grads"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"db"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"str"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"l"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\n        \n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" parameters"}]}]},{type:"text",value:"\n      "}]}],data:{quirksMode:!1}},fields:{slug:"/a-primary-neural-network-framwork-by-python/",prefix:"2018-12-04"},frontmatter:{title:"a primary neural network framework by python",subTitle:"使用 Python 编写的一个初步的神经网络框架，包含后向传播",cover:{childImageSharp:{resize:{src:"/static/nn-cover-6ccbad2ba089eb26d198108e2aac6872-160fa.png"}}}}},author:{id:"F:/program/BlogSite/content/parts/author.md absPath of file >>> MarkdownRemark",html:"<p>我是一名数据工程师，对硬件有浓厚的兴趣。</p>"},footnote:{id:"F:/program/BlogSite/content/parts/footnote.md absPath of file >>> MarkdownRemark",html:'<ul>\n<li>this is a site built by <a href="https://www.gatsbyjs.org/">GatsbyJS</a>, ReactJs, CSS in JS</li>\n<li>delivered by <a href="https://pages.github.com/">Github Page</a></li>\n</ul>'},site:{siteMetadata:{facebook:{appId:""}}}},pathContext:{slug:"/a-primary-neural-network-framwork-by-python/"}}}});
//# sourceMappingURL=path---a-primary-neural-network-framwork-by-python-3b4ab4080106a93758b2.js.map