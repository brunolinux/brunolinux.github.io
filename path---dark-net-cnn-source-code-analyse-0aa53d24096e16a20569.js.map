{"version":3,"sources":["webpack:///path---dark-net-cnn-source-code-analyse-0aa53d24096e16a20569.js","webpack:///./.cache/json/dark-net-cnn-source-code-analyse.json"],"names":["webpackJsonp","794","module","exports","data","post","id","html","htmlAst","type","children","tagName","properties","value","href","className","style","target","rel","alt","title","src","srcSet","sizes","dataLanguage","quirksMode","fields","slug","prefix","frontmatter","subTitle","cover","childImageSharp","resize","author","footnote","site","siteMetadata","facebook","appId","pathContext"],"mappings":"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","file":"path---dark-net-cnn-source-code-analyse-0aa53d24096e16a20569.js","sourcesContent":["webpackJsonp([21380530516426],{\n\n/***/ 794:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"post\":{\"id\":\"F:/program/BlogSite/content/posts/2018-12-04--DarkNet-CNN-Source-Code-Analyse/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>在了解 全连接层反向传播的机理后，我在 Google 上找了一圈，都没有找到讲得很好的 CNN 反向传播的计算，本想通过研究 Pytorch 源码分析算法原理，发现 Pytorch 底层是调用 C 代码的，也就不了了之了。最近在学习 Darknet 源码时，终于搞懂了这部分的原理。</p>\\n<!--more-->\\n<h2>1. 前向传播</h2>\\n<p>这里要先说明一点，这个地方对应学过数字信号处理的同学来说，还是非常坑的。</p>\\n<p>数字信号处理中，实际的卷积操作如下: </p>\\n$$\\n(f*h)[m,n]=\\\\sum_{i=-\\\\infty}^\\\\infty\\\\sum_{j=-\\\\infty}^\\\\infty f[i,j]\\\\cdot h[m-i,n-j]\\n$$\\n<p>而深度学习的卷积操作如下: </p>\\n$$\\n(f*h)[m,n]=\\\\sum_{i=-\\\\infty}^\\\\infty\\\\sum_{j=-\\\\infty}^\\\\infty f[i,j]\\\\cdot h[i-m,j-n]\\n$$\\n<p>也就是说，深度学习中的卷积操作实际上是<strong>相关操作</strong> (correlation)</p>\\n<p>在数字信号处理中，一维卷积需要把信号序列 (一般是时间序列) 绕原点翻转，二维卷积则需要把信号序列 (一般是图像序列) 绕中心点旋转 $180^{\\\\circ}$ </p>\\n<blockquote>\\n<p>convolution is a filtering operation. correlation compared the similarity of two sets of data. Correlation is a measure of relatedness of two signals.</p>\\n</blockquote>\\n<p>但其实，在深度学习中，卷积和相关可以理解为是相同的。</p>\\n<p>因为我们学习的就是卷积核权重，即卷积核未知，每次反向传播都会自动更新使得误差最小。而传统的图像处理采用已知的卷积核，如果不做翻转处理，结果完全不一样。当然，卷积核绕中心 $180^{\\\\circ}$ 对称的话，两种处理结果也是相同的。</p>\\n<p>感兴趣的还可以看下 我的这篇博客 <a href=\\\"http://brunoliu.com/2018/06/14/thinking-of-2d-convolution/\\\">Thinking of 2D convolution</a></p>\\n<h3>1.1 输出尺寸</h3>\\n<p>大多数博客只提到 CNN 算法的前向传播原理。其实如果搞过传统图像处理的，应该都知道，卷积层的本质就是滤波，包括高通滤波用于边缘检测，低通滤波 (如高斯滤波器) 用于图片平滑。感兴趣的可以去找相关书籍看看。</p>\\n<p>前向传播一个稍微麻烦的地方是 如果根据 input height, input width, kernel size, padding, stride 计算输出 output height , output width </p>\\n<p>公式如下: </p>\\n$$\\n\\\\text {output height} = \\\\Big \\\\lfloor \\\\cfrac {\\\\text {input height} + 2 \\\\times \\\\text {padding} - \\\\text {kernel size}} {\\\\text {stride}} \\\\Big \\\\rfloor + 1 \\n$$\\n<p><code class=\\\"language-text\\\">output width</code> 计算是类似的。</p>\\n<p>参考论文: <a href=\\\"https://arxiv.org/abs/1603.07285\\\">A guide to convolution arithmetic for deep learning</a></p>\\n<p>对应的 GitHub repo: <a href=\\\"https://github.com/vdumoulin/conv_arithmetic\\\">conv_arithmetic</a></p>\\n<h3>1.2 卷积实现</h3>\\n<p>这一小节参考的博客: <a href=\\\"https://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/\\\">Why GEMM is at the heart of deep learning</a> </p>\\n<p>本博客着重讲的是第二点，如果实现二维卷积计算 ? </p>\\n<p>传统的数字信号处理中，对于两个长度相当的数据，我们通常用傅里叶变换间接求两个信号的卷积。</p>\\n<p>但由于深度学习中，常见的卷积核大小为 $3 \\\\times 3$, $5 \\\\times 5$ 等，采用傅里叶变换得不偿失，我们通常利用卷积定义直接计算。</p>\\n<p>由此引入本文的核心: <strong>GEMM</strong> — GEneral Matrix to Matrix Multiplication</p>\\n<p>它是 BLAS (Basic Linear Algebra Subprograms) library 的一部分。</p>\\n<p>GELL 听上去很高大上，是不是 ?</p>\\n<p>其实说白了就是 <strong>矩阵乘法</strong> 的计算实现。</p>\\n<p>矩阵乘法在深度学习中最直观的使用莫过于全连接层了，输入神经元和权重矩阵进行矩阵乘法，再和偏置矩阵相加，得到输出神经元的值。</p>\\n<p>言归正传，回到 CNN 实现</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 50.390625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAABYlAAAWJQFJUiTwAAABe0lEQVQoz22RTU/CQBBA+6P9C3pCo4mIATSBaKIhHjDh7MVgYvAgggItpYVd2tLS0g8srd0dh6KVRCYvk91m3u5sR+CcA4C7cEbykJLJUBKnhMBvxHEchuGm5n8IbUJl3ZwY1mhqqLopUx0hpo1rcSj3ez1RFPGI3fKVOj5WJle2V527lblbtT3MFWuB21N53DNmWPSVJCuMMFyzWkVRhO0wxoSapufsxQVAkfMi5l9KAPk4FoMlyp7vjwmdGuZIUVRVwSRJUhAEwi3VcpZ9yaAUs9IXzygnkF+uRD/YdGiOB7NBa/DR6XTfdU37aftH5rB2EsgoM8h/RpmsPl7LN3tK4/DlualOCKU0lafakeWgXE5vy7hgcLYlO2qbNva9h9zbS7Pd6TqOs5ZrhB6Yc3xkIeEFBhnnHE7CqJ/KLB3VSOq/tp4MQ8f1ZniCtQzqml53/frC2+be9e8smwRrGQs5Y93ue68/wJ/9NypIzwHGdrMVYfiJE9r+8g0dCCBSGZDZNwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"kernelview\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png\\\"\\n        srcset=\\\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-d8578.png 200w,\\n/static/kernelview-bd0283cc68eb34bae246e8d28931361b-a4478.png 400w,\\n/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png 768w\\\"\\n        sizes=\\\"(max-width: 768px) 100vw, 768px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>CNN 层输入数据尺寸为 batch_size $\\\\times$ depth (channel) $\\\\times$ input height $\\\\times$ input width，这是一个4维张量，在 Pytorch 中输入张量的顺序也是 batch $\\\\times$ depth $\\\\times$ height $\\\\times$ width </p>\\n<p>如果考虑对 batch 循环处理，那么每次的输入数据尺寸为 depth(channel) $\\\\times$ input height $\\\\times$ input width </p>\\n<p>卷积核的大小则为  output depth $\\\\times$ depth $\\\\times$ kernel size $\\\\times$ kernel size </p>\\n<p>注: 这里和别的博客说法不同，一般都将单个卷积核视为二维的，但其实想一下，考虑沿着深度方向 (每个输入通道) 都存在相应的不同卷积核，最后叠加。那么我们直接将沿着深度方向的所有卷积核视为一个卷积核，进行 3 维的相乘累加操作，不是更方便吗 ? </p>\\n<p>下图展示了输入数据尺寸为 $1 \\\\times 2 \\\\times 5 \\\\times 5$ (batch:1, depth:2, height: 5, width: 5)，卷积核尺寸为 $3 \\\\times 2 \\\\times 3 \\\\times 3$ (output depth: 3, input depth: 2, kernel size: 3 )，输出数据尺寸为 $1 \\\\times 3 \\\\times 3 \\\\times 3$ </p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 468px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsSAAALEgHS3X78AAAC/ElEQVQ4y41UyWsTURzOQaSCC3gRERRBkHrViyf/AM+epAcpokIREbFbWu0iQkUsaEvrXiJq06Y1LdbUtKmmi91NKralS+qSNrFJJpNZ38ybN/HNvGQyTYL1HYaZ3/y+3/p9z5LMd1RVxU+K5Z6Pf3k44g0nEobRfCx5wUj3szrf7au17qmzjq4F8KeC0PZgjEPaI1lkayuoKj1x7+5yOGxE3D4z8erz+251OT76/Xlrzgar+sEvsizH43FFkvhEQhIEOpFQFOVfYAJDCDEMQ9M08aZoGlcLIcSxOI4jPkYVFnOdvCBgJwCAETGOwek5Caa/6pbMqsonGI5ls3rjGMZswQNnGUZg2EzmTYa96Gi/4mgP0zSpigx25vfP829ttW6XAqEx7flQqOiNrfxDrwCABl6NRApqKvbfqV7c2CBOZKWOOZ+l4vqppgcykPAn1I3uhQVL1c3jjQ00x2lgRhSbR7wtI16aF8wzD0Qj9z0D9q+zpG2SORinGj95Xk1PSRCmepYlCQhC7jLE9ITNB/C8qodLgYEsi5KUSxXcmLx1wykjVDJgzAoAxNzMAk6SkxnvDBmZcTPhaDwUodBW6ssQBv9EqPRiyIFIWd+MRmlthRp4YGKlsNp1usETCMdJLKQna+r1HbX2n2sdhbKkL1mz2tzfjlldZx8Ns7yggR93TO4o7jxS1rcSonSGplh4tXHQUtx9psEDZWCAbz/1Wi50nawfZAjYNx+sezbU5vKRTaY3lXSPLdW/+Px+fDmlU906PB2oeeLpGVtSk2qa27qCVFPPBM8yWBhINRl5jlEgyNATpWUYi8WgzkRjwjyb4TZ+wcIQBDHVWpaesQwpihJF7TcrAOfsj86J1Y6pNf+vqCZPipJ0LmRL0qzqWAyPDbrHlndfth8oc+0s6bn2ehKJrAikrCslzzWkaPIH3e65wzechXWeg+X9lV2zmv1/7jAiKefA972X7IdK+3eV9JTaZ4xVbQNGupN/PljZ4ql9OVzROjSxuJ739vwLqYZktpd71IcAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"conv sum\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png\\\"\\n        srcset=\\\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-96318.png 200w,\\n/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-dc6d3.png 400w,\\n/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png 468w\\\"\\n        sizes=\\\"(max-width: 468px) 100vw, 468px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>每次卷积核的运算： 相乘并累加</p>\\n<p>矩阵乘法 $C = AB$ 的单次运算: $A$ 的行向量与 $B$ 的列向量相乘并累加</p>\\n<p>不知道你有没有看出来两者的联系 ？</p>\\n<p>是的，基本操作都是相乘并累加。</p>\\n<p>所有，有的人就想到了，将卷积层的计算也用矩阵乘法实现: </p>\\n<p>$A$ 的每一行大小为 depth $\\\\times$ kernel size $\\\\times$ kernel size ，$B$ 的每一列也是相同大小，矩阵相乘的基本运算对应的就是单次卷积核相乘累加操作。</p>\\n<p>也就是说，我们需要将 CNN 层的输入数据重新排列，根据它可以组成矩阵 $A$ 的每一行 — 矩阵 $A$ 每一行的数据就是按步长移动卷积核后，其对应位置上的原始输入数据。</p>\\n<p>如下图所示，将 4维的输入张量数据转为 2维矩阵 $A$ ，通常称为 im2col, 表示 image-to-column</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 45.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAABYlAAAWJQFJUiTwAAABw0lEQVQoz32R7W+aUBSH+f//g2ZxWdXWIo3V+lIVRAQBqYJcBygvwzl1vgJeFY2J6K5tto+7eT7cnOQ55/xysOv1Gl1uTKa/LduZTGf9gQm3O1S/XC7X/z7M0tpzSxmaPRc07e+SKTf6Cq+rrYUlb5bTfzpqdD5HiOiD2ye6YIpYFIp3ndKdyqY65RigYsNu3uSSuoA779kdDD7loW82Vi/N5WveSNKTDO+/tscMJrWqGnMP2AeFS+uNuEIn3E5G5fC+iP/oFjZ/5cFafYNfqV0yP/9S9r+RYZwZ57CuVNZFYii/ACk7Anmt+Wj3ygMxrbdzTq+yWMzCQ3g+RZbfI7cJZo8zIV7fP9FhipsWMaFV6XMJU3qWm8SoTaiNpCtnAJ82ePwnKNmOafSNbbBzAo3cJW5m+ITk+uFDVoUCmuNKhCYQv5SczsRdtTRopkwp44CKH3iH4wGtbXm9SnBPw1QNPiKo7QM7zmN1XeakrDGgKY21jSoLSN2gJJ0WtZpjkHDjf2Y2PfAGYygzmo/2r+5R5iwGT6fabE56PhlAarkmfVhbrigvIL2gPp/vj0d0JiSPfJtb5MRVSVgVEfy60JmwfwBsmcWHVL5fVAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"im2col corrected\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png\\\"\\n        srcset=\\\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-d8578.png 200w,\\n/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-a4478.png 400w,\\n/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png 768w\\\"\\n        sizes=\\\"(max-width: 768px) 100vw, 768px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>有的人可能会说，在步长 stride 比较小，kernel 比较大的情况下，上图中不同 patch 之间必然会相互覆盖 (overlap)，也就是说生成的 2 维矩阵 $A$ 会有大量的重复数据，生成这样的矩阵既浪费内存，又浪费时间，效率会高吗 ? </p>\\n<p>但是，请相信，和后面的矩阵乘法的高效比起来，这一步浪费的时间是有价值的。</p>\\n<blockquote>\\n<p>The benefits from the very regular patterns of memory access outweigh the wasteful storage costs. The paper from Nvidia <a href=\\\"https://arxiv.org/pdf/1410.0759.pdf\\\">cuDNN: efficient primitives for Deep Learning</a> describe why they ended up with a modified version of GEMM. There are a lot of advantages to being able to batch up a lot of input images against the same kernels at once.</p>\\n</blockquote>\\n<p>根据前面的分析：</p>\\n<ol>\\n<li>$A$ 的行数为 patch 的数目，即  <code class=\\\"language-text\\\">batch size * output height * output width</code> </li>\\n<li>$B$ 的列数为卷积核的数目，即 <code class=\\\"language-text\\\">output depth</code> </li>\\n</ol>\\n<p>于是输出的 2 维矩阵大小为:  <code class=\\\"language-text\\\">batch size * output height * output width</code>  $\\\\times$ <code class=\\\"language-text\\\">output depth</code> ，在下一层看来，它又是一个新的 4 维矩阵。</p>\\n<p>如下图所示: </p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 60.15625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABYlAAAWJQFJUiTwAAACCUlEQVQoz22S22+aYBjG/W93vUO6NLV4tWQX7Xax6yVdFXWXS5atii5OBZzNUgWiKKVomBxETh/HgsI+dHTLtjdPngsefnl4yVtI0xQAwLKsIAgURdE0bVsWfJgkSbofx3FEUZQkCfpyuZAlOY7jQ1TILEld4AZeaOqW5/rbeJv+MUEQKIqiqqqmaaL4A3qcv1BwXDBdMKImzMXpaPZ9ueYFhWO4ked5MI6iCPYkv2aXfdBuF0X3223GFxR99Xl9gVnlCv26zr7BzDIGyh+Et6qqwFiYDOTeS5U43wxeqfiZRp4r/TOt/0LjuhmsmjJmoG2nillo0yy3QbXtoE2lyvO38S5dzYiIPArI43hY9AnoJz5xEhFP9dlVcoC/2LWOX+94ufxaa11nGNpxw8UElxqPPRK5H5Zc4nTvpZB4rs+bGbw25aZeaQG0ZedyKldShePmsPkG/0i/f+TixT0GHXEJJCSO9HljD1vK380BbK7NZizcajnpq9gTL+tE/gNrloLpaLaqnQugmFyjqDGEZe5bSB775Gl0jfhkMRoi2QpkDsOdG9Y7zLvE3Fz+5Sf54u6OPzRbX48cAvEHJdAvBtBxxOk+09hG9reBZ9+o/ZHWe9B407sWO4ZpwHglLngGn4+7PEPcMjhH9XiGXE4Ha2mRX9juHyW/Lwzew8awDBM4XqgbtmmBh/AnHxBnXDuuy+IAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"im2colmult corrected1\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png\\\"\\n        srcset=\\\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-d8578.png 200w,\\n/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-a4478.png 400w,\\n/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png 768w\\\"\\n        sizes=\\\"(max-width: 768px) 100vw, 768px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<h3>1.3 利用 numpy 验证</h3>\\n<p>我们通过 numpy 验证两种方式计算卷积，哪一种更高效。</p>\\n<p>背景: </p>\\n<ul>\\n<li>\\n<p>一张灰度图片，大小为 $332 \\\\times 300$, batch_size = 1， input depth = 1，因此输入数据是二维矩阵； </p>\\n<p>通过 python skimage 库读取图片</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">from</span> skimage <span class=\\\"token keyword\\\">import</span> io \\nio<span class=\\\"token punctuation\\\">.</span>imread<span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'dog.jpg'</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n</li>\\n</ul>\\n<p>  \\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 332px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 90.36144578313254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAASABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAME/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABtZExLDTnCIP/xAAaEAACAwEBAAAAAAAAAAAAAAABAwACERIx/9oACAEBAAEFAlrrhCDGL5vgCqW6tux0X7P/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAcEAACAgIDAAAAAAAAAAAAAAABEQAQAhIhMZH/2gAIAQEABj8CeXkShHcZmqGgHFC//8QAGhABAAMBAQEAAAAAAAAAAAAAAQARMSGxQf/aAAgBAQABPyFxXWqQzC8RlAND7GqOrdR3Q8mujEJWeRPFhk//2gAMAwEAAgADAAAAEMPHAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB4QAQACAgEFAAAAAAAAAAAAAAEAESExUYGR0eHw/9oACAEBAAE/EECoAWne1hcW8ha3V7gE7MAr5gDUxcHmXmbiQRnvGqbW40ALRUdI0dL6GKxP/9k='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"dog\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg\\\"\\n        srcset=\\\"/static/dog-085939e2d2f627a80f7608283c0b7574-fbbac.jpg 200w,\\n/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg 332w\\\"\\n        sizes=\\\"(max-width: 332px) 100vw, 332px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<ul>\\n<li>\\n<p>卷积核大小为 $3 \\\\times 3$ ，ouput depth = 1，padding = 1，stride = 1</p>\\n<p>note: 其实这个卷积核是边缘检测算子</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">import</span> numpy <span class=\\\"token keyword\\\">as</span> np\\nkernel <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>array<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">[</span>\\n  <span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n  <span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n  <span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span>\\n<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n</li>\\n<li>\\n<p>输出为二维矩阵，不考虑 depth 和 batch size，大小和输入数据相同</p>\\n</li>\\n</ul>\\n<p>首先我们实现 <code class=\\\"language-text\\\">zero_pad</code> 函数实现 边缘补 0</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">def</span> <span class=\\\"token function\\\">zero_pad</span><span class=\\\"token punctuation\\\">(</span>image<span class=\\\"token punctuation\\\">,</span> pad_height<span class=\\\"token punctuation\\\">,</span> pad_width<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n    <span class=\\\"token triple-quoted-string string\\\">\\\"\\\"\\\" Zero-pad an image.\\n    Args:\\n        image: numpy array of shape (H, W)\\n        pad_width: width of the zero padding (left and right padding)\\n        pad_height: height of the zero padding (bottom and top padding)\\n    Returns:\\n        out: numpy array of shape (H+2*pad_height, W+2*pad_width)\\n    \\\"\\\"\\\"</span>\\n    H<span class=\\\"token punctuation\\\">,</span> W <span class=\\\"token operator\\\">=</span> image<span class=\\\"token punctuation\\\">.</span>shape\\n    out <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">None</span>\\n\\n    out <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>zeros<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">[</span>H<span class=\\\"token operator\\\">+</span><span class=\\\"token number\\\">2</span><span class=\\\"token operator\\\">*</span>pad_height<span class=\\\"token punctuation\\\">,</span> W<span class=\\\"token operator\\\">+</span><span class=\\\"token number\\\">2</span><span class=\\\"token operator\\\">*</span>pad_width<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span>\\n    out<span class=\\\"token punctuation\\\">[</span>pad_height<span class=\\\"token punctuation\\\">:</span>pad_height<span class=\\\"token operator\\\">+</span>H<span class=\\\"token punctuation\\\">,</span> pad_width<span class=\\\"token punctuation\\\">:</span>pad_width<span class=\\\"token operator\\\">+</span>W<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> image<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">]</span>\\n    <span class=\\\"token keyword\\\">return</span> out</code></pre>\\n      </div>\\n<p><strong>方法一:</strong> 通过 卷积定义计算，我们需要使用两个 for 循环</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">def</span> <span class=\\\"token function\\\">conv_fast</span><span class=\\\"token punctuation\\\">(</span>image<span class=\\\"token punctuation\\\">,</span> kernel<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n    <span class=\\\"token triple-quoted-string string\\\">\\\"\\\"\\\" An efficient implementation of convolution filter.\\n    Args:\\n        image: numpy array of shape (Hi, Wi)\\n        kernel: numpy array of shape (Hk, Wk)\\n\\n    Returns:\\n        out: numpy array of shape (Hi, Wi)\\n    \\\"\\\"\\\"</span>\\n    Hi<span class=\\\"token punctuation\\\">,</span> Wi <span class=\\\"token operator\\\">=</span> image<span class=\\\"token punctuation\\\">.</span>shape\\n    Hk<span class=\\\"token punctuation\\\">,</span> Wk <span class=\\\"token operator\\\">=</span> kernel<span class=\\\"token punctuation\\\">.</span>shape\\n    out <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>zeros<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>Hi<span class=\\\"token punctuation\\\">,</span> Wi<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\n    pad_height <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>Hk<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">//</span><span class=\\\"token number\\\">2</span>\\n    pad_width <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>Wk<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">//</span><span class=\\\"token number\\\">2</span>\\n    \\n    image_padding <span class=\\\"token operator\\\">=</span> zero_pad<span class=\\\"token punctuation\\\">(</span>image<span class=\\\"token punctuation\\\">,</span> pad_height<span class=\\\"token punctuation\\\">,</span> pad_width<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token comment\\\"># 两个 for 循环，按 步长为 1 逐点计算</span>\\n    <span class=\\\"token keyword\\\">for</span> hi <span class=\\\"token keyword\\\">in</span> <span class=\\\"token builtin\\\">range</span><span class=\\\"token punctuation\\\">(</span>Hi<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n        <span class=\\\"token keyword\\\">for</span> wi <span class=\\\"token keyword\\\">in</span> <span class=\\\"token builtin\\\">range</span><span class=\\\"token punctuation\\\">(</span>Wi<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n            out<span class=\\\"token punctuation\\\">[</span>hi<span class=\\\"token punctuation\\\">,</span> wi<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span><span class=\\\"token builtin\\\">sum</span><span class=\\\"token punctuation\\\">(</span>image_padding<span class=\\\"token punctuation\\\">[</span>hi<span class=\\\"token punctuation\\\">:</span>hi<span class=\\\"token operator\\\">+</span>Hk<span class=\\\"token punctuation\\\">,</span> wi<span class=\\\"token punctuation\\\">:</span>wi<span class=\\\"token operator\\\">+</span>Wk<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">*</span> kernel<span class=\\\"token punctuation\\\">)</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> out</code></pre>\\n      </div>\\n<p><strong>方法二:</strong> GEMM，矩阵相乘计算</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">def</span> <span class=\\\"token function\\\">conv_faster</span><span class=\\\"token punctuation\\\">(</span>image<span class=\\\"token punctuation\\\">,</span> kernel<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n    <span class=\\\"token triple-quoted-string string\\\">\\\"\\\"\\\"\\n    Args:\\n        image: numpy array of shape (Hi, Wi)\\n        kernel: numpy array of shape (Hk, Wk)\\n\\n    Returns:\\n        out: numpy array of shape (Hi, Wi)\\n    \\\"\\\"\\\"</span>\\n    Hi<span class=\\\"token punctuation\\\">,</span> Wi <span class=\\\"token operator\\\">=</span> image<span class=\\\"token punctuation\\\">.</span>shape\\n    Hk<span class=\\\"token punctuation\\\">,</span> Wk <span class=\\\"token operator\\\">=</span> kernel<span class=\\\"token punctuation\\\">.</span>shape\\n    out <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>zeros<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>Hi<span class=\\\"token punctuation\\\">,</span> Wi<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\n    pad_height <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>Hk<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">//</span><span class=\\\"token number\\\">2</span>\\n    pad_width <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>Wk<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">//</span><span class=\\\"token number\\\">2</span>\\n    \\n    image_padding <span class=\\\"token operator\\\">=</span> zero_pad<span class=\\\"token punctuation\\\">(</span>image<span class=\\\"token punctuation\\\">,</span> pad_height<span class=\\\"token punctuation\\\">,</span> pad_width<span class=\\\"token punctuation\\\">)</span>\\n    \\n    gemm_input <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>zeros<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>Hi<span class=\\\"token operator\\\">*</span>Wi<span class=\\\"token punctuation\\\">,</span> Hk<span class=\\\"token operator\\\">*</span>Wk<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token comment\\\"># 输入数据重排，得到我们需要的矩阵</span>\\n    <span class=\\\"token keyword\\\">for</span> hi <span class=\\\"token keyword\\\">in</span> <span class=\\\"token builtin\\\">range</span><span class=\\\"token punctuation\\\">(</span>Hi<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n        <span class=\\\"token keyword\\\">for</span> wi <span class=\\\"token keyword\\\">in</span> <span class=\\\"token builtin\\\">range</span><span class=\\\"token punctuation\\\">(</span>Wi<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n            gemm_input<span class=\\\"token punctuation\\\">[</span>hi<span class=\\\"token operator\\\">*</span>Wi<span class=\\\"token operator\\\">+</span>wi<span class=\\\"token punctuation\\\">,</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> image_padding<span class=\\\"token punctuation\\\">[</span>hi<span class=\\\"token punctuation\\\">:</span>hi<span class=\\\"token operator\\\">+</span>Hk<span class=\\\"token punctuation\\\">,</span> wi<span class=\\\"token punctuation\\\">:</span>wi<span class=\\\"token operator\\\">+</span>Wk<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">.</span>reshape<span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span>\\n            \\n    <span class=\\\"token comment\\\"># 一次矩阵乘法计算，直接得到结果</span>\\n    <span class=\\\"token comment\\\"># out shape: (Hi*Wi, 1)</span>\\n    out <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>matmul<span class=\\\"token punctuation\\\">(</span>gemm_input<span class=\\\"token punctuation\\\">,</span> kernel<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token comment\\\"># 整理矩阵形状, out shape: (Hi, Wi)</span>\\n    out <span class=\\\"token operator\\\">=</span> out<span class=\\\"token punctuation\\\">.</span>reshape<span class=\\\"token punctuation\\\">(</span>Hi<span class=\\\"token punctuation\\\">,</span> Wi<span class=\\\"token punctuation\\\">)</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> out</code></pre>\\n      </div>\\n<p>最终结果: </p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">import</span> matplotlib<span class=\\\"token punctuation\\\">.</span>pyplot <span class=\\\"token keyword\\\">as</span> plt\\n\\nt0 <span class=\\\"token operator\\\">=</span> time<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\nout_fast <span class=\\\"token operator\\\">=</span> conv_fast<span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token punctuation\\\">,</span> kernel<span class=\\\"token punctuation\\\">)</span>\\nt1 <span class=\\\"token operator\\\">=</span> time<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\nout_faster <span class=\\\"token operator\\\">=</span> conv_faster<span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token punctuation\\\">,</span> kernel<span class=\\\"token punctuation\\\">)</span>\\nt2 <span class=\\\"token operator\\\">=</span> time<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token comment\\\"># Compare the running time of the two implementations</span>\\n<span class=\\\"token keyword\\\">print</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"conv_fast: took %f seconds.\\\"</span> <span class=\\\"token operator\\\">%</span> <span class=\\\"token punctuation\\\">(</span>t1 <span class=\\\"token operator\\\">-</span> t0<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token keyword\\\">print</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"conv_faster: took %f seconds.\\\"</span> <span class=\\\"token operator\\\">%</span> <span class=\\\"token punctuation\\\">(</span>t2 <span class=\\\"token operator\\\">-</span> t1<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token comment\\\"># Plot conv_nested output</span>\\nplt<span class=\\\"token punctuation\\\">.</span>subplot<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span>\\nplt<span class=\\\"token punctuation\\\">.</span>imshow<span class=\\\"token punctuation\\\">(</span>out_fast<span class=\\\"token punctuation\\\">)</span>\\nplt<span class=\\\"token punctuation\\\">.</span>title<span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'conv_fast'</span><span class=\\\"token punctuation\\\">)</span>\\nplt<span class=\\\"token punctuation\\\">.</span>axis<span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'off'</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token comment\\\"># Plot conv_fast output</span>\\nplt<span class=\\\"token punctuation\\\">.</span>subplot<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span>\\nplt<span class=\\\"token punctuation\\\">.</span>imshow<span class=\\\"token punctuation\\\">(</span>out_faster<span class=\\\"token punctuation\\\">)</span>\\nplt<span class=\\\"token punctuation\\\">.</span>title<span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'conv_faster'</span><span class=\\\"token punctuation\\\">)</span>\\nplt<span class=\\\"token punctuation\\\">.</span>axis<span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'off'</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token comment\\\"># Make sure that the two outputs are the same</span>\\n<span class=\\\"token keyword\\\">if</span> <span class=\\\"token operator\\\">not</span> <span class=\\\"token punctuation\\\">(</span>np<span class=\\\"token punctuation\\\">.</span><span class=\\\"token builtin\\\">max</span><span class=\\\"token punctuation\\\">(</span>out_fast <span class=\\\"token operator\\\">-</span> out_faster<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">1e</span><span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">10</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n    <span class=\\\"token keyword\\\">print</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Different outputs! Check your implementation.\\\"</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>结果如下: </p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"text\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">conv_fast: took 0.563950 seconds.\\nconv_faster: took 0.221714 seconds.</code></pre>\\n      </div>\\n<p>使用 GEMM 算法快了 50%，是不是很有效 !</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 601px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 45.92346089850249%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABo0lEQVQoz2WRy0pCURiFTw3sRZpHo2iWECJC0ShEhx0RIUG83+8gZYg48Al8hJAigiY9gYNAGvcK4fFc+tZBS0jY7L3X/s761/9rTCaTvXq9floul88rlUowmUxexOPxaDqdjqCfoYfz+fyhwY/7MUwILZhIJC5jsVjUNM2rDRcqFApHxnQ6DSB8NhoNr1qtepz9HcArFotOt9v1AB82hq+tVkvvbq1W2+XcZrOp/ckgYQCz5QZ0SOAC+atUKlkqlMvlhjLk/KICcDaGvxzLljnc3BiNRgHMlqqgB0zcrSmJLBXKZDL3MoTxDWHWO2bi1uoMbm7MZjM/oZIAOmpBZ+bmkcLqdDpeNpsdbg1VgIIq7CkE4xBny9BPKEMelpsZOJoPDy4futz/GeqOvlbL4tDU0Z/heDwOtNvtDwlUs9Q2H9hoSvGtRIB3MsTsGV3pV1uOd5vzSn8S+qMSHjCXL4EyVVKde72eWvEGg4HAiQzR3vv9vq/vchqRdrg3Y7FY7PNwTboklUzim9oxN0l4w7oFPJEhhSOkSkkXpyUOXlwKj/APlHJ3/u12OaIAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"conv output\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png\\\"\\n        srcset=\\\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-ae8c5.png 200w,\\n/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-d70b4.png 400w,\\n/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png 601w\\\"\\n        sizes=\\\"(max-width: 601px) 100vw, 601px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<h3>1.4 Darknet 实现</h3>\\n<p>在 <code class=\\\"language-text\\\">convolutional_layer.c</code> 中，实现了 <code class=\\\"language-text\\\">forward_convolutional_layer</code> 函数，里面主要使用了两个函数: </p>\\n<ol>\\n<li><code class=\\\"language-text\\\">im2col_cpu</code> : 实现重排，考虑 padding, stride, kernel size 等参数</li>\\n<li><code class=\\\"language-text\\\">gemm</code> : 实现矩阵乘法 $C = \\\\alpha * AB + \\\\beta * C$</li>\\n</ol>\\n<p>注意: <code class=\\\"language-text\\\">gemm</code> 支持 A, B 转置，因此具体实现有 4 个对应的函数</p>\\n<p>这两个函数分别在 <code class=\\\"language-text\\\">im2col.c</code> 和 <code class=\\\"language-text\\\">gemm.c</code> 实现</p>\\n<h2>2. 反向传播</h2>\\n<p>说白了，我们要获得 3 个值，该层的 <code class=\\\"language-text\\\">weight_updates</code>  和 <code class=\\\"language-text\\\">bias_updates</code> ，以及更新前一层的 <code class=\\\"language-text\\\">delta</code> </p>\\n<p>如果从 GEMM 的角度考虑，得到 <code class=\\\"language-text\\\">weight_updates</code> 和 <code class=\\\"language-text\\\">bias_updates</code> 就很容易，因为它就是矩阵相乘的偏导，我们只要把前一层的 <code class=\\\"language-text\\\">ouput</code> 重排一下重新得到上面的矩阵 $A$ ，然后和全连接层类似。</p>\\n<p>至于 前一层的 <code class=\\\"language-text\\\">delta</code> ，我们在计算矩阵偏导后，还需要多一步，逆重排，在 Darknet 中通过 <code class=\\\"language-text\\\">col2im_cpu</code> 实现，注意这一步基本是叠加元素叠加实现的。感觉具体细节比较麻烦，主要是如何寻找索引，详细请看 <code class=\\\"language-text\\\">col2im_cpu.c</code> 文件</p>\",\"htmlAst\":{\"type\":\"root\",\"children\":[{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"在了解 全连接层反向传播的机理后，我在 Google 上找了一圈，都没有找到讲得很好的 CNN 反向传播的计算，本想通过研究 Pytorch 源码分析算法原理，发现 Pytorch 底层是调用 C 代码的，也就不了了之了。最近在学习 Darknet 源码时，终于搞懂了这部分的原理。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"comment\",\"value\":\"more\"},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1. 前向传播\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"这里要先说明一点，这个地方对应学过数字信号处理的同学来说，还是非常坑的。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"数字信号处理中，实际的卷积操作如下: \"}]},{\"type\":\"text\",\"value\":\"\\n$$\\n(f*h)[m,n]=\\\\sum_{i=-\\\\infty}^\\\\infty\\\\sum_{j=-\\\\infty}^\\\\infty f[i,j]\\\\cdot h[m-i,n-j]\\n$$\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"而深度学习的卷积操作如下: \"}]},{\"type\":\"text\",\"value\":\"\\n$$\\n(f*h)[m,n]=\\\\sum_{i=-\\\\infty}^\\\\infty\\\\sum_{j=-\\\\infty}^\\\\infty f[i,j]\\\\cdot h[i-m,j-n]\\n$$\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"也就是说，深度学习中的卷积操作实际上是\"},{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"相关操作\"}]},{\"type\":\"text\",\"value\":\" (correlation)\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"在数字信号处理中，一维卷积需要把信号序列 (一般是时间序列) 绕原点翻转，二维卷积则需要把信号序列 (一般是图像序列) 绕中心点旋转 $180^{\\\\circ}$ \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"blockquote\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"convolution is a filtering operation. correlation compared the similarity of two sets of data. Correlation is a measure of relatedness of two signals.\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"但其实，在深度学习中，卷积和相关可以理解为是相同的。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"因为我们学习的就是卷积核权重，即卷积核未知，每次反向传播都会自动更新使得误差最小。而传统的图像处理采用已知的卷积核，如果不做翻转处理，结果完全不一样。当然，卷积核绕中心 $180^{\\\\circ}$ 对称的话，两种处理结果也是相同的。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"感兴趣的还可以看下 我的这篇博客 \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"http://brunoliu.com/2018/06/14/thinking-of-2d-convolution/\"},\"children\":[{\"type\":\"text\",\"value\":\"Thinking of 2D convolution\"}]}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1.1 输出尺寸\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"大多数博客只提到 CNN 算法的前向传播原理。其实如果搞过传统图像处理的，应该都知道，卷积层的本质就是滤波，包括高通滤波用于边缘检测，低通滤波 (如高斯滤波器) 用于图片平滑。感兴趣的可以去找相关书籍看看。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"前向传播一个稍微麻烦的地方是 如果根据 input height, input width, kernel size, padding, stride 计算输出 output height , output width \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"公式如下: \"}]},{\"type\":\"text\",\"value\":\"\\n$$\\n\\\\text {output height} = \\\\Big \\\\lfloor \\\\cfrac {\\\\text {input height} + 2 \\\\times \\\\text {padding} - \\\\text {kernel size}} {\\\\text {stride}} \\\\Big \\\\rfloor + 1 \\n$$\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"output width\"}]},{\"type\":\"text\",\"value\":\" 计算是类似的。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"参考论文: \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://arxiv.org/abs/1603.07285\"},\"children\":[{\"type\":\"text\",\"value\":\"A guide to convolution arithmetic for deep learning\"}]}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"对应的 GitHub repo: \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/vdumoulin/conv_arithmetic\"},\"children\":[{\"type\":\"text\",\"value\":\"conv_arithmetic\"}]}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1.2 卷积实现\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"这一小节参考的博客: \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/\"},\"children\":[{\"type\":\"text\",\"value\":\"Why GEMM is at the heart of deep learning\"}]},{\"type\":\"text\",\"value\":\" \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"本博客着重讲的是第二点，如果实现二维卷积计算 ? \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"传统的数字信号处理中，对于两个长度相当的数据，我们通常用傅里叶变换间接求两个信号的卷积。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"但由于深度学习中，常见的卷积核大小为 $3 \\\\times 3$, $5 \\\\times 5$ 等，采用傅里叶变换得不偿失，我们通常利用卷积定义直接计算。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"由此引入本文的核心: \"},{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"GEMM\"}]},{\"type\":\"text\",\"value\":\" — GEneral Matrix to Matrix Multiplication\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"它是 BLAS (Basic Linear Algebra Subprograms) library 的一部分。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"GELL 听上去很高大上，是不是 ?\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"其实说白了就是 \"},{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"矩阵乘法\"}]},{\"type\":\"text\",\"value\":\" 的计算实现。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"矩阵乘法在深度学习中最直观的使用莫过于全连接层了，输入神经元和权重矩阵进行矩阵乘法，再和偏置矩阵相加，得到输出神经元的值。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"言归正传，回到 CNN 实现\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 50.390625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAABYlAAAWJQFJUiTwAAABe0lEQVQoz22RTU/CQBBA+6P9C3pCo4mIATSBaKIhHjDh7MVgYvAgggItpYVd2tLS0g8srd0dh6KVRCYvk91m3u5sR+CcA4C7cEbykJLJUBKnhMBvxHEchuGm5n8IbUJl3ZwY1mhqqLopUx0hpo1rcSj3ez1RFPGI3fKVOj5WJle2V527lblbtT3MFWuB21N53DNmWPSVJCuMMFyzWkVRhO0wxoSapufsxQVAkfMi5l9KAPk4FoMlyp7vjwmdGuZIUVRVwSRJUhAEwi3VcpZ9yaAUs9IXzygnkF+uRD/YdGiOB7NBa/DR6XTfdU37aftH5rB2EsgoM8h/RpmsPl7LN3tK4/DlualOCKU0lafakeWgXE5vy7hgcLYlO2qbNva9h9zbS7Pd6TqOs5ZrhB6Yc3xkIeEFBhnnHE7CqJ/KLB3VSOq/tp4MQ8f1ZniCtQzqml53/frC2+be9e8smwRrGQs5Y93ue68/wJ/9NypIzwHGdrMVYfiJE9r+8g0dCCBSGZDZNwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"kernelview\",\"title\":\"\",\"src\":\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png\",\"srcSet\":[\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-d8578.png 200w\",\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-a4478.png 400w\",\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png 768w\"],\"sizes\":[\"(max-width:\",\"768px)\",\"100vw,\",\"768px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"CNN 层输入数据尺寸为 batch_size $\\\\times$ depth (channel) $\\\\times$ input height $\\\\times$ input width，这是一个4维张量，在 Pytorch 中输入张量的顺序也是 batch $\\\\times$ depth $\\\\times$ height $\\\\times$ width \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"如果考虑对 batch 循环处理，那么每次的输入数据尺寸为 depth(channel) $\\\\times$ input height $\\\\times$ input width \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"卷积核的大小则为  output depth $\\\\times$ depth $\\\\times$ kernel size $\\\\times$ kernel size \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"注: 这里和别的博客说法不同，一般都将单个卷积核视为二维的，但其实想一下，考虑沿着深度方向 (每个输入通道) 都存在相应的不同卷积核，最后叠加。那么我们直接将沿着深度方向的所有卷积核视为一个卷积核，进行 3 维的相乘累加操作，不是更方便吗 ? \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"下图展示了输入数据尺寸为 $1 \\\\times 2 \\\\times 5 \\\\times 5$ (batch:1, depth:2, height: 5, width: 5)，卷积核尺寸为 $3 \\\\times 2 \\\\times 3 \\\\times 3$ (output depth: 3, input depth: 2, kernel size: 3 )，输出数据尺寸为 $1 \\\\times 3 \\\\times 3 \\\\times 3$ \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 468px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsSAAALEgHS3X78AAAC/ElEQVQ4y41UyWsTURzOQaSCC3gRERRBkHrViyf/AM+epAcpokIREbFbWu0iQkUsaEvrXiJq06Y1LdbUtKmmi91NKralS+qSNrFJJpNZ38ybN/HNvGQyTYL1HYaZ3/y+3/p9z5LMd1RVxU+K5Z6Pf3k44g0nEobRfCx5wUj3szrf7au17qmzjq4F8KeC0PZgjEPaI1lkayuoKj1x7+5yOGxE3D4z8erz+251OT76/Xlrzgar+sEvsizH43FFkvhEQhIEOpFQFOVfYAJDCDEMQ9M08aZoGlcLIcSxOI4jPkYVFnOdvCBgJwCAETGOwek5Caa/6pbMqsonGI5ls3rjGMZswQNnGUZg2EzmTYa96Gi/4mgP0zSpigx25vfP829ttW6XAqEx7flQqOiNrfxDrwCABl6NRApqKvbfqV7c2CBOZKWOOZ+l4vqppgcykPAn1I3uhQVL1c3jjQ00x2lgRhSbR7wtI16aF8wzD0Qj9z0D9q+zpG2SORinGj95Xk1PSRCmepYlCQhC7jLE9ITNB/C8qodLgYEsi5KUSxXcmLx1wykjVDJgzAoAxNzMAk6SkxnvDBmZcTPhaDwUodBW6ssQBv9EqPRiyIFIWd+MRmlthRp4YGKlsNp1usETCMdJLKQna+r1HbX2n2sdhbKkL1mz2tzfjlldZx8Ns7yggR93TO4o7jxS1rcSonSGplh4tXHQUtx9psEDZWCAbz/1Wi50nawfZAjYNx+sezbU5vKRTaY3lXSPLdW/+Px+fDmlU906PB2oeeLpGVtSk2qa27qCVFPPBM8yWBhINRl5jlEgyNATpWUYi8WgzkRjwjyb4TZ+wcIQBDHVWpaesQwpihJF7TcrAOfsj86J1Y6pNf+vqCZPipJ0LmRL0qzqWAyPDbrHlndfth8oc+0s6bn2ehKJrAikrCslzzWkaPIH3e65wzechXWeg+X9lV2zmv1/7jAiKefA972X7IdK+3eV9JTaZ4xVbQNGupN/PljZ4ql9OVzROjSxuJ739vwLqYZktpd71IcAAAAASUVORK5CYII='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"conv sum\",\"title\":\"\",\"src\":\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png\",\"srcSet\":[\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-96318.png 200w\",\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-dc6d3.png 400w\",\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png 468w\"],\"sizes\":[\"(max-width:\",\"468px)\",\"100vw,\",\"468px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"每次卷积核的运算： 相乘并累加\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"矩阵乘法 $C = AB$ 的单次运算: $A$ 的行向量与 $B$ 的列向量相乘并累加\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"不知道你有没有看出来两者的联系 ？\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"是的，基本操作都是相乘并累加。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"所有，有的人就想到了，将卷积层的计算也用矩阵乘法实现: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"$A$ 的每一行大小为 depth $\\\\times$ kernel size $\\\\times$ kernel size ，$B$ 的每一列也是相同大小，矩阵相乘的基本运算对应的就是单次卷积核相乘累加操作。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"也就是说，我们需要将 CNN 层的输入数据重新排列，根据它可以组成矩阵 $A$ 的每一行 — 矩阵 $A$ 每一行的数据就是按步长移动卷积核后，其对应位置上的原始输入数据。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"如下图所示，将 4维的输入张量数据转为 2维矩阵 $A$ ，通常称为 im2col, 表示 image-to-column\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 45.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAABYlAAAWJQFJUiTwAAABw0lEQVQoz32R7W+aUBSH+f//g2ZxWdXWIo3V+lIVRAQBqYJcBygvwzl1vgJeFY2J6K5tto+7eT7cnOQ55/xysOv1Gl1uTKa/LduZTGf9gQm3O1S/XC7X/z7M0tpzSxmaPRc07e+SKTf6Cq+rrYUlb5bTfzpqdD5HiOiD2ye6YIpYFIp3ndKdyqY65RigYsNu3uSSuoA779kdDD7loW82Vi/N5WveSNKTDO+/tscMJrWqGnMP2AeFS+uNuEIn3E5G5fC+iP/oFjZ/5cFafYNfqV0yP/9S9r+RYZwZ57CuVNZFYii/ACk7Anmt+Wj3ygMxrbdzTq+yWMzCQ3g+RZbfI7cJZo8zIV7fP9FhipsWMaFV6XMJU3qWm8SoTaiNpCtnAJ82ePwnKNmOafSNbbBzAo3cJW5m+ITk+uFDVoUCmuNKhCYQv5SczsRdtTRopkwp44CKH3iH4wGtbXm9SnBPw1QNPiKo7QM7zmN1XeakrDGgKY21jSoLSN2gJJ0WtZpjkHDjf2Y2PfAGYygzmo/2r+5R5iwGT6fabE56PhlAarkmfVhbrigvIL2gPp/vj0d0JiSPfJtb5MRVSVgVEfy60JmwfwBsmcWHVL5fVAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"im2col corrected\",\"title\":\"\",\"src\":\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png\",\"srcSet\":[\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-d8578.png 200w\",\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-a4478.png 400w\",\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png 768w\"],\"sizes\":[\"(max-width:\",\"768px)\",\"100vw,\",\"768px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"有的人可能会说，在步长 stride 比较小，kernel 比较大的情况下，上图中不同 patch 之间必然会相互覆盖 (overlap)，也就是说生成的 2 维矩阵 $A$ 会有大量的重复数据，生成这样的矩阵既浪费内存，又浪费时间，效率会高吗 ? \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"但是，请相信，和后面的矩阵乘法的高效比起来，这一步浪费的时间是有价值的。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"blockquote\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"The benefits from the very regular patterns of memory access outweigh the wasteful storage costs. The paper from Nvidia \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://arxiv.org/pdf/1410.0759.pdf\"},\"children\":[{\"type\":\"text\",\"value\":\"cuDNN: efficient primitives for Deep Learning\"}]},{\"type\":\"text\",\"value\":\" describe why they ended up with a modified version of GEMM. There are a lot of advantages to being able to batch up a lot of input images against the same kernels at once.\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"根据前面的分析：\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"$A$ 的行数为 patch 的数目，即  \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"batch size * output height * output width\"}]},{\"type\":\"text\",\"value\":\" \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"$B$ 的列数为卷积核的数目，即 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"output depth\"}]},{\"type\":\"text\",\"value\":\" \"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"于是输出的 2 维矩阵大小为:  \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"batch size * output height * output width\"}]},{\"type\":\"text\",\"value\":\"  $\\\\times$ \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"output depth\"}]},{\"type\":\"text\",\"value\":\" ，在下一层看来，它又是一个新的 4 维矩阵。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"如下图所示: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 60.15625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABYlAAAWJQFJUiTwAAACCUlEQVQoz22S22+aYBjG/W93vUO6NLV4tWQX7Xax6yVdFXWXS5atii5OBZzNUgWiKKVomBxETh/HgsI+dHTLtjdPngsefnl4yVtI0xQAwLKsIAgURdE0bVsWfJgkSbofx3FEUZQkCfpyuZAlOY7jQ1TILEld4AZeaOqW5/rbeJv+MUEQKIqiqqqmaaL4A3qcv1BwXDBdMKImzMXpaPZ9ueYFhWO4ked5MI6iCPYkv2aXfdBuF0X3223GFxR99Xl9gVnlCv26zr7BzDIGyh+Et6qqwFiYDOTeS5U43wxeqfiZRp4r/TOt/0LjuhmsmjJmoG2nillo0yy3QbXtoE2lyvO38S5dzYiIPArI43hY9AnoJz5xEhFP9dlVcoC/2LWOX+94ufxaa11nGNpxw8UElxqPPRK5H5Zc4nTvpZB4rs+bGbw25aZeaQG0ZedyKldShePmsPkG/0i/f+TixT0GHXEJJCSO9HljD1vK380BbK7NZizcajnpq9gTL+tE/gNrloLpaLaqnQugmFyjqDGEZe5bSB775Gl0jfhkMRoi2QpkDsOdG9Y7zLvE3Fz+5Sf54u6OPzRbX48cAvEHJdAvBtBxxOk+09hG9reBZ9+o/ZHWe9B407sWO4ZpwHglLngGn4+7PEPcMjhH9XiGXE4Ha2mRX9juHyW/Lwzew8awDBM4XqgbtmmBh/AnHxBnXDuuy+IAAAAASUVORK5CYII='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"im2colmult corrected1\",\"title\":\"\",\"src\":\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png\",\"srcSet\":[\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-d8578.png 200w\",\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-a4478.png 400w\",\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png 768w\"],\"sizes\":[\"(max-width:\",\"768px)\",\"100vw,\",\"768px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1.3 利用 numpy 验证\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"我们通过 numpy 验证两种方式计算卷积，哪一种更高效。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"背景: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ul\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"一张灰度图片，大小为 $332 \\\\times 300$, batch_size = 1， input depth = 1，因此输入数据是二维矩阵； \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"通过 python skimage 库读取图片\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"python\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"from\"}]},{\"type\":\"text\",\"value\":\" skimage \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"import\"}]},{\"type\":\"text\",\"value\":\" io \\nio\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"imread\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"'dog.jpg'\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"  \\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 332px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 90.36144578313254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAASABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAME/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABtZExLDTnCIP/xAAaEAACAwEBAAAAAAAAAAAAAAABAwACERIx/9oACAEBAAEFAlrrhCDGL5vgCqW6tux0X7P/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAcEAACAgIDAAAAAAAAAAAAAAABEQAQAhIhMZH/2gAIAQEABj8CeXkShHcZmqGgHFC//8QAGhABAAMBAQEAAAAAAAAAAAAAAQARMSGxQf/aAAgBAQABPyFxXWqQzC8RlAND7GqOrdR3Q8mujEJWeRPFhk//2gAMAwEAAgADAAAAEMPHAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB4QAQACAgEFAAAAAAAAAAAAAAEAESExUYGR0eHw/9oACAEBAAE/EECoAWne1hcW8ha3V7gE7MAr5gDUxcHmXmbiQRnvGqbW40ALRUdI0dL6GKxP/9k='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"dog\",\"title\":\"\",\"src\":\"/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg\",\"srcSet\":[\"/static/dog-085939e2d2f627a80f7608283c0b7574-fbbac.jpg 200w\",\"/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg 332w\"],\"sizes\":[\"(max-width:\",\"332px)\",\"100vw,\",\"332px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ul\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"卷积核大小为 $3 \\\\times 3$ ，ouput depth = 1，padding = 1，stride = 1\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"note: 其实这个卷积核是边缘检测算子\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"python\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"import\"}]},{\"type\":\"text\",\"value\":\" numpy \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"as\"}]},{\"type\":\"text\",\"value\":\" np\\nkernel \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"array\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"输出为二维矩阵，不考虑 depth 和 batch size，大小和输入数据相同\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"首先我们实现 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"zero_pad\"}]},{\"type\":\"text\",\"value\":\" 函数实现 边缘补 0\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"python\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"def\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"function\"]},\"children\":[{\"type\":\"text\",\"value\":\"zero_pad\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_height\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_width\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"triple-quoted-string\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\\"\\\"\\\" Zero-pad an image.\\n    Args:\\n        image: numpy array of shape (H, W)\\n        pad_width: width of the zero padding (left and right padding)\\n        pad_height: height of the zero padding (bottom and top padding)\\n    Returns:\\n        out: numpy array of shape (H+2*pad_height, W+2*pad_width)\\n    \\\"\\\"\\\"\"}]},{\"type\":\"text\",\"value\":\"\\n    H\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" W \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"shape\\n    out \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"boolean\"]},\"children\":[{\"type\":\"text\",\"value\":\"None\"}]},{\"type\":\"text\",\"value\":\"\\n\\n    out \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"zeros\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"H\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"*\"}]},{\"type\":\"text\",\"value\":\"pad_height\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" W\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"*\"}]},{\"type\":\"text\",\"value\":\"pad_width\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n    out\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"pad_height\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"pad_height\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"H\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_width\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"pad_width\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"W\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"return\"}]},{\"type\":\"text\",\"value\":\" out\"}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"方法一:\"}]},{\"type\":\"text\",\"value\":\" 通过 卷积定义计算，我们需要使用两个 for 循环\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"python\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"def\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"function\"]},\"children\":[{\"type\":\"text\",\"value\":\"conv_fast\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"triple-quoted-string\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\\"\\\"\\\" An efficient implementation of convolution filter.\\n    Args:\\n        image: numpy array of shape (Hi, Wi)\\n        kernel: numpy array of shape (Hk, Wk)\\n\\n    Returns:\\n        out: numpy array of shape (Hi, Wi)\\n    \\\"\\\"\\\"\"}]},{\"type\":\"text\",\"value\":\"\\n    Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wi \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"shape\\n    Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wk \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"shape\\n    out \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"zeros\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n    pad_height \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"//\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"text\",\"value\":\"\\n    pad_width \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Wk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"//\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"text\",\"value\":\"\\n    \\n    image_padding \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" zero_pad\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_height\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_width\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# 两个 for 循环，按 步长为 1 逐点计算\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"for\"}]},{\"type\":\"text\",\"value\":\" hi \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"in\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"builtin\"]},\"children\":[{\"type\":\"text\",\"value\":\"range\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n        \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"for\"}]},{\"type\":\"text\",\"value\":\" wi \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"in\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"builtin\"]},\"children\":[{\"type\":\"text\",\"value\":\"range\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n            out\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"builtin\"]},\"children\":[{\"type\":\"text\",\"value\":\"sum\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"image_padding\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"Wk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"*\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"return\"}]},{\"type\":\"text\",\"value\":\" out\"}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"方法二:\"}]},{\"type\":\"text\",\"value\":\" GEMM，矩阵相乘计算\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"python\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"def\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"function\"]},\"children\":[{\"type\":\"text\",\"value\":\"conv_faster\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"triple-quoted-string\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\\"\\\"\\\"\\n    Args:\\n        image: numpy array of shape (Hi, Wi)\\n        kernel: numpy array of shape (Hk, Wk)\\n\\n    Returns:\\n        out: numpy array of shape (Hi, Wi)\\n    \\\"\\\"\\\"\"}]},{\"type\":\"text\",\"value\":\"\\n    Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wi \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"shape\\n    Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wk \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"shape\\n    out \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"zeros\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n    pad_height \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"//\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"text\",\"value\":\"\\n    pad_width \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Wk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"//\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"text\",\"value\":\"\\n    \\n    image_padding \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" zero_pad\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_height\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_width\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n    \\n    gemm_input \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"zeros\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"*\"}]},{\"type\":\"text\",\"value\":\"Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"*\"}]},{\"type\":\"text\",\"value\":\"Wk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# 输入数据重排，得到我们需要的矩阵\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"for\"}]},{\"type\":\"text\",\"value\":\" hi \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"in\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"builtin\"]},\"children\":[{\"type\":\"text\",\"value\":\"range\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n        \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"for\"}]},{\"type\":\"text\",\"value\":\" wi \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"in\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"builtin\"]},\"children\":[{\"type\":\"text\",\"value\":\"range\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n            gemm_input\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"*\"}]},{\"type\":\"text\",\"value\":\"Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" image_padding\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"Wk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"reshape\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n            \\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# 一次矩阵乘法计算，直接得到结果\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# out shape: (Hi*Wi, 1)\"}]},{\"type\":\"text\",\"value\":\"\\n    out \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"matmul\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"gemm_input\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# 整理矩阵形状, out shape: (Hi, Wi)\"}]},{\"type\":\"text\",\"value\":\"\\n    out \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" out\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"reshape\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"return\"}]},{\"type\":\"text\",\"value\":\" out\"}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"最终结果: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"python\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"import\"}]},{\"type\":\"text\",\"value\":\" matplotlib\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"pyplot \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"as\"}]},{\"type\":\"text\",\"value\":\" plt\\n\\nt0 \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" time\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nout_fast \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" conv_fast\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"img\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nt1 \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" time\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nout_faster \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" conv_faster\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"img\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nt2 \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" time\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# Compare the running time of the two implementations\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"print\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\\"conv_fast: took %f seconds.\\\"\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"%\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"t1 \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"text\",\"value\":\" t0\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"print\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\\"conv_faster: took %f seconds.\\\"\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"%\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"t2 \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"text\",\"value\":\" t1\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# Plot conv_nested output\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"subplot\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"imshow\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"out_fast\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"title\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"'conv_fast'\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"axis\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"'off'\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# Plot conv_fast output\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"subplot\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"imshow\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"out_faster\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"title\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"'conv_faster'\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"axis\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"'off'\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# Make sure that the two outputs are the same\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"if\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"not\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"builtin\"]},\"children\":[{\"type\":\"text\",\"value\":\"max\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"out_fast \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"text\",\"value\":\" out_faster\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"<\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1e\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"10\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"print\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\\"Different outputs! Check your implementation.\\\"\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"结果如下: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"text\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"conv_fast: took 0.563950 seconds.\\nconv_faster: took 0.221714 seconds.\"}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"使用 GEMM 算法快了 50%，是不是很有效 !\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 601px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 45.92346089850249%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABo0lEQVQoz2WRy0pCURiFTw3sRZpHo2iWECJC0ShEhx0RIUG83+8gZYg48Al8hJAigiY9gYNAGvcK4fFc+tZBS0jY7L3X/s761/9rTCaTvXq9floul88rlUowmUxexOPxaDqdjqCfoYfz+fyhwY/7MUwILZhIJC5jsVjUNM2rDRcqFApHxnQ6DSB8NhoNr1qtepz9HcArFotOt9v1AB82hq+tVkvvbq1W2+XcZrOp/ckgYQCz5QZ0SOAC+atUKlkqlMvlhjLk/KICcDaGvxzLljnc3BiNRgHMlqqgB0zcrSmJLBXKZDL3MoTxDWHWO2bi1uoMbm7MZjM/oZIAOmpBZ+bmkcLqdDpeNpsdbg1VgIIq7CkE4xBny9BPKEMelpsZOJoPDy4futz/GeqOvlbL4tDU0Z/heDwOtNvtDwlUs9Q2H9hoSvGtRIB3MsTsGV3pV1uOd5vzSn8S+qMSHjCXL4EyVVKde72eWvEGg4HAiQzR3vv9vq/vchqRdrg3Y7FY7PNwTboklUzim9oxN0l4w7oFPJEhhSOkSkkXpyUOXlwKj/APlHJ3/u12OaIAAAAASUVORK5CYII='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"conv output\",\"title\":\"\",\"src\":\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png\",\"srcSet\":[\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-ae8c5.png 200w\",\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-d70b4.png 400w\",\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png 601w\"],\"sizes\":[\"(max-width:\",\"601px)\",\"100vw,\",\"601px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1.4 Darknet 实现\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"在 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"convolutional_layer.c\"}]},{\"type\":\"text\",\"value\":\" 中，实现了 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"forward_convolutional_layer\"}]},{\"type\":\"text\",\"value\":\" 函数，里面主要使用了两个函数: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"im2col_cpu\"}]},{\"type\":\"text\",\"value\":\" : 实现重排，考虑 padding, stride, kernel size 等参数\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"gemm\"}]},{\"type\":\"text\",\"value\":\" : 实现矩阵乘法 $C = \\\\alpha * AB + \\\\beta * C$\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"注意: \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"gemm\"}]},{\"type\":\"text\",\"value\":\" 支持 A, B 转置，因此具体实现有 4 个对应的函数\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"这两个函数分别在 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"im2col.c\"}]},{\"type\":\"text\",\"value\":\" 和 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"gemm.c\"}]},{\"type\":\"text\",\"value\":\" 实现\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"2. 反向传播\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"说白了，我们要获得 3 个值，该层的 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"weight_updates\"}]},{\"type\":\"text\",\"value\":\"  和 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"bias_updates\"}]},{\"type\":\"text\",\"value\":\" ，以及更新前一层的 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"delta\"}]},{\"type\":\"text\",\"value\":\" \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"如果从 GEMM 的角度考虑，得到 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"weight_updates\"}]},{\"type\":\"text\",\"value\":\" 和 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"bias_updates\"}]},{\"type\":\"text\",\"value\":\" 就很容易，因为它就是矩阵相乘的偏导，我们只要把前一层的 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"ouput\"}]},{\"type\":\"text\",\"value\":\" 重排一下重新得到上面的矩阵 $A$ ，然后和全连接层类似。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"至于 前一层的 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"delta\"}]},{\"type\":\"text\",\"value\":\" ，我们在计算矩阵偏导后，还需要多一步，逆重排，在 Darknet 中通过 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"col2im_cpu\"}]},{\"type\":\"text\",\"value\":\" 实现，注意这一步基本是叠加元素叠加实现的。感觉具体细节比较麻烦，主要是如何寻找索引，详细请看 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"col2im_cpu.c\"}]},{\"type\":\"text\",\"value\":\" 文件\"}]}],\"data\":{\"quirksMode\":false}},\"fields\":{\"slug\":\"/DarkNet-CNN-Source-Code-Analyse/\",\"prefix\":\"2018-12-04\"},\"frontmatter\":{\"title\":\"DarkNet CNN Source Code Analyse\",\"subTitle\":\"介绍 DarkNet CNN 实现流程\",\"cover\":{\"childImageSharp\":{\"resize\":{\"src\":\"/static/darknet-a128141842710e6137de63943fa20758-160fa.png\"}}}}},\"author\":{\"id\":\"F:/program/BlogSite/content/parts/author.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>我是一名数据工程师，对硬件有浓厚的兴趣。</p>\"},\"footnote\":{\"id\":\"F:/program/BlogSite/content/parts/footnote.md absPath of file >>> MarkdownRemark\",\"html\":\"<ul>\\n<li>this is a site built by <a href=\\\"https://www.gatsbyjs.org/\\\">GatsbyJS</a>, ReactJs, CSS in JS</li>\\n<li>delivered by <a href=\\\"https://pages.github.com/\\\">Github Page</a></li>\\n</ul>\"},\"site\":{\"siteMetadata\":{\"facebook\":{\"appId\":\"\"}}}},\"pathContext\":{\"slug\":\"/DarkNet-CNN-Source-Code-Analyse/\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---dark-net-cnn-source-code-analyse-0aa53d24096e16a20569.js","module.exports = {\"data\":{\"post\":{\"id\":\"F:/program/BlogSite/content/posts/2018-12-04--DarkNet-CNN-Source-Code-Analyse/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>在了解 全连接层反向传播的机理后，我在 Google 上找了一圈，都没有找到讲得很好的 CNN 反向传播的计算，本想通过研究 Pytorch 源码分析算法原理，发现 Pytorch 底层是调用 C 代码的，也就不了了之了。最近在学习 Darknet 源码时，终于搞懂了这部分的原理。</p>\\n<!--more-->\\n<h2>1. 前向传播</h2>\\n<p>这里要先说明一点，这个地方对应学过数字信号处理的同学来说，还是非常坑的。</p>\\n<p>数字信号处理中，实际的卷积操作如下: </p>\\n$$\\n(f*h)[m,n]=\\\\sum_{i=-\\\\infty}^\\\\infty\\\\sum_{j=-\\\\infty}^\\\\infty f[i,j]\\\\cdot h[m-i,n-j]\\n$$\\n<p>而深度学习的卷积操作如下: </p>\\n$$\\n(f*h)[m,n]=\\\\sum_{i=-\\\\infty}^\\\\infty\\\\sum_{j=-\\\\infty}^\\\\infty f[i,j]\\\\cdot h[i-m,j-n]\\n$$\\n<p>也就是说，深度学习中的卷积操作实际上是<strong>相关操作</strong> (correlation)</p>\\n<p>在数字信号处理中，一维卷积需要把信号序列 (一般是时间序列) 绕原点翻转，二维卷积则需要把信号序列 (一般是图像序列) 绕中心点旋转 $180^{\\\\circ}$ </p>\\n<blockquote>\\n<p>convolution is a filtering operation. correlation compared the similarity of two sets of data. Correlation is a measure of relatedness of two signals.</p>\\n</blockquote>\\n<p>但其实，在深度学习中，卷积和相关可以理解为是相同的。</p>\\n<p>因为我们学习的就是卷积核权重，即卷积核未知，每次反向传播都会自动更新使得误差最小。而传统的图像处理采用已知的卷积核，如果不做翻转处理，结果完全不一样。当然，卷积核绕中心 $180^{\\\\circ}$ 对称的话，两种处理结果也是相同的。</p>\\n<p>感兴趣的还可以看下 我的这篇博客 <a href=\\\"http://brunoliu.com/2018/06/14/thinking-of-2d-convolution/\\\">Thinking of 2D convolution</a></p>\\n<h3>1.1 输出尺寸</h3>\\n<p>大多数博客只提到 CNN 算法的前向传播原理。其实如果搞过传统图像处理的，应该都知道，卷积层的本质就是滤波，包括高通滤波用于边缘检测，低通滤波 (如高斯滤波器) 用于图片平滑。感兴趣的可以去找相关书籍看看。</p>\\n<p>前向传播一个稍微麻烦的地方是 如果根据 input height, input width, kernel size, padding, stride 计算输出 output height , output width </p>\\n<p>公式如下: </p>\\n$$\\n\\\\text {output height} = \\\\Big \\\\lfloor \\\\cfrac {\\\\text {input height} + 2 \\\\times \\\\text {padding} - \\\\text {kernel size}} {\\\\text {stride}} \\\\Big \\\\rfloor + 1 \\n$$\\n<p><code class=\\\"language-text\\\">output width</code> 计算是类似的。</p>\\n<p>参考论文: <a href=\\\"https://arxiv.org/abs/1603.07285\\\">A guide to convolution arithmetic for deep learning</a></p>\\n<p>对应的 GitHub repo: <a href=\\\"https://github.com/vdumoulin/conv_arithmetic\\\">conv_arithmetic</a></p>\\n<h3>1.2 卷积实现</h3>\\n<p>这一小节参考的博客: <a href=\\\"https://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/\\\">Why GEMM is at the heart of deep learning</a> </p>\\n<p>本博客着重讲的是第二点，如果实现二维卷积计算 ? </p>\\n<p>传统的数字信号处理中，对于两个长度相当的数据，我们通常用傅里叶变换间接求两个信号的卷积。</p>\\n<p>但由于深度学习中，常见的卷积核大小为 $3 \\\\times 3$, $5 \\\\times 5$ 等，采用傅里叶变换得不偿失，我们通常利用卷积定义直接计算。</p>\\n<p>由此引入本文的核心: <strong>GEMM</strong> — GEneral Matrix to Matrix Multiplication</p>\\n<p>它是 BLAS (Basic Linear Algebra Subprograms) library 的一部分。</p>\\n<p>GELL 听上去很高大上，是不是 ?</p>\\n<p>其实说白了就是 <strong>矩阵乘法</strong> 的计算实现。</p>\\n<p>矩阵乘法在深度学习中最直观的使用莫过于全连接层了，输入神经元和权重矩阵进行矩阵乘法，再和偏置矩阵相加，得到输出神经元的值。</p>\\n<p>言归正传，回到 CNN 实现</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 50.390625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAABYlAAAWJQFJUiTwAAABe0lEQVQoz22RTU/CQBBA+6P9C3pCo4mIATSBaKIhHjDh7MVgYvAgggItpYVd2tLS0g8srd0dh6KVRCYvk91m3u5sR+CcA4C7cEbykJLJUBKnhMBvxHEchuGm5n8IbUJl3ZwY1mhqqLopUx0hpo1rcSj3ez1RFPGI3fKVOj5WJle2V527lblbtT3MFWuB21N53DNmWPSVJCuMMFyzWkVRhO0wxoSapufsxQVAkfMi5l9KAPk4FoMlyp7vjwmdGuZIUVRVwSRJUhAEwi3VcpZ9yaAUs9IXzygnkF+uRD/YdGiOB7NBa/DR6XTfdU37aftH5rB2EsgoM8h/RpmsPl7LN3tK4/DlualOCKU0lafakeWgXE5vy7hgcLYlO2qbNva9h9zbS7Pd6TqOs5ZrhB6Yc3xkIeEFBhnnHE7CqJ/KLB3VSOq/tp4MQ8f1ZniCtQzqml53/frC2+be9e8smwRrGQs5Y93ue68/wJ/9NypIzwHGdrMVYfiJE9r+8g0dCCBSGZDZNwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"kernelview\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png\\\"\\n        srcset=\\\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-d8578.png 200w,\\n/static/kernelview-bd0283cc68eb34bae246e8d28931361b-a4478.png 400w,\\n/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png 768w\\\"\\n        sizes=\\\"(max-width: 768px) 100vw, 768px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>CNN 层输入数据尺寸为 batch_size $\\\\times$ depth (channel) $\\\\times$ input height $\\\\times$ input width，这是一个4维张量，在 Pytorch 中输入张量的顺序也是 batch $\\\\times$ depth $\\\\times$ height $\\\\times$ width </p>\\n<p>如果考虑对 batch 循环处理，那么每次的输入数据尺寸为 depth(channel) $\\\\times$ input height $\\\\times$ input width </p>\\n<p>卷积核的大小则为  output depth $\\\\times$ depth $\\\\times$ kernel size $\\\\times$ kernel size </p>\\n<p>注: 这里和别的博客说法不同，一般都将单个卷积核视为二维的，但其实想一下，考虑沿着深度方向 (每个输入通道) 都存在相应的不同卷积核，最后叠加。那么我们直接将沿着深度方向的所有卷积核视为一个卷积核，进行 3 维的相乘累加操作，不是更方便吗 ? </p>\\n<p>下图展示了输入数据尺寸为 $1 \\\\times 2 \\\\times 5 \\\\times 5$ (batch:1, depth:2, height: 5, width: 5)，卷积核尺寸为 $3 \\\\times 2 \\\\times 3 \\\\times 3$ (output depth: 3, input depth: 2, kernel size: 3 )，输出数据尺寸为 $1 \\\\times 3 \\\\times 3 \\\\times 3$ </p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 468px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsSAAALEgHS3X78AAAC/ElEQVQ4y41UyWsTURzOQaSCC3gRERRBkHrViyf/AM+epAcpokIREbFbWu0iQkUsaEvrXiJq06Y1LdbUtKmmi91NKralS+qSNrFJJpNZ38ybN/HNvGQyTYL1HYaZ3/y+3/p9z5LMd1RVxU+K5Z6Pf3k44g0nEobRfCx5wUj3szrf7au17qmzjq4F8KeC0PZgjEPaI1lkayuoKj1x7+5yOGxE3D4z8erz+251OT76/Xlrzgar+sEvsizH43FFkvhEQhIEOpFQFOVfYAJDCDEMQ9M08aZoGlcLIcSxOI4jPkYVFnOdvCBgJwCAETGOwek5Caa/6pbMqsonGI5ls3rjGMZswQNnGUZg2EzmTYa96Gi/4mgP0zSpigx25vfP829ttW6XAqEx7flQqOiNrfxDrwCABl6NRApqKvbfqV7c2CBOZKWOOZ+l4vqppgcykPAn1I3uhQVL1c3jjQ00x2lgRhSbR7wtI16aF8wzD0Qj9z0D9q+zpG2SORinGj95Xk1PSRCmepYlCQhC7jLE9ITNB/C8qodLgYEsi5KUSxXcmLx1wykjVDJgzAoAxNzMAk6SkxnvDBmZcTPhaDwUodBW6ssQBv9EqPRiyIFIWd+MRmlthRp4YGKlsNp1usETCMdJLKQna+r1HbX2n2sdhbKkL1mz2tzfjlldZx8Ns7yggR93TO4o7jxS1rcSonSGplh4tXHQUtx9psEDZWCAbz/1Wi50nawfZAjYNx+sezbU5vKRTaY3lXSPLdW/+Px+fDmlU906PB2oeeLpGVtSk2qa27qCVFPPBM8yWBhINRl5jlEgyNATpWUYi8WgzkRjwjyb4TZ+wcIQBDHVWpaesQwpihJF7TcrAOfsj86J1Y6pNf+vqCZPipJ0LmRL0qzqWAyPDbrHlndfth8oc+0s6bn2ehKJrAikrCslzzWkaPIH3e65wzechXWeg+X9lV2zmv1/7jAiKefA972X7IdK+3eV9JTaZ4xVbQNGupN/PljZ4ql9OVzROjSxuJ739vwLqYZktpd71IcAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"conv sum\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png\\\"\\n        srcset=\\\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-96318.png 200w,\\n/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-dc6d3.png 400w,\\n/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png 468w\\\"\\n        sizes=\\\"(max-width: 468px) 100vw, 468px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>每次卷积核的运算： 相乘并累加</p>\\n<p>矩阵乘法 $C = AB$ 的单次运算: $A$ 的行向量与 $B$ 的列向量相乘并累加</p>\\n<p>不知道你有没有看出来两者的联系 ？</p>\\n<p>是的，基本操作都是相乘并累加。</p>\\n<p>所有，有的人就想到了，将卷积层的计算也用矩阵乘法实现: </p>\\n<p>$A$ 的每一行大小为 depth $\\\\times$ kernel size $\\\\times$ kernel size ，$B$ 的每一列也是相同大小，矩阵相乘的基本运算对应的就是单次卷积核相乘累加操作。</p>\\n<p>也就是说，我们需要将 CNN 层的输入数据重新排列，根据它可以组成矩阵 $A$ 的每一行 — 矩阵 $A$ 每一行的数据就是按步长移动卷积核后，其对应位置上的原始输入数据。</p>\\n<p>如下图所示，将 4维的输入张量数据转为 2维矩阵 $A$ ，通常称为 im2col, 表示 image-to-column</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 45.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAABYlAAAWJQFJUiTwAAABw0lEQVQoz32R7W+aUBSH+f//g2ZxWdXWIo3V+lIVRAQBqYJcBygvwzl1vgJeFY2J6K5tto+7eT7cnOQ55/xysOv1Gl1uTKa/LduZTGf9gQm3O1S/XC7X/z7M0tpzSxmaPRc07e+SKTf6Cq+rrYUlb5bTfzpqdD5HiOiD2ye6YIpYFIp3ndKdyqY65RigYsNu3uSSuoA779kdDD7loW82Vi/N5WveSNKTDO+/tscMJrWqGnMP2AeFS+uNuEIn3E5G5fC+iP/oFjZ/5cFafYNfqV0yP/9S9r+RYZwZ57CuVNZFYii/ACk7Anmt+Wj3ygMxrbdzTq+yWMzCQ3g+RZbfI7cJZo8zIV7fP9FhipsWMaFV6XMJU3qWm8SoTaiNpCtnAJ82ePwnKNmOafSNbbBzAo3cJW5m+ITk+uFDVoUCmuNKhCYQv5SczsRdtTRopkwp44CKH3iH4wGtbXm9SnBPw1QNPiKo7QM7zmN1XeakrDGgKY21jSoLSN2gJJ0WtZpjkHDjf2Y2PfAGYygzmo/2r+5R5iwGT6fabE56PhlAarkmfVhbrigvIL2gPp/vj0d0JiSPfJtb5MRVSVgVEfy60JmwfwBsmcWHVL5fVAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"im2col corrected\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png\\\"\\n        srcset=\\\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-d8578.png 200w,\\n/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-a4478.png 400w,\\n/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png 768w\\\"\\n        sizes=\\\"(max-width: 768px) 100vw, 768px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>有的人可能会说，在步长 stride 比较小，kernel 比较大的情况下，上图中不同 patch 之间必然会相互覆盖 (overlap)，也就是说生成的 2 维矩阵 $A$ 会有大量的重复数据，生成这样的矩阵既浪费内存，又浪费时间，效率会高吗 ? </p>\\n<p>但是，请相信，和后面的矩阵乘法的高效比起来，这一步浪费的时间是有价值的。</p>\\n<blockquote>\\n<p>The benefits from the very regular patterns of memory access outweigh the wasteful storage costs. The paper from Nvidia <a href=\\\"https://arxiv.org/pdf/1410.0759.pdf\\\">cuDNN: efficient primitives for Deep Learning</a> describe why they ended up with a modified version of GEMM. There are a lot of advantages to being able to batch up a lot of input images against the same kernels at once.</p>\\n</blockquote>\\n<p>根据前面的分析：</p>\\n<ol>\\n<li>$A$ 的行数为 patch 的数目，即  <code class=\\\"language-text\\\">batch size * output height * output width</code> </li>\\n<li>$B$ 的列数为卷积核的数目，即 <code class=\\\"language-text\\\">output depth</code> </li>\\n</ol>\\n<p>于是输出的 2 维矩阵大小为:  <code class=\\\"language-text\\\">batch size * output height * output width</code>  $\\\\times$ <code class=\\\"language-text\\\">output depth</code> ，在下一层看来，它又是一个新的 4 维矩阵。</p>\\n<p>如下图所示: </p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 60.15625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABYlAAAWJQFJUiTwAAACCUlEQVQoz22S22+aYBjG/W93vUO6NLV4tWQX7Xax6yVdFXWXS5atii5OBZzNUgWiKKVomBxETh/HgsI+dHTLtjdPngsefnl4yVtI0xQAwLKsIAgURdE0bVsWfJgkSbofx3FEUZQkCfpyuZAlOY7jQ1TILEld4AZeaOqW5/rbeJv+MUEQKIqiqqqmaaL4A3qcv1BwXDBdMKImzMXpaPZ9ueYFhWO4ked5MI6iCPYkv2aXfdBuF0X3223GFxR99Xl9gVnlCv26zr7BzDIGyh+Et6qqwFiYDOTeS5U43wxeqfiZRp4r/TOt/0LjuhmsmjJmoG2nillo0yy3QbXtoE2lyvO38S5dzYiIPArI43hY9AnoJz5xEhFP9dlVcoC/2LWOX+94ufxaa11nGNpxw8UElxqPPRK5H5Zc4nTvpZB4rs+bGbw25aZeaQG0ZedyKldShePmsPkG/0i/f+TixT0GHXEJJCSO9HljD1vK380BbK7NZizcajnpq9gTL+tE/gNrloLpaLaqnQugmFyjqDGEZe5bSB775Gl0jfhkMRoi2QpkDsOdG9Y7zLvE3Fz+5Sf54u6OPzRbX48cAvEHJdAvBtBxxOk+09hG9reBZ9+o/ZHWe9B407sWO4ZpwHglLngGn4+7PEPcMjhH9XiGXE4Ha2mRX9juHyW/Lwzew8awDBM4XqgbtmmBh/AnHxBnXDuuy+IAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"im2colmult corrected1\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png\\\"\\n        srcset=\\\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-d8578.png 200w,\\n/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-a4478.png 400w,\\n/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png 768w\\\"\\n        sizes=\\\"(max-width: 768px) 100vw, 768px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<h3>1.3 利用 numpy 验证</h3>\\n<p>我们通过 numpy 验证两种方式计算卷积，哪一种更高效。</p>\\n<p>背景: </p>\\n<ul>\\n<li>\\n<p>一张灰度图片，大小为 $332 \\\\times 300$, batch_size = 1， input depth = 1，因此输入数据是二维矩阵； </p>\\n<p>通过 python skimage 库读取图片</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">from</span> skimage <span class=\\\"token keyword\\\">import</span> io \\nio<span class=\\\"token punctuation\\\">.</span>imread<span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'dog.jpg'</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n</li>\\n</ul>\\n<p>  \\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 332px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 90.36144578313254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAASABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAME/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABtZExLDTnCIP/xAAaEAACAwEBAAAAAAAAAAAAAAABAwACERIx/9oACAEBAAEFAlrrhCDGL5vgCqW6tux0X7P/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAcEAACAgIDAAAAAAAAAAAAAAABEQAQAhIhMZH/2gAIAQEABj8CeXkShHcZmqGgHFC//8QAGhABAAMBAQEAAAAAAAAAAAAAAQARMSGxQf/aAAgBAQABPyFxXWqQzC8RlAND7GqOrdR3Q8mujEJWeRPFhk//2gAMAwEAAgADAAAAEMPHAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB4QAQACAgEFAAAAAAAAAAAAAAEAESExUYGR0eHw/9oACAEBAAE/EECoAWne1hcW8ha3V7gE7MAr5gDUxcHmXmbiQRnvGqbW40ALRUdI0dL6GKxP/9k='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"dog\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg\\\"\\n        srcset=\\\"/static/dog-085939e2d2f627a80f7608283c0b7574-fbbac.jpg 200w,\\n/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg 332w\\\"\\n        sizes=\\\"(max-width: 332px) 100vw, 332px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<ul>\\n<li>\\n<p>卷积核大小为 $3 \\\\times 3$ ，ouput depth = 1，padding = 1，stride = 1</p>\\n<p>note: 其实这个卷积核是边缘检测算子</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">import</span> numpy <span class=\\\"token keyword\\\">as</span> np\\nkernel <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>array<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">[</span>\\n  <span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n  <span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n  <span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span>\\n<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n</li>\\n<li>\\n<p>输出为二维矩阵，不考虑 depth 和 batch size，大小和输入数据相同</p>\\n</li>\\n</ul>\\n<p>首先我们实现 <code class=\\\"language-text\\\">zero_pad</code> 函数实现 边缘补 0</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">def</span> <span class=\\\"token function\\\">zero_pad</span><span class=\\\"token punctuation\\\">(</span>image<span class=\\\"token punctuation\\\">,</span> pad_height<span class=\\\"token punctuation\\\">,</span> pad_width<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n    <span class=\\\"token triple-quoted-string string\\\">\\\"\\\"\\\" Zero-pad an image.\\n    Args:\\n        image: numpy array of shape (H, W)\\n        pad_width: width of the zero padding (left and right padding)\\n        pad_height: height of the zero padding (bottom and top padding)\\n    Returns:\\n        out: numpy array of shape (H+2*pad_height, W+2*pad_width)\\n    \\\"\\\"\\\"</span>\\n    H<span class=\\\"token punctuation\\\">,</span> W <span class=\\\"token operator\\\">=</span> image<span class=\\\"token punctuation\\\">.</span>shape\\n    out <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">None</span>\\n\\n    out <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>zeros<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">[</span>H<span class=\\\"token operator\\\">+</span><span class=\\\"token number\\\">2</span><span class=\\\"token operator\\\">*</span>pad_height<span class=\\\"token punctuation\\\">,</span> W<span class=\\\"token operator\\\">+</span><span class=\\\"token number\\\">2</span><span class=\\\"token operator\\\">*</span>pad_width<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span>\\n    out<span class=\\\"token punctuation\\\">[</span>pad_height<span class=\\\"token punctuation\\\">:</span>pad_height<span class=\\\"token operator\\\">+</span>H<span class=\\\"token punctuation\\\">,</span> pad_width<span class=\\\"token punctuation\\\">:</span>pad_width<span class=\\\"token operator\\\">+</span>W<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> image<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">]</span>\\n    <span class=\\\"token keyword\\\">return</span> out</code></pre>\\n      </div>\\n<p><strong>方法一:</strong> 通过 卷积定义计算，我们需要使用两个 for 循环</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">def</span> <span class=\\\"token function\\\">conv_fast</span><span class=\\\"token punctuation\\\">(</span>image<span class=\\\"token punctuation\\\">,</span> kernel<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n    <span class=\\\"token triple-quoted-string string\\\">\\\"\\\"\\\" An efficient implementation of convolution filter.\\n    Args:\\n        image: numpy array of shape (Hi, Wi)\\n        kernel: numpy array of shape (Hk, Wk)\\n\\n    Returns:\\n        out: numpy array of shape (Hi, Wi)\\n    \\\"\\\"\\\"</span>\\n    Hi<span class=\\\"token punctuation\\\">,</span> Wi <span class=\\\"token operator\\\">=</span> image<span class=\\\"token punctuation\\\">.</span>shape\\n    Hk<span class=\\\"token punctuation\\\">,</span> Wk <span class=\\\"token operator\\\">=</span> kernel<span class=\\\"token punctuation\\\">.</span>shape\\n    out <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>zeros<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>Hi<span class=\\\"token punctuation\\\">,</span> Wi<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\n    pad_height <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>Hk<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">//</span><span class=\\\"token number\\\">2</span>\\n    pad_width <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>Wk<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">//</span><span class=\\\"token number\\\">2</span>\\n    \\n    image_padding <span class=\\\"token operator\\\">=</span> zero_pad<span class=\\\"token punctuation\\\">(</span>image<span class=\\\"token punctuation\\\">,</span> pad_height<span class=\\\"token punctuation\\\">,</span> pad_width<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token comment\\\"># 两个 for 循环，按 步长为 1 逐点计算</span>\\n    <span class=\\\"token keyword\\\">for</span> hi <span class=\\\"token keyword\\\">in</span> <span class=\\\"token builtin\\\">range</span><span class=\\\"token punctuation\\\">(</span>Hi<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n        <span class=\\\"token keyword\\\">for</span> wi <span class=\\\"token keyword\\\">in</span> <span class=\\\"token builtin\\\">range</span><span class=\\\"token punctuation\\\">(</span>Wi<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n            out<span class=\\\"token punctuation\\\">[</span>hi<span class=\\\"token punctuation\\\">,</span> wi<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span><span class=\\\"token builtin\\\">sum</span><span class=\\\"token punctuation\\\">(</span>image_padding<span class=\\\"token punctuation\\\">[</span>hi<span class=\\\"token punctuation\\\">:</span>hi<span class=\\\"token operator\\\">+</span>Hk<span class=\\\"token punctuation\\\">,</span> wi<span class=\\\"token punctuation\\\">:</span>wi<span class=\\\"token operator\\\">+</span>Wk<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">*</span> kernel<span class=\\\"token punctuation\\\">)</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> out</code></pre>\\n      </div>\\n<p><strong>方法二:</strong> GEMM，矩阵相乘计算</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">def</span> <span class=\\\"token function\\\">conv_faster</span><span class=\\\"token punctuation\\\">(</span>image<span class=\\\"token punctuation\\\">,</span> kernel<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n    <span class=\\\"token triple-quoted-string string\\\">\\\"\\\"\\\"\\n    Args:\\n        image: numpy array of shape (Hi, Wi)\\n        kernel: numpy array of shape (Hk, Wk)\\n\\n    Returns:\\n        out: numpy array of shape (Hi, Wi)\\n    \\\"\\\"\\\"</span>\\n    Hi<span class=\\\"token punctuation\\\">,</span> Wi <span class=\\\"token operator\\\">=</span> image<span class=\\\"token punctuation\\\">.</span>shape\\n    Hk<span class=\\\"token punctuation\\\">,</span> Wk <span class=\\\"token operator\\\">=</span> kernel<span class=\\\"token punctuation\\\">.</span>shape\\n    out <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>zeros<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>Hi<span class=\\\"token punctuation\\\">,</span> Wi<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\n    pad_height <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>Hk<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">//</span><span class=\\\"token number\\\">2</span>\\n    pad_width <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>Wk<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">//</span><span class=\\\"token number\\\">2</span>\\n    \\n    image_padding <span class=\\\"token operator\\\">=</span> zero_pad<span class=\\\"token punctuation\\\">(</span>image<span class=\\\"token punctuation\\\">,</span> pad_height<span class=\\\"token punctuation\\\">,</span> pad_width<span class=\\\"token punctuation\\\">)</span>\\n    \\n    gemm_input <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>zeros<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>Hi<span class=\\\"token operator\\\">*</span>Wi<span class=\\\"token punctuation\\\">,</span> Hk<span class=\\\"token operator\\\">*</span>Wk<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token comment\\\"># 输入数据重排，得到我们需要的矩阵</span>\\n    <span class=\\\"token keyword\\\">for</span> hi <span class=\\\"token keyword\\\">in</span> <span class=\\\"token builtin\\\">range</span><span class=\\\"token punctuation\\\">(</span>Hi<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n        <span class=\\\"token keyword\\\">for</span> wi <span class=\\\"token keyword\\\">in</span> <span class=\\\"token builtin\\\">range</span><span class=\\\"token punctuation\\\">(</span>Wi<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n            gemm_input<span class=\\\"token punctuation\\\">[</span>hi<span class=\\\"token operator\\\">*</span>Wi<span class=\\\"token operator\\\">+</span>wi<span class=\\\"token punctuation\\\">,</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> image_padding<span class=\\\"token punctuation\\\">[</span>hi<span class=\\\"token punctuation\\\">:</span>hi<span class=\\\"token operator\\\">+</span>Hk<span class=\\\"token punctuation\\\">,</span> wi<span class=\\\"token punctuation\\\">:</span>wi<span class=\\\"token operator\\\">+</span>Wk<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">.</span>reshape<span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span>\\n            \\n    <span class=\\\"token comment\\\"># 一次矩阵乘法计算，直接得到结果</span>\\n    <span class=\\\"token comment\\\"># out shape: (Hi*Wi, 1)</span>\\n    out <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>matmul<span class=\\\"token punctuation\\\">(</span>gemm_input<span class=\\\"token punctuation\\\">,</span> kernel<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token comment\\\"># 整理矩阵形状, out shape: (Hi, Wi)</span>\\n    out <span class=\\\"token operator\\\">=</span> out<span class=\\\"token punctuation\\\">.</span>reshape<span class=\\\"token punctuation\\\">(</span>Hi<span class=\\\"token punctuation\\\">,</span> Wi<span class=\\\"token punctuation\\\">)</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> out</code></pre>\\n      </div>\\n<p>最终结果: </p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">import</span> matplotlib<span class=\\\"token punctuation\\\">.</span>pyplot <span class=\\\"token keyword\\\">as</span> plt\\n\\nt0 <span class=\\\"token operator\\\">=</span> time<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\nout_fast <span class=\\\"token operator\\\">=</span> conv_fast<span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token punctuation\\\">,</span> kernel<span class=\\\"token punctuation\\\">)</span>\\nt1 <span class=\\\"token operator\\\">=</span> time<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\nout_faster <span class=\\\"token operator\\\">=</span> conv_faster<span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token punctuation\\\">,</span> kernel<span class=\\\"token punctuation\\\">)</span>\\nt2 <span class=\\\"token operator\\\">=</span> time<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token comment\\\"># Compare the running time of the two implementations</span>\\n<span class=\\\"token keyword\\\">print</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"conv_fast: took %f seconds.\\\"</span> <span class=\\\"token operator\\\">%</span> <span class=\\\"token punctuation\\\">(</span>t1 <span class=\\\"token operator\\\">-</span> t0<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token keyword\\\">print</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"conv_faster: took %f seconds.\\\"</span> <span class=\\\"token operator\\\">%</span> <span class=\\\"token punctuation\\\">(</span>t2 <span class=\\\"token operator\\\">-</span> t1<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token comment\\\"># Plot conv_nested output</span>\\nplt<span class=\\\"token punctuation\\\">.</span>subplot<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span>\\nplt<span class=\\\"token punctuation\\\">.</span>imshow<span class=\\\"token punctuation\\\">(</span>out_fast<span class=\\\"token punctuation\\\">)</span>\\nplt<span class=\\\"token punctuation\\\">.</span>title<span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'conv_fast'</span><span class=\\\"token punctuation\\\">)</span>\\nplt<span class=\\\"token punctuation\\\">.</span>axis<span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'off'</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token comment\\\"># Plot conv_fast output</span>\\nplt<span class=\\\"token punctuation\\\">.</span>subplot<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">,</span><span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span>\\nplt<span class=\\\"token punctuation\\\">.</span>imshow<span class=\\\"token punctuation\\\">(</span>out_faster<span class=\\\"token punctuation\\\">)</span>\\nplt<span class=\\\"token punctuation\\\">.</span>title<span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'conv_faster'</span><span class=\\\"token punctuation\\\">)</span>\\nplt<span class=\\\"token punctuation\\\">.</span>axis<span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'off'</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token comment\\\"># Make sure that the two outputs are the same</span>\\n<span class=\\\"token keyword\\\">if</span> <span class=\\\"token operator\\\">not</span> <span class=\\\"token punctuation\\\">(</span>np<span class=\\\"token punctuation\\\">.</span><span class=\\\"token builtin\\\">max</span><span class=\\\"token punctuation\\\">(</span>out_fast <span class=\\\"token operator\\\">-</span> out_faster<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">1e</span><span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">10</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n    <span class=\\\"token keyword\\\">print</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Different outputs! Check your implementation.\\\"</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>结果如下: </p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"text\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">conv_fast: took 0.563950 seconds.\\nconv_faster: took 0.221714 seconds.</code></pre>\\n      </div>\\n<p>使用 GEMM 算法快了 50%，是不是很有效 !</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 601px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 45.92346089850249%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABo0lEQVQoz2WRy0pCURiFTw3sRZpHo2iWECJC0ShEhx0RIUG83+8gZYg48Al8hJAigiY9gYNAGvcK4fFc+tZBS0jY7L3X/s761/9rTCaTvXq9floul88rlUowmUxexOPxaDqdjqCfoYfz+fyhwY/7MUwILZhIJC5jsVjUNM2rDRcqFApHxnQ6DSB8NhoNr1qtepz9HcArFotOt9v1AB82hq+tVkvvbq1W2+XcZrOp/ckgYQCz5QZ0SOAC+atUKlkqlMvlhjLk/KICcDaGvxzLljnc3BiNRgHMlqqgB0zcrSmJLBXKZDL3MoTxDWHWO2bi1uoMbm7MZjM/oZIAOmpBZ+bmkcLqdDpeNpsdbg1VgIIq7CkE4xBny9BPKEMelpsZOJoPDy4futz/GeqOvlbL4tDU0Z/heDwOtNvtDwlUs9Q2H9hoSvGtRIB3MsTsGV3pV1uOd5vzSn8S+qMSHjCXL4EyVVKde72eWvEGg4HAiQzR3vv9vq/vchqRdrg3Y7FY7PNwTboklUzim9oxN0l4w7oFPJEhhSOkSkkXpyUOXlwKj/APlHJ3/u12OaIAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"conv output\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png\\\"\\n        srcset=\\\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-ae8c5.png 200w,\\n/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-d70b4.png 400w,\\n/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png 601w\\\"\\n        sizes=\\\"(max-width: 601px) 100vw, 601px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<h3>1.4 Darknet 实现</h3>\\n<p>在 <code class=\\\"language-text\\\">convolutional_layer.c</code> 中，实现了 <code class=\\\"language-text\\\">forward_convolutional_layer</code> 函数，里面主要使用了两个函数: </p>\\n<ol>\\n<li><code class=\\\"language-text\\\">im2col_cpu</code> : 实现重排，考虑 padding, stride, kernel size 等参数</li>\\n<li><code class=\\\"language-text\\\">gemm</code> : 实现矩阵乘法 $C = \\\\alpha * AB + \\\\beta * C$</li>\\n</ol>\\n<p>注意: <code class=\\\"language-text\\\">gemm</code> 支持 A, B 转置，因此具体实现有 4 个对应的函数</p>\\n<p>这两个函数分别在 <code class=\\\"language-text\\\">im2col.c</code> 和 <code class=\\\"language-text\\\">gemm.c</code> 实现</p>\\n<h2>2. 反向传播</h2>\\n<p>说白了，我们要获得 3 个值，该层的 <code class=\\\"language-text\\\">weight_updates</code>  和 <code class=\\\"language-text\\\">bias_updates</code> ，以及更新前一层的 <code class=\\\"language-text\\\">delta</code> </p>\\n<p>如果从 GEMM 的角度考虑，得到 <code class=\\\"language-text\\\">weight_updates</code> 和 <code class=\\\"language-text\\\">bias_updates</code> 就很容易，因为它就是矩阵相乘的偏导，我们只要把前一层的 <code class=\\\"language-text\\\">ouput</code> 重排一下重新得到上面的矩阵 $A$ ，然后和全连接层类似。</p>\\n<p>至于 前一层的 <code class=\\\"language-text\\\">delta</code> ，我们在计算矩阵偏导后，还需要多一步，逆重排，在 Darknet 中通过 <code class=\\\"language-text\\\">col2im_cpu</code> 实现，注意这一步基本是叠加元素叠加实现的。感觉具体细节比较麻烦，主要是如何寻找索引，详细请看 <code class=\\\"language-text\\\">col2im_cpu.c</code> 文件</p>\",\"htmlAst\":{\"type\":\"root\",\"children\":[{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"在了解 全连接层反向传播的机理后，我在 Google 上找了一圈，都没有找到讲得很好的 CNN 反向传播的计算，本想通过研究 Pytorch 源码分析算法原理，发现 Pytorch 底层是调用 C 代码的，也就不了了之了。最近在学习 Darknet 源码时，终于搞懂了这部分的原理。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"comment\",\"value\":\"more\"},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1. 前向传播\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"这里要先说明一点，这个地方对应学过数字信号处理的同学来说，还是非常坑的。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"数字信号处理中，实际的卷积操作如下: \"}]},{\"type\":\"text\",\"value\":\"\\n$$\\n(f*h)[m,n]=\\\\sum_{i=-\\\\infty}^\\\\infty\\\\sum_{j=-\\\\infty}^\\\\infty f[i,j]\\\\cdot h[m-i,n-j]\\n$$\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"而深度学习的卷积操作如下: \"}]},{\"type\":\"text\",\"value\":\"\\n$$\\n(f*h)[m,n]=\\\\sum_{i=-\\\\infty}^\\\\infty\\\\sum_{j=-\\\\infty}^\\\\infty f[i,j]\\\\cdot h[i-m,j-n]\\n$$\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"也就是说，深度学习中的卷积操作实际上是\"},{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"相关操作\"}]},{\"type\":\"text\",\"value\":\" (correlation)\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"在数字信号处理中，一维卷积需要把信号序列 (一般是时间序列) 绕原点翻转，二维卷积则需要把信号序列 (一般是图像序列) 绕中心点旋转 $180^{\\\\circ}$ \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"blockquote\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"convolution is a filtering operation. correlation compared the similarity of two sets of data. Correlation is a measure of relatedness of two signals.\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"但其实，在深度学习中，卷积和相关可以理解为是相同的。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"因为我们学习的就是卷积核权重，即卷积核未知，每次反向传播都会自动更新使得误差最小。而传统的图像处理采用已知的卷积核，如果不做翻转处理，结果完全不一样。当然，卷积核绕中心 $180^{\\\\circ}$ 对称的话，两种处理结果也是相同的。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"感兴趣的还可以看下 我的这篇博客 \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"http://brunoliu.com/2018/06/14/thinking-of-2d-convolution/\"},\"children\":[{\"type\":\"text\",\"value\":\"Thinking of 2D convolution\"}]}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1.1 输出尺寸\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"大多数博客只提到 CNN 算法的前向传播原理。其实如果搞过传统图像处理的，应该都知道，卷积层的本质就是滤波，包括高通滤波用于边缘检测，低通滤波 (如高斯滤波器) 用于图片平滑。感兴趣的可以去找相关书籍看看。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"前向传播一个稍微麻烦的地方是 如果根据 input height, input width, kernel size, padding, stride 计算输出 output height , output width \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"公式如下: \"}]},{\"type\":\"text\",\"value\":\"\\n$$\\n\\\\text {output height} = \\\\Big \\\\lfloor \\\\cfrac {\\\\text {input height} + 2 \\\\times \\\\text {padding} - \\\\text {kernel size}} {\\\\text {stride}} \\\\Big \\\\rfloor + 1 \\n$$\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"output width\"}]},{\"type\":\"text\",\"value\":\" 计算是类似的。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"参考论文: \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://arxiv.org/abs/1603.07285\"},\"children\":[{\"type\":\"text\",\"value\":\"A guide to convolution arithmetic for deep learning\"}]}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"对应的 GitHub repo: \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/vdumoulin/conv_arithmetic\"},\"children\":[{\"type\":\"text\",\"value\":\"conv_arithmetic\"}]}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1.2 卷积实现\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"这一小节参考的博客: \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/\"},\"children\":[{\"type\":\"text\",\"value\":\"Why GEMM is at the heart of deep learning\"}]},{\"type\":\"text\",\"value\":\" \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"本博客着重讲的是第二点，如果实现二维卷积计算 ? \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"传统的数字信号处理中，对于两个长度相当的数据，我们通常用傅里叶变换间接求两个信号的卷积。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"但由于深度学习中，常见的卷积核大小为 $3 \\\\times 3$, $5 \\\\times 5$ 等，采用傅里叶变换得不偿失，我们通常利用卷积定义直接计算。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"由此引入本文的核心: \"},{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"GEMM\"}]},{\"type\":\"text\",\"value\":\" — GEneral Matrix to Matrix Multiplication\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"它是 BLAS (Basic Linear Algebra Subprograms) library 的一部分。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"GELL 听上去很高大上，是不是 ?\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"其实说白了就是 \"},{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"矩阵乘法\"}]},{\"type\":\"text\",\"value\":\" 的计算实现。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"矩阵乘法在深度学习中最直观的使用莫过于全连接层了，输入神经元和权重矩阵进行矩阵乘法，再和偏置矩阵相加，得到输出神经元的值。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"言归正传，回到 CNN 实现\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 50.390625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAABYlAAAWJQFJUiTwAAABe0lEQVQoz22RTU/CQBBA+6P9C3pCo4mIATSBaKIhHjDh7MVgYvAgggItpYVd2tLS0g8srd0dh6KVRCYvk91m3u5sR+CcA4C7cEbykJLJUBKnhMBvxHEchuGm5n8IbUJl3ZwY1mhqqLopUx0hpo1rcSj3ez1RFPGI3fKVOj5WJle2V527lblbtT3MFWuB21N53DNmWPSVJCuMMFyzWkVRhO0wxoSapufsxQVAkfMi5l9KAPk4FoMlyp7vjwmdGuZIUVRVwSRJUhAEwi3VcpZ9yaAUs9IXzygnkF+uRD/YdGiOB7NBa/DR6XTfdU37aftH5rB2EsgoM8h/RpmsPl7LN3tK4/DlualOCKU0lafakeWgXE5vy7hgcLYlO2qbNva9h9zbS7Pd6TqOs5ZrhB6Yc3xkIeEFBhnnHE7CqJ/KLB3VSOq/tp4MQ8f1ZniCtQzqml53/frC2+be9e8smwRrGQs5Y93ue68/wJ/9NypIzwHGdrMVYfiJE9r+8g0dCCBSGZDZNwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"kernelview\",\"title\":\"\",\"src\":\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png\",\"srcSet\":[\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-d8578.png 200w\",\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-a4478.png 400w\",\"/static/kernelview-bd0283cc68eb34bae246e8d28931361b-2cbed.png 768w\"],\"sizes\":[\"(max-width:\",\"768px)\",\"100vw,\",\"768px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"CNN 层输入数据尺寸为 batch_size $\\\\times$ depth (channel) $\\\\times$ input height $\\\\times$ input width，这是一个4维张量，在 Pytorch 中输入张量的顺序也是 batch $\\\\times$ depth $\\\\times$ height $\\\\times$ width \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"如果考虑对 batch 循环处理，那么每次的输入数据尺寸为 depth(channel) $\\\\times$ input height $\\\\times$ input width \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"卷积核的大小则为  output depth $\\\\times$ depth $\\\\times$ kernel size $\\\\times$ kernel size \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"注: 这里和别的博客说法不同，一般都将单个卷积核视为二维的，但其实想一下，考虑沿着深度方向 (每个输入通道) 都存在相应的不同卷积核，最后叠加。那么我们直接将沿着深度方向的所有卷积核视为一个卷积核，进行 3 维的相乘累加操作，不是更方便吗 ? \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"下图展示了输入数据尺寸为 $1 \\\\times 2 \\\\times 5 \\\\times 5$ (batch:1, depth:2, height: 5, width: 5)，卷积核尺寸为 $3 \\\\times 2 \\\\times 3 \\\\times 3$ (output depth: 3, input depth: 2, kernel size: 3 )，输出数据尺寸为 $1 \\\\times 3 \\\\times 3 \\\\times 3$ \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 468px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsSAAALEgHS3X78AAAC/ElEQVQ4y41UyWsTURzOQaSCC3gRERRBkHrViyf/AM+epAcpokIREbFbWu0iQkUsaEvrXiJq06Y1LdbUtKmmi91NKralS+qSNrFJJpNZ38ybN/HNvGQyTYL1HYaZ3/y+3/p9z5LMd1RVxU+K5Z6Pf3k44g0nEobRfCx5wUj3szrf7au17qmzjq4F8KeC0PZgjEPaI1lkayuoKj1x7+5yOGxE3D4z8erz+251OT76/Xlrzgar+sEvsizH43FFkvhEQhIEOpFQFOVfYAJDCDEMQ9M08aZoGlcLIcSxOI4jPkYVFnOdvCBgJwCAETGOwek5Caa/6pbMqsonGI5ls3rjGMZswQNnGUZg2EzmTYa96Gi/4mgP0zSpigx25vfP829ttW6XAqEx7flQqOiNrfxDrwCABl6NRApqKvbfqV7c2CBOZKWOOZ+l4vqppgcykPAn1I3uhQVL1c3jjQ00x2lgRhSbR7wtI16aF8wzD0Qj9z0D9q+zpG2SORinGj95Xk1PSRCmepYlCQhC7jLE9ITNB/C8qodLgYEsi5KUSxXcmLx1wykjVDJgzAoAxNzMAk6SkxnvDBmZcTPhaDwUodBW6ssQBv9EqPRiyIFIWd+MRmlthRp4YGKlsNp1usETCMdJLKQna+r1HbX2n2sdhbKkL1mz2tzfjlldZx8Ns7yggR93TO4o7jxS1rcSonSGplh4tXHQUtx9psEDZWCAbz/1Wi50nawfZAjYNx+sezbU5vKRTaY3lXSPLdW/+Px+fDmlU906PB2oeeLpGVtSk2qa27qCVFPPBM8yWBhINRl5jlEgyNATpWUYi8WgzkRjwjyb4TZ+wcIQBDHVWpaesQwpihJF7TcrAOfsj86J1Y6pNf+vqCZPipJ0LmRL0qzqWAyPDbrHlndfth8oc+0s6bn2ehKJrAikrCslzzWkaPIH3e65wzechXWeg+X9lV2zmv1/7jAiKefA972X7IdK+3eV9JTaZ4xVbQNGupN/PljZ4ql9OVzROjSxuJ739vwLqYZktpd71IcAAAAASUVORK5CYII='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"conv sum\",\"title\":\"\",\"src\":\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png\",\"srcSet\":[\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-96318.png 200w\",\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-dc6d3.png 400w\",\"/static/conv_sum-d38cce429f3e6a048835a85742b45e4a-3f951.png 468w\"],\"sizes\":[\"(max-width:\",\"468px)\",\"100vw,\",\"468px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"每次卷积核的运算： 相乘并累加\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"矩阵乘法 $C = AB$ 的单次运算: $A$ 的行向量与 $B$ 的列向量相乘并累加\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"不知道你有没有看出来两者的联系 ？\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"是的，基本操作都是相乘并累加。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"所有，有的人就想到了，将卷积层的计算也用矩阵乘法实现: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"$A$ 的每一行大小为 depth $\\\\times$ kernel size $\\\\times$ kernel size ，$B$ 的每一列也是相同大小，矩阵相乘的基本运算对应的就是单次卷积核相乘累加操作。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"也就是说，我们需要将 CNN 层的输入数据重新排列，根据它可以组成矩阵 $A$ 的每一行 — 矩阵 $A$ 每一行的数据就是按步长移动卷积核后，其对应位置上的原始输入数据。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"如下图所示，将 4维的输入张量数据转为 2维矩阵 $A$ ，通常称为 im2col, 表示 image-to-column\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 45.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAABYlAAAWJQFJUiTwAAABw0lEQVQoz32R7W+aUBSH+f//g2ZxWdXWIo3V+lIVRAQBqYJcBygvwzl1vgJeFY2J6K5tto+7eT7cnOQ55/xysOv1Gl1uTKa/LduZTGf9gQm3O1S/XC7X/z7M0tpzSxmaPRc07e+SKTf6Cq+rrYUlb5bTfzpqdD5HiOiD2ye6YIpYFIp3ndKdyqY65RigYsNu3uSSuoA779kdDD7loW82Vi/N5WveSNKTDO+/tscMJrWqGnMP2AeFS+uNuEIn3E5G5fC+iP/oFjZ/5cFafYNfqV0yP/9S9r+RYZwZ57CuVNZFYii/ACk7Anmt+Wj3ygMxrbdzTq+yWMzCQ3g+RZbfI7cJZo8zIV7fP9FhipsWMaFV6XMJU3qWm8SoTaiNpCtnAJ82ePwnKNmOafSNbbBzAo3cJW5m+ITk+uFDVoUCmuNKhCYQv5SczsRdtTRopkwp44CKH3iH4wGtbXm9SnBPw1QNPiKo7QM7zmN1XeakrDGgKY21jSoLSN2gJJ0WtZpjkHDjf2Y2PfAGYygzmo/2r+5R5iwGT6fabE56PhlAarkmfVhbrigvIL2gPp/vj0d0JiSPfJtb5MRVSVgVEfy60JmwfwBsmcWHVL5fVAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"im2col corrected\",\"title\":\"\",\"src\":\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png\",\"srcSet\":[\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-d8578.png 200w\",\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-a4478.png 400w\",\"/static/im2col_corrected-63eafbfa9662eac92b025bfb1337e5f2-2cbed.png 768w\"],\"sizes\":[\"(max-width:\",\"768px)\",\"100vw,\",\"768px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"有的人可能会说，在步长 stride 比较小，kernel 比较大的情况下，上图中不同 patch 之间必然会相互覆盖 (overlap)，也就是说生成的 2 维矩阵 $A$ 会有大量的重复数据，生成这样的矩阵既浪费内存，又浪费时间，效率会高吗 ? \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"但是，请相信，和后面的矩阵乘法的高效比起来，这一步浪费的时间是有价值的。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"blockquote\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"The benefits from the very regular patterns of memory access outweigh the wasteful storage costs. The paper from Nvidia \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://arxiv.org/pdf/1410.0759.pdf\"},\"children\":[{\"type\":\"text\",\"value\":\"cuDNN: efficient primitives for Deep Learning\"}]},{\"type\":\"text\",\"value\":\" describe why they ended up with a modified version of GEMM. There are a lot of advantages to being able to batch up a lot of input images against the same kernels at once.\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"根据前面的分析：\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"$A$ 的行数为 patch 的数目，即  \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"batch size * output height * output width\"}]},{\"type\":\"text\",\"value\":\" \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"$B$ 的列数为卷积核的数目，即 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"output depth\"}]},{\"type\":\"text\",\"value\":\" \"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"于是输出的 2 维矩阵大小为:  \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"batch size * output height * output width\"}]},{\"type\":\"text\",\"value\":\"  $\\\\times$ \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"output depth\"}]},{\"type\":\"text\",\"value\":\" ，在下一层看来，它又是一个新的 4 维矩阵。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"如下图所示: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 768px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 60.15625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABYlAAAWJQFJUiTwAAACCUlEQVQoz22S22+aYBjG/W93vUO6NLV4tWQX7Xax6yVdFXWXS5atii5OBZzNUgWiKKVomBxETh/HgsI+dHTLtjdPngsefnl4yVtI0xQAwLKsIAgURdE0bVsWfJgkSbofx3FEUZQkCfpyuZAlOY7jQ1TILEld4AZeaOqW5/rbeJv+MUEQKIqiqqqmaaL4A3qcv1BwXDBdMKImzMXpaPZ9ueYFhWO4ked5MI6iCPYkv2aXfdBuF0X3223GFxR99Xl9gVnlCv26zr7BzDIGyh+Et6qqwFiYDOTeS5U43wxeqfiZRp4r/TOt/0LjuhmsmjJmoG2nillo0yy3QbXtoE2lyvO38S5dzYiIPArI43hY9AnoJz5xEhFP9dlVcoC/2LWOX+94ufxaa11nGNpxw8UElxqPPRK5H5Zc4nTvpZB4rs+bGbw25aZeaQG0ZedyKldShePmsPkG/0i/f+TixT0GHXEJJCSO9HljD1vK380BbK7NZizcajnpq9gTL+tE/gNrloLpaLaqnQugmFyjqDGEZe5bSB775Gl0jfhkMRoi2QpkDsOdG9Y7zLvE3Fz+5Sf54u6OPzRbX48cAvEHJdAvBtBxxOk+09hG9reBZ9+o/ZHWe9B407sWO4ZpwHglLngGn4+7PEPcMjhH9XiGXE4Ha2mRX9juHyW/Lwzew8awDBM4XqgbtmmBh/AnHxBnXDuuy+IAAAAASUVORK5CYII='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"im2colmult corrected1\",\"title\":\"\",\"src\":\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png\",\"srcSet\":[\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-d8578.png 200w\",\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-a4478.png 400w\",\"/static/im2colmult_corrected1-fdef98e61d012beb0d354104f6753c94-2cbed.png 768w\"],\"sizes\":[\"(max-width:\",\"768px)\",\"100vw,\",\"768px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1.3 利用 numpy 验证\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"我们通过 numpy 验证两种方式计算卷积，哪一种更高效。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"背景: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ul\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"一张灰度图片，大小为 $332 \\\\times 300$, batch_size = 1， input depth = 1，因此输入数据是二维矩阵； \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"通过 python skimage 库读取图片\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"python\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"from\"}]},{\"type\":\"text\",\"value\":\" skimage \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"import\"}]},{\"type\":\"text\",\"value\":\" io \\nio\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"imread\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"'dog.jpg'\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"  \\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 332px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 90.36144578313254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAASABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAME/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABtZExLDTnCIP/xAAaEAACAwEBAAAAAAAAAAAAAAABAwACERIx/9oACAEBAAEFAlrrhCDGL5vgCqW6tux0X7P/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAcEAACAgIDAAAAAAAAAAAAAAABEQAQAhIhMZH/2gAIAQEABj8CeXkShHcZmqGgHFC//8QAGhABAAMBAQEAAAAAAAAAAAAAAQARMSGxQf/aAAgBAQABPyFxXWqQzC8RlAND7GqOrdR3Q8mujEJWeRPFhk//2gAMAwEAAgADAAAAEMPHAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB4QAQACAgEFAAAAAAAAAAAAAAEAESExUYGR0eHw/9oACAEBAAE/EECoAWne1hcW8ha3V7gE7MAr5gDUxcHmXmbiQRnvGqbW40ALRUdI0dL6GKxP/9k='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"dog\",\"title\":\"\",\"src\":\"/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg\",\"srcSet\":[\"/static/dog-085939e2d2f627a80f7608283c0b7574-fbbac.jpg 200w\",\"/static/dog-085939e2d2f627a80f7608283c0b7574-fc7ff.jpg 332w\"],\"sizes\":[\"(max-width:\",\"332px)\",\"100vw,\",\"332px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ul\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"卷积核大小为 $3 \\\\times 3$ ，ouput depth = 1，padding = 1，stride = 1\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"note: 其实这个卷积核是边缘检测算子\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"python\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"import\"}]},{\"type\":\"text\",\"value\":\" numpy \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"as\"}]},{\"type\":\"text\",\"value\":\" np\\nkernel \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"array\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"输出为二维矩阵，不考虑 depth 和 batch size，大小和输入数据相同\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"首先我们实现 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"zero_pad\"}]},{\"type\":\"text\",\"value\":\" 函数实现 边缘补 0\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"python\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"def\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"function\"]},\"children\":[{\"type\":\"text\",\"value\":\"zero_pad\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_height\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_width\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"triple-quoted-string\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\\"\\\"\\\" Zero-pad an image.\\n    Args:\\n        image: numpy array of shape (H, W)\\n        pad_width: width of the zero padding (left and right padding)\\n        pad_height: height of the zero padding (bottom and top padding)\\n    Returns:\\n        out: numpy array of shape (H+2*pad_height, W+2*pad_width)\\n    \\\"\\\"\\\"\"}]},{\"type\":\"text\",\"value\":\"\\n    H\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" W \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"shape\\n    out \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"boolean\"]},\"children\":[{\"type\":\"text\",\"value\":\"None\"}]},{\"type\":\"text\",\"value\":\"\\n\\n    out \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"zeros\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"H\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"*\"}]},{\"type\":\"text\",\"value\":\"pad_height\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" W\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"*\"}]},{\"type\":\"text\",\"value\":\"pad_width\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n    out\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"pad_height\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"pad_height\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"H\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_width\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"pad_width\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"W\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"return\"}]},{\"type\":\"text\",\"value\":\" out\"}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"方法一:\"}]},{\"type\":\"text\",\"value\":\" 通过 卷积定义计算，我们需要使用两个 for 循环\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"python\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"def\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"function\"]},\"children\":[{\"type\":\"text\",\"value\":\"conv_fast\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"triple-quoted-string\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\\"\\\"\\\" An efficient implementation of convolution filter.\\n    Args:\\n        image: numpy array of shape (Hi, Wi)\\n        kernel: numpy array of shape (Hk, Wk)\\n\\n    Returns:\\n        out: numpy array of shape (Hi, Wi)\\n    \\\"\\\"\\\"\"}]},{\"type\":\"text\",\"value\":\"\\n    Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wi \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"shape\\n    Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wk \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"shape\\n    out \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"zeros\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n    pad_height \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"//\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"text\",\"value\":\"\\n    pad_width \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Wk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"//\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"text\",\"value\":\"\\n    \\n    image_padding \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" zero_pad\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_height\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_width\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# 两个 for 循环，按 步长为 1 逐点计算\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"for\"}]},{\"type\":\"text\",\"value\":\" hi \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"in\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"builtin\"]},\"children\":[{\"type\":\"text\",\"value\":\"range\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n        \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"for\"}]},{\"type\":\"text\",\"value\":\" wi \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"in\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"builtin\"]},\"children\":[{\"type\":\"text\",\"value\":\"range\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n            out\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"builtin\"]},\"children\":[{\"type\":\"text\",\"value\":\"sum\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"image_padding\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"Wk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"*\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"return\"}]},{\"type\":\"text\",\"value\":\" out\"}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"方法二:\"}]},{\"type\":\"text\",\"value\":\" GEMM，矩阵相乘计算\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"python\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"def\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"function\"]},\"children\":[{\"type\":\"text\",\"value\":\"conv_faster\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"triple-quoted-string\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\\"\\\"\\\"\\n    Args:\\n        image: numpy array of shape (Hi, Wi)\\n        kernel: numpy array of shape (Hk, Wk)\\n\\n    Returns:\\n        out: numpy array of shape (Hi, Wi)\\n    \\\"\\\"\\\"\"}]},{\"type\":\"text\",\"value\":\"\\n    Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wi \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"shape\\n    Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wk \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"shape\\n    out \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"zeros\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n    pad_height \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"//\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"text\",\"value\":\"\\n    pad_width \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Wk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"//\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"text\",\"value\":\"\\n    \\n    image_padding \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" zero_pad\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"image\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_height\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" pad_width\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n    \\n    gemm_input \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"zeros\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"*\"}]},{\"type\":\"text\",\"value\":\"Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"*\"}]},{\"type\":\"text\",\"value\":\"Wk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# 输入数据重排，得到我们需要的矩阵\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"for\"}]},{\"type\":\"text\",\"value\":\" hi \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"in\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"builtin\"]},\"children\":[{\"type\":\"text\",\"value\":\"range\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n        \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"for\"}]},{\"type\":\"text\",\"value\":\" wi \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"in\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"builtin\"]},\"children\":[{\"type\":\"text\",\"value\":\"range\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n            gemm_input\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"*\"}]},{\"type\":\"text\",\"value\":\"Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" image_padding\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"text\",\"value\":\"hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"Hk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"+\"}]},{\"type\":\"text\",\"value\":\"Wk\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"]\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"reshape\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n            \\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# 一次矩阵乘法计算，直接得到结果\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# out shape: (Hi*Wi, 1)\"}]},{\"type\":\"text\",\"value\":\"\\n    out \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"matmul\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"gemm_input\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# 整理矩阵形状, out shape: (Hi, Wi)\"}]},{\"type\":\"text\",\"value\":\"\\n    out \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" out\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"reshape\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"Hi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" Wi\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"return\"}]},{\"type\":\"text\",\"value\":\" out\"}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"最终结果: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"python\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-python\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"import\"}]},{\"type\":\"text\",\"value\":\" matplotlib\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"pyplot \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"as\"}]},{\"type\":\"text\",\"value\":\" plt\\n\\nt0 \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" time\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nout_fast \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" conv_fast\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"img\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nt1 \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" time\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nout_faster \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" conv_faster\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"img\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"text\",\"value\":\" kernel\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nt2 \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"text\",\"value\":\" time\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# Compare the running time of the two implementations\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"print\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\\"conv_fast: took %f seconds.\\\"\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"%\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"t1 \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"text\",\"value\":\" t0\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"print\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\\"conv_faster: took %f seconds.\\\"\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"%\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"t2 \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"text\",\"value\":\" t1\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# Plot conv_nested output\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"subplot\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"imshow\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"out_fast\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"title\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"'conv_fast'\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"axis\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"'off'\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# Plot conv_fast output\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"subplot\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"imshow\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"out_faster\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"title\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"'conv_faster'\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\nplt\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"text\",\"value\":\"axis\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"'off'\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\"\\n\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"comment\"]},\"children\":[{\"type\":\"text\",\"value\":\"# Make sure that the two outputs are the same\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"if\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"not\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"np\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\".\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"builtin\"]},\"children\":[{\"type\":\"text\",\"value\":\"max\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"text\",\"value\":\"out_fast \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"text\",\"value\":\" out_faster\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"<\"}]},{\"type\":\"text\",\"value\":\" \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"1e\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"operator\"]},\"children\":[{\"type\":\"text\",\"value\":\"-\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"number\"]},\"children\":[{\"type\":\"text\",\"value\":\"10\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\":\"}]},{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"keyword\"]},\"children\":[{\"type\":\"text\",\"value\":\"print\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"string\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\\"Different outputs! Check your implementation.\\\"\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"token\",\"punctuation\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"结果如下: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"div\",\"properties\":{\"className\":[\"gatsby-highlight\"],\"dataLanguage\":\"text\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"conv_fast: took 0.563950 seconds.\\nconv_faster: took 0.221714 seconds.\"}]}]},{\"type\":\"text\",\"value\":\"\\n      \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"使用 GEMM 算法快了 50%，是不是很有效 !\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 601px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 45.92346089850249%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABo0lEQVQoz2WRy0pCURiFTw3sRZpHo2iWECJC0ShEhx0RIUG83+8gZYg48Al8hJAigiY9gYNAGvcK4fFc+tZBS0jY7L3X/s761/9rTCaTvXq9floul88rlUowmUxexOPxaDqdjqCfoYfz+fyhwY/7MUwILZhIJC5jsVjUNM2rDRcqFApHxnQ6DSB8NhoNr1qtepz9HcArFotOt9v1AB82hq+tVkvvbq1W2+XcZrOp/ckgYQCz5QZ0SOAC+atUKlkqlMvlhjLk/KICcDaGvxzLljnc3BiNRgHMlqqgB0zcrSmJLBXKZDL3MoTxDWHWO2bi1uoMbm7MZjM/oZIAOmpBZ+bmkcLqdDpeNpsdbg1VgIIq7CkE4xBny9BPKEMelpsZOJoPDy4futz/GeqOvlbL4tDU0Z/heDwOtNvtDwlUs9Q2H9hoSvGtRIB3MsTsGV3pV1uOd5vzSn8S+qMSHjCXL4EyVVKde72eWvEGg4HAiQzR3vv9vq/vchqRdrg3Y7FY7PNwTboklUzim9oxN0l4w7oFPJEhhSOkSkkXpyUOXlwKj/APlHJ3/u12OaIAAAAASUVORK5CYII='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"conv output\",\"title\":\"\",\"src\":\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png\",\"srcSet\":[\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-ae8c5.png 200w\",\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-d70b4.png 400w\",\"/static/conv_output-0e41c7abfd372c6cf1591b57da07dbcc-3afee.png 601w\"],\"sizes\":[\"(max-width:\",\"601px)\",\"100vw,\",\"601px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1.4 Darknet 实现\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"在 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"convolutional_layer.c\"}]},{\"type\":\"text\",\"value\":\" 中，实现了 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"forward_convolutional_layer\"}]},{\"type\":\"text\",\"value\":\" 函数，里面主要使用了两个函数: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"im2col_cpu\"}]},{\"type\":\"text\",\"value\":\" : 实现重排，考虑 padding, stride, kernel size 等参数\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"gemm\"}]},{\"type\":\"text\",\"value\":\" : 实现矩阵乘法 $C = \\\\alpha * AB + \\\\beta * C$\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"注意: \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"gemm\"}]},{\"type\":\"text\",\"value\":\" 支持 A, B 转置，因此具体实现有 4 个对应的函数\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"这两个函数分别在 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"im2col.c\"}]},{\"type\":\"text\",\"value\":\" 和 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"gemm.c\"}]},{\"type\":\"text\",\"value\":\" 实现\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"2. 反向传播\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"说白了，我们要获得 3 个值，该层的 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"weight_updates\"}]},{\"type\":\"text\",\"value\":\"  和 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"bias_updates\"}]},{\"type\":\"text\",\"value\":\" ，以及更新前一层的 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"delta\"}]},{\"type\":\"text\",\"value\":\" \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"如果从 GEMM 的角度考虑，得到 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"weight_updates\"}]},{\"type\":\"text\",\"value\":\" 和 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"bias_updates\"}]},{\"type\":\"text\",\"value\":\" 就很容易，因为它就是矩阵相乘的偏导，我们只要把前一层的 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"ouput\"}]},{\"type\":\"text\",\"value\":\" 重排一下重新得到上面的矩阵 $A$ ，然后和全连接层类似。\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"至于 前一层的 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"delta\"}]},{\"type\":\"text\",\"value\":\" ，我们在计算矩阵偏导后，还需要多一步，逆重排，在 Darknet 中通过 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"col2im_cpu\"}]},{\"type\":\"text\",\"value\":\" 实现，注意这一步基本是叠加元素叠加实现的。感觉具体细节比较麻烦，主要是如何寻找索引，详细请看 \"},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-text\"]},\"children\":[{\"type\":\"text\",\"value\":\"col2im_cpu.c\"}]},{\"type\":\"text\",\"value\":\" 文件\"}]}],\"data\":{\"quirksMode\":false}},\"fields\":{\"slug\":\"/DarkNet-CNN-Source-Code-Analyse/\",\"prefix\":\"2018-12-04\"},\"frontmatter\":{\"title\":\"DarkNet CNN Source Code Analyse\",\"subTitle\":\"介绍 DarkNet CNN 实现流程\",\"cover\":{\"childImageSharp\":{\"resize\":{\"src\":\"/static/darknet-a128141842710e6137de63943fa20758-160fa.png\"}}}}},\"author\":{\"id\":\"F:/program/BlogSite/content/parts/author.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>我是一名数据工程师，对硬件有浓厚的兴趣。</p>\"},\"footnote\":{\"id\":\"F:/program/BlogSite/content/parts/footnote.md absPath of file >>> MarkdownRemark\",\"html\":\"<ul>\\n<li>this is a site built by <a href=\\\"https://www.gatsbyjs.org/\\\">GatsbyJS</a>, ReactJs, CSS in JS</li>\\n<li>delivered by <a href=\\\"https://pages.github.com/\\\">Github Page</a></li>\\n</ul>\"},\"site\":{\"siteMetadata\":{\"facebook\":{\"appId\":\"\"}}}},\"pathContext\":{\"slug\":\"/DarkNet-CNN-Source-Code-Analyse/\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/dark-net-cnn-source-code-analyse.json\n// module id = 794\n// module chunks = 21380530516426"],"sourceRoot":""}